(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,30253,e=>{"use strict";let t,n;var r,l,a,i,s,o=e.i(43476),c=e.i(71645);function u(e,t="data-id"){let n=e;for(!n.tagName&&e.target&&(n=e.target);n;){if(n.getAttribute&&n.getAttribute(t))return n;n=n.parentNode}return null}function d(e,t="data-id"){let n=u(e,t);return n?n.getAttribute(t):null}function h(e,t="data-id"){let n=u(e,t);return n?f(n.getAttribute(t)):null}function f(e){if("string"==typeof e){let t=+e;if(!isNaN(t))return t}return e}var m={detect:()=>!0,addEvent:function(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)},addGlobalEvent:function(e,t){return document.addEventListener(e,t),()=>document.removeEventListener(e,t)},getTopNode:function(){return window.document.body}};function p(e){Object.assign(m,e)}function x(e,t,n){m.addEvent(e,n,function(e){let r,l=u(e);if(!l)return;let a=f(l.dataset.id);if("function"==typeof t)return t(a,e);let i=e.target;for(;i!=l;){if((r=i.dataset?i.dataset.action:null)&&t[r])return void t[r](a,e);i=i.parentNode}t[n]&&t[n](a,e)})}function g(e,t){x(e,t,"click"),t.dblclick&&x(e,t.dblclick,"dblclick")}var w=new Date,y=!1,v=[],b=[],k=e=>{if(y){y=!1;return}for(let t=b.length-1;t>=0;t--){let{node:n,date:r,props:l}=b[t];if(!(r>w)&&!n.contains(e.target)&&n!==e.target&&(l.callback&&l.callback(e),l.modal||e.defaultPrevented))break}},S=e=>{w=new Date,y=!0;for(let t=b.length-1;t>=0;t--){let{node:n}=b[t];if(!n.contains(e.target)&&n!==e.target){y=!1;break}}};function C(e,t){v.length||(v=[m.addGlobalEvent("click",k,e),m.addGlobalEvent("contextmenu",k,e),m.addGlobalEvent("mousedown",S,e)]),"object"!=typeof t&&(t={callback:t});let n={node:e,date:new Date,props:t};return b.push(n),{destroy(){for(let e=b.length-1;e>=0;e--)if(b[e]===n){b.splice(e,1);break}b.length||(v.forEach(e=>e()),v=[])}}}var j=e=>-1!==e.indexOf("right"),M=e=>-1!==e.indexOf("fit"),_=e=>-1!==e.indexOf("overlap"),N=new Date().valueOf();function E(){return N+=1}function T(e){return e<10?"0"+e:e.toString()}function $(e){let t=11*Math.floor(e/11);return{start:t,end:t+11}}var D=["",""],R=/%[a-zA-Z]/g;function A(e,t){return"function"==typeof e?e:function(n){return n?(n.getMonth||(n=new Date(n)),e.replace(R,e=>(function(e,t,n){switch(e){case"%d":return T(t.getDate());case"%m":return T(t.getMonth()+1);case"%j":return t.getDate();case"%n":return t.getMonth()+1;case"%y":return T(t.getFullYear()%100);case"%Y":return t.getFullYear();case"%D":return n.dayShort[t.getDay()];case"%l":return n.dayFull[t.getDay()];case"%M":return n.monthShort[t.getMonth()];case"%F":return n.monthFull[t.getMonth()];case"%h":return T((t.getHours()+11)%12+1);case"%g":return(t.getHours()+11)%12+1;case"%G":return t.getHours();case"%H":return T(t.getHours());case"%i":return T(t.getMinutes());case"%a":return((t.getHours()>11?n.pm:n.am)||D)[0];case"%A":return((t.getHours()>11?n.pm:n.am)||D)[1];case"%s":return T(t.getSeconds());case"%S":let r;return 2==(r=T(t.getMilliseconds())).length?"0"+r:r;case"%W":let l,a,i;return T((0===(l=t.getDay())&&(l=7),(a=new Date(t.valueOf())).setDate(t.getDate()+(4-l)),i=a.getFullYear(),1+Math.floor(Math.floor((a.getTime()-new Date(i,0,1).getTime())/864e5)/7)));case"%c":{let e=t.getFullYear()+"";return e+="-"+T(t.getMonth()+1),e+="-"+T(t.getDate()),e+="T",e+=T(t.getHours()),e+=":"+T(t.getMinutes()),e+=":"+T(t.getSeconds())}default:return e}})(e,n,t))):""}}function I(e){return e&&"object"==typeof e&&!Array.isArray(e)}function H(e,t){for(let n in t){let r=t[n];I(e[n])&&I(r)?e[n]=H({...e[n]},t[n]):e[n]=t[n]}return e}function F(e){return{getGroup(t){let n=e[t];return e=>n&&n[e]||e},getRaw:()=>e,extend(t,n){return t?F(n?H({...t},e):H({...e},t)):this}}}function L(e){let[t,n]=(0,c.useState)(e),r=(0,c.useRef)(e);return(0,c.useEffect)(()=>{r.current!==e&&(Array.isArray(r.current)&&Array.isArray(e)&&0===r.current.length&&0===e.length||(r.current=e,n(e)))},[e]),[t,n]}function z(e,t){let n=e.getState();return function(e,t,n){let[r,l]=(0,c.useState)(()=>t);return e||console.warn(`Writable ${n} is not defined`),(0,c.useEffect)(()=>{if(e)return e.subscribe(e=>{l(()=>e)})},[e]),r}(e.getReactiveState()[t],n[t],t)}function P(e,t){let[n,r]=(0,c.useState)(()=>null);return(0,c.useEffect)(()=>{if(!e)return;let n=e.getReactiveState(),l=n?n[t]:null;if(l)return l.subscribe(e=>r(()=>e))},[e,t]),n}function W(e,t){let n=e.getState();return function(e,t){let n=(0,c.useRef)(t);n.current=t;let[r,l]=(0,c.useState)(1);return(0,c.useEffect)(()=>e.subscribe(e=>{n.current=e,l(e=>e+1)}),[e]),[n.current,r]}(e.getReactiveState()[t],n[t])}function O(e,t){if("function"==typeof e)if("object"==typeof t)return e(t);else return e();return e}function Y(e){let t={};return e.split(";").forEach(e=>{let[n,r]=e.split(":");if(r){let e=n.trim();e.indexOf("-")&&(e=e.replace(/-([a-z])/g,(e,t)=>t.toUpperCase())),t[e]=r.trim()}}),t}function B(e){let t=e,n=[];return{subscribe:e=>{n.push(e),e(t)},unsubscribe:e=>{n=n.filter(t=>t!==e)},set:e=>{t=e,n.forEach(e=>e(t))},update:e=>{t=e(t),n.forEach(e=>e(t))}}}function V(e,t,n){return m.addEvent(e,n,function(e){let r,l=u(e);if(!l)return;let a=f(l.dataset.id);if("function"==typeof t)return t(a,e);let i=e.target;for(;i!=l;){if((r=i.dataset?i.dataset.action:null)&&t[r])return void t[r](a,e);i=i.parentNode}t[n]&&t[n](a,e)})}let G={core:{ok:"OK",cancel:"Cancel",select:"Select","No data":"No data","Rows per page":"Rows per page","Total pages":"Total pages"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:0,clockFormat:24},formats:{timeFormat:"%H:%i",dateFormat:"%m/%d/%Y",monthYearFormat:"%F %Y",yearFormat:"%Y"},lang:"en-US"};var K=e.i(74080);function q({type:e="",css:t="",icon:n="",disabled:r=!1,title:l="",text:a="",children:i,onClick:s}){let u=(0,c.useMemo)(()=>t+(t?" ":"")+(e?e.split(" ").filter(e=>""!==e).map(e=>"wx-"+e).join(" "):""),[e,t]);return(0,o.jsxs)("button",{title:l,className:`wx-2ZWgb4 wx-button ${u} ${n&&!i?"wx-icon":""}`,disabled:r,onClick:e=>{s&&s(e)},children:[n&&(0,o.jsx)("i",{className:"wx-2ZWgb4 "+n}),i||a||" "]})}function U({position:e="bottom",align:t="start",autoFit:n=!0,onCancel:r,width:l="100%",children:a}){let i=(0,c.useRef)(null),[s,u]=(0,c.useState)(e),[d,h]=(0,c.useState)(t);return(0,c.useEffect)(()=>{u(e)},[e]),(0,c.useEffect)(()=>{h(t)},[t]),(0,c.useEffect)(()=>{if(n){let e=i.current;if(e){let t=e.getBoundingClientRect(),n=m.getTopNode(e).getBoundingClientRect();t.right>=n.right&&h("end"),t.bottom>=n.bottom&&u("top")}}},[n,d,s]),(0,c.useEffect)(()=>{if(i.current)return C(i.current,e=>{r&&r(e)}).destroy},[r]),(0,o.jsx)("div",{ref:i,className:`wx-32GZ52 wx-dropdown wx-${s}-${d}`,style:{width:l},children:a})}let Q=(0,c.createContext)("willow"),X=(0,c.createContext)({}),J=(0,c.createContext)(null),Z=Object.freeze(Object.defineProperty({__proto__:null,helpers:X,i18n:J,theme:Q},Symbol.toStringTag,{value:"Module"}));function ee({items:e=[],children:t,onSelect:n,onReady:r}){let l,a,i,s,u,d,f,m,p,x=(0,c.useRef)(),g=(0,c.useRef)((l=null,a=!1,f=e=>{a=null!==(l=e),u(l)},m=(e,t)=>{if(null!==e&&i){let n=i.querySelectorAll(".wx-list > .wx-item")[e];n&&(n.scrollIntoView({block:"nearest"}),t&&t.preventDefault())}},{move:e=>{let t=h(e),n=s.findIndex(e=>e.id==t);n!==l&&f(n)},keydown:(e,t)=>{switch(e.code){case"Enter":a?d():f(0);break;case"Space":a||f(0);break;case"Escape":case"Tab":u(l=null);break;case"ArrowDown":p(a?1:t||0,e);break;case"ArrowUp":p(a?-1:t||0,e)}},init:(e,t,n,r)=>{i=e,s=t,u=n,d=r},navigate:p=(e,t)=>{let n=null===e?null:Math.max(0,Math.min(l+e,s.length-1));n!==l&&(f(n),i?m(n,t):requestAnimationFrame(()=>m(n,t)))}})),[w,y]=(0,c.useState)(null),v=(0,c.useRef)(w),b=((0,c.useContext)(J)||F(G)).getGroup("core"),k=t=>{t&&t.stopPropagation(),n&&n({id:e[v.current]?.id})};return(0,c.useEffect)(()=>{g.current.init(x.current,e,e=>{y(e),v.current=e},k)},[e,!!x.current]),(0,c.useEffect)(()=>{r&&r(g.current)},[]),null===w?null:(0,o.jsx)(U,{onCancel:()=>g.current.navigate(null),children:(0,o.jsx)("div",{className:"wx-233fr7 wx-list",ref:x,onClick:k,onMouseMove:g.current.move,children:e.length?e.map((e,n)=>(0,o.jsx)("div",{className:`wx-233fr7 wx-item ${n===w?"wx-focus":""}`,"data-id":e.id,children:t?O(t,{option:e}):e.label},e.id)):(0,o.jsx)("div",{className:"wx-233fr7 wx-no-data",children:b("No data")})})})}function et({value:e="",onValueChange:t,id:n=E(),options:r=[],textOptions:l=null,textField:a="label",placeholder:i="",title:s="",disabled:u=!1,error:d=!1,clear:h=!1,children:f,onChange:m}){let p=(0,c.useRef)(null),x=(0,c.useRef)(null),[g,w]=L(e),[y,v]=(0,c.useState)(!1),[b,k]=(0,c.useState)(""),S=(0,c.useRef)(null),[C,j]=(0,c.useState)(!1),M=(0,c.useMemo)(()=>{if(y)return b;if(g||0===g){let e=(l||r).find(e=>e.id===g);if(e)return e[a]}return""},[y,b,g,l,r,a]),_=(0,c.useMemo)(()=>M&&y?r.filter(e=>e[a].toLowerCase().includes(M.toLowerCase())):r,[M,y,r,a]),N=(0,c.useCallback)(()=>_.findIndex(e=>e.id===g),[_,g]),T=(0,c.useCallback)(e=>{p.current=e.navigate,x.current=e.keydown},[]),$=(0,c.useCallback)((e,n)=>{if(e||0===e){let l=r.find(t=>t.id===e);if(v(!1),n&&p.current(null),l&&g!==l.id){let e=l.id;w(e),t&&t(e),m&&m({value:e})}}!C&&n&&S.current.focus()},[r,g,C,t,m]),D=(0,c.useCallback)(({id:e})=>{$(e,!0)},[$]),R=(0,c.useCallback)(e=>{e&&e.stopPropagation(),w(""),v(!1),t&&t(""),m&&m({value:""})},[t,m]),A=(0,c.useCallback)(e=>{if(!r.length)return;if(""===e&&h)return void R();let t=r.find(t=>t[a]===e);t||(t=r.find(t=>t[a].toLowerCase().includes(e.toLowerCase()))),$(t?t.id:g||r[0].id,!1)},[r,a,h,g,$,R]),I=(0,c.useCallback)(()=>{k(S.current.value),v(!0),_.length?p.current(0):p.current(null)},[_.length,p]),H=(0,c.useCallback)(()=>{j(!0)},[]),F=(0,c.useCallback)(()=>{j(!1),setTimeout(()=>{C||A(M)},200)},[C,A,M]);return(0,o.jsxs)("div",{className:"wx-1j11Jk wx-combo",onClick:()=>p.current(N()),onKeyDown:e=>x.current(e,N()),title:s,children:[(0,o.jsx)("input",{className:"wx-1j11Jk wx-input "+(d?"wx-error":""),id:n,ref:S,value:M,disabled:u,placeholder:i,onFocus:H,onBlur:F,onInput:I}),h&&!u&&g?(0,o.jsx)("i",{className:"wx-1j11Jk wx-icon wxi-close",onClick:R}):(0,o.jsx)("i",{className:"wx-1j11Jk wx-icon wxi-angle-down"}),!u&&(0,o.jsx)(ee,{items:_,onReady:T,onSelect:D,children:({option:e})=>(0,o.jsx)(o.Fragment,{children:f?f({option:e}):e[a]})})]})}function en({value:e="",id:t=E(),readonly:n=!1,focus:r=!1,select:l=!1,type:a="text",placeholder:i="",disabled:s=!1,error:u=!1,inputStyle:d={},title:h="",css:f="",icon:m="",clear:p=!1,onChange:x}){let[g,w]=L(e),y=(0,c.useRef)(null),v=(0,c.useMemo)(()=>m&&-1===f.indexOf("wx-icon-left")?"wx-icon-right "+f:f,[m,f]),b=(0,c.useMemo)(()=>m&&-1!==f.indexOf("wx-icon-left"),[m,f]);(0,c.useEffect)(()=>{let e=setTimeout(()=>{r&&y.current&&y.current.focus(),l&&y.current&&y.current.select()},1);return()=>clearTimeout(e)},[r,l]);let k=(0,c.useCallback)(e=>{let t=e.target.value;w(t),x&&x({value:t,input:!0})},[x]),S=(0,c.useCallback)(e=>x&&x({value:e.target.value}),[x]),C=a;return"password"!==a&&"number"!==a&&(C="text"),(0,c.useEffect)(()=>{let e=y.current;return e.addEventListener("change",S),()=>{e&&e.removeEventListener("change",S)}},[S]),(0,o.jsxs)("div",{className:`wx-hQ64J4 wx-text ${v} ${u?"wx-error":""} ${s?"wx-disabled":""} ${p?"wx-clear":""}`,children:[(0,o.jsx)("input",{className:"wx-hQ64J4 wx-input",ref:y,id:t,readOnly:n,disabled:s,placeholder:i,type:C,style:d,title:h,value:g,onInput:k}),p&&!s&&g?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"wx-hQ64J4 wx-icon wxi-close",onClick:function(e){e.stopPropagation(),w(""),x&&x({value:""})}}),b&&(0,o.jsx)("i",{className:`wx-hQ64J4 wx-icon ${m}`})]}):m?(0,o.jsx)("i",{className:`wx-hQ64J4 wx-icon ${m}`}):null]})}function er({date:e,type:t,part:n,onShift:r}){let{calendar:l,formats:a}=(0,c.useContext)(J).getRaw(),i=e.getFullYear(),s=(0,c.useMemo)(()=>{switch(t){case"month":return A(a.monthYearFormat,l)(e);case"year":return A(a.yearFormat,l)(e);case"duodecade":{let{start:e,end:t}=$(i),n=A(a.yearFormat,l);return`${n(new Date(e,0,1))} - ${n(new Date(t,11,31))}`}default:return""}},[e,t,i,l,a]);return(0,o.jsxs)("div",{className:"wx-8HQVQV wx-header",children:["right"!==n?(0,o.jsx)("i",{className:"wx-8HQVQV wx-pager wxi-angle-left",onClick:()=>r&&r({diff:-1,type:t})}):(0,o.jsx)("span",{className:"wx-8HQVQV wx-spacer"}),(0,o.jsx)("span",{className:"wx-8HQVQV wx-label",onClick:function(){r&&r({diff:0,type:t})},children:s}),"left"!==n?(0,o.jsx)("i",{className:"wx-8HQVQV wx-pager wxi-angle-right",onClick:()=>r&&r({diff:1,type:t})}):(0,o.jsx)("span",{className:"wx-8HQVQV wx-spacer"})]})}function el({onClick:e,children:t}){return(0,o.jsx)("button",{className:"wx-3s8W4d wx-button",onClick:e,children:t})}let ea="wx-1XEF33",ei={month:{component:function({value:e,current:t,part:n="",markers:r=null,onCancel:l,onChange:a}){let i=((0,c.useContext)(J)||F(G)).getRaw().calendar,s=(i.weekStart||7)%7,u=i.dayShort.slice(s).concat(i.dayShort.slice(0,s)),d=(e,t,n)=>new Date(e.getFullYear(),e.getMonth()+(t||0),e.getDate()+(n||0)),h="normal"!==n,f=(0,c.useRef)(0),m=(0,c.useMemo)(()=>"normal"==n?[e?d(e).valueOf():0]:e?[e.start?d(e.start).valueOf():0,e.end?d(e.end).valueOf():0]:[0,0],[n,e]),p=(0,c.useMemo)(()=>{let e,n,l=((e=d(t,0,1-t.getDate())).setDate(e.getDate()-(e.getDay()-(s-7))%7),e),a=((n=d(t,1,-t.getDate())).setDate(n.getDate()+(6-n.getDay()+s)%7),n),i=t.getMonth(),o=[];for(;l<=a;l.setDate(l.getDate()+1)){let e={day:l.getDate(),in:l.getMonth()===i,date:l.valueOf()},t="";if(t+=(e.in?"":" wx-inactive")+(m.indexOf(e.date)>-1?" wx-selected":""),h){let n=e.date==m[0],r=e.date==m[1];n&&!r?t+=" wx-left":r&&!n&&(t+=" wx-right"),e.date>m[0]&&e.date<m[1]&&(t+=" wx-inrange")}if(t+=!function(e){let t=e.getDay();return 0===t||6===t}(l)?"":" wx-weekend",r){let e=r(l);e&&(t+=" "+e)}o.push({...e,css:t})}return o},[t,m,h,r]),x=(0,c.useRef)(null),w=(0,c.useRef)({});return w.current.click=function(e,t){t.timeStamp!==f.current&&(f.current=t.timeStamp,t.stopPropagation(),a&&a(new Date(new Date(e))),l&&l())},(0,c.useEffect)(()=>{g(x.current,w.current)},[]),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"wx-398RBS wx-weekdays",children:u.map(e=>(0,o.jsx)("div",{className:"wx-398RBS wx-weekday",children:e},e))}),(0,o.jsx)("div",{className:"wx-398RBS wx-days",ref:x,children:p.map(e=>(0,o.jsx)("div",{className:`wx-398RBS wx-day ${e.css} ${e.in?"":"wx-out"}`,"data-id":e.date,children:e.day},e.date))})]})},next:function(e){return(e=new Date(e)).setMonth(e.getMonth()+1),e},prev:function(e){return(e=new Date(e)).setMonth(e.getMonth()-1),e}},year:{component:function({value:e,current:t,part:n,onCancel:r,onChange:l,onShift:a}){let[i,s]=L(e||new Date),[u,d]=L(t||new Date),h=(0,c.useContext)(J).getRaw().calendar,f=h.monthShort||[],m=(0,c.useMemo)(()=>u.getMonth(),[u]),p=(0,c.useCallback)((e,t)=>{if(null!=e){t.stopPropagation();let n=new Date(u);n.setMonth(e),d(n),a&&a({current:n})}"normal"===n&&s(new Date(u)),r&&r()},[u,n,a,r]),x=(0,c.useCallback)(()=>{let e=new Date(es(i,n)||u);e.setMonth(u.getMonth()),e.setFullYear(u.getFullYear()),l&&l(e)},[i,u,n,l]),g=(0,c.useCallback)(e=>{let t=e.target.closest("[data-id]");t&&p(parseInt(t.getAttribute("data-id"),10),e)},[p]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"wx-34U8T8 wx-months",onClick:g,children:f.map((e,t)=>(0,o.jsx)("div",{className:"wx-34U8T8 wx-month"+(m===t?" wx-current":""),"data-id":t,children:e},t))}),(0,o.jsx)("div",{className:"wx-34U8T8 wx-buttons",children:(0,o.jsx)(el,{onClick:x,children:h.done})})]})},next:function(e){return(e=new Date(e)).setFullYear(e.getFullYear()+1),e},prev:function(e){return(e=new Date(e)).setFullYear(e.getFullYear()-1),e}},duodecade:{component:({value:e,current:t,onCancel:n,onChange:r,onShift:l,part:a})=>{let i=(0,c.useContext)(J).getRaw().calendar,[s,u]=L(t),[d,h]=L(e),f=(0,c.useMemo)(()=>s.getFullYear(),[s]),m=(0,c.useMemo)(()=>{let{start:e,end:t}=$(f),n=[];for(let r=e;r<=t;++r)n.push(r);return n},[f]),p={click:function(e,t){if(e){t.stopPropagation();let n=new Date(s);n.setFullYear(e),u(n),l&&l({current:n})}"normal"===a&&h(new Date(s)),n&&n()}},x=(0,c.useRef)(null);return(0,c.useEffect)(()=>{x.current&&g(x.current,p)},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:ea+" wx-years",ref:x,children:m.map((e,t)=>(0,o.jsx)("div",{className:ea+` wx-year ${f==e?"wx-current":""} ${0===t?"wx-prev-decade":""} ${11===t?"wx-next-decade":""}`,"data-id":e,children:e},t))}),(0,o.jsx)("div",{className:ea+" wx-buttons",children:(0,o.jsx)(el,{onClick:function(){let e=new Date(es(d,a)||s);e.setFullYear(s.getFullYear()),r&&r(e)},children:i.done})})]})},next:function(e){return(e=new Date(e)).setFullYear(e.getFullYear()+10),e},prev:function(e){return(e=new Date(e)).setFullYear(e.getFullYear()-10),e}}};function es(e,t){let n;if("normal"===t)n=e;else{let{start:r,end:l}=e;n="left"===t?r:"right"==t?l:r&&l}return n}let eo=["clear","today"];function ec({value:e,current:t,onCurrentChange:n,part:r="normal",markers:l=null,buttons:a,onShift:i,onChange:s}){let u=(0,c.useContext)(J).getGroup("calendar"),[d,h]=(0,c.useState)("month"),f=Array.isArray(a)?a:a?eo:[],m=e=>{let{diff:r,current:l}=e;if(0===r)return void("month"===d?h("year"):"year"===d&&h("duodecade"));if(r){let e=ei[d];n(r>0?e.next(t):e.prev(t))}else l&&n(l);i&&i()},p=(0,c.useMemo)(()=>ei[d].component,[d]);return(0,o.jsx)("div",{className:`wx-2Gr4AS wx-calendar ${"normal"!==r&&"both"!==r?"wx-part":""}`,children:(0,o.jsxs)("div",{className:"wx-2Gr4AS wx-wrap",children:[(0,o.jsx)(er,{date:t,part:r,type:d,onShift:m}),(0,o.jsxs)("div",{children:[(0,o.jsx)(p,{value:e,current:t,onCurrentChange:n,part:r,markers:l,onCancel:()=>{"duodecade"===d?h("year"):"year"===d&&h("month")},onChange:e=>{h("month"),s&&s({select:!0,value:e})},onShift:m}),"month"===d&&f.length>0&&(0,o.jsx)("div",{className:"wx-2Gr4AS wx-buttons",children:f.map(e=>(0,o.jsx)("div",{className:"wx-2Gr4AS wx-button-item",children:(0,o.jsx)(el,{onClick:t=>{var n;return n="done"===e?-1:"clear"===e?null:"today"===e?new Date:void 0,void(t.preventDefault(),s&&s({value:n}))},children:u(e)})},e))})]})]})})}function eu(e){let{words:t=null,optional:n=!1,children:r}=e,l=(0,c.useContext)(J),a=(0,c.useMemo)(()=>{let e=l;return e&&e.extend||(e=F(G)),null!==t&&(e=e.extend(t,n)),e},[t,n,l]);return(0,o.jsx)(J.Provider,{value:a,children:r})}function ed(e,t,n,r){if(!e||r){let e=t?new Date(t):new Date;e.setDate(1),n(e)}else if(1!==e.getDate()){let t=new Date(e);t.setDate(1),n(t)}}let eh=["clear","today"];function ef({value:e,current:t,markers:n=null,buttons:r=eh,onChange:l}){let[a,i]=L(e),[s,u]=L(t);(0,c.useEffect)(()=>{ed(s,a,u,!1)},[a,s]);let d=(0,c.useCallback)(e=>{let t=e.value;t?(i(new Date(t)),ed(s,new Date(t),u,!0)):i(null),l&&l({value:t?new Date(t):null})},[l,s]),h=(0,c.useCallback)(e=>{u(e)},[u]);return s?(0,o.jsx)(eu,{children:(0,o.jsx)(ec,{value:a,current:s,markers:n,buttons:r,onChange:d,onCurrentChange:h})}):null}let em=["clear","today"];function ep({value:e,id:t=E(),disabled:n=!1,error:r=!1,width:l="unset",align:a="start",placeholder:i="",format:s="",buttons:u=em,css:d="",title:h="",editable:f=!1,clear:m=!1,onChange:p}){let{calendar:x,formats:g}=((0,c.useContext)(J)||F(G)).getRaw(),w=s||g?.dateFormat,y="function"==typeof w?w:A(w,x),[v,b]=(0,c.useState)(e),[k,S]=(0,c.useState)(!1);function C(){S(!1)}function j(e){let t=e===v||e&&v&&e.valueOf()===v.valueOf()||!e&&!v;b(e),t||p&&p({value:e}),setTimeout(C,1)}(0,c.useEffect)(()=>{b(e)},[e]);let M=(0,c.useMemo)(()=>v?y(v):"",[v,y]);return(0,c.useEffect)(()=>(window.addEventListener("scroll",C),()=>window.removeEventListener("scroll",C)),[]),(0,o.jsxs)("div",{className:"wx-1lKOFG wx-datepicker",onClick:()=>S(!0),children:[(0,o.jsx)(en,{css:d,title:h,value:M,id:t,readonly:!f,disabled:n,error:r,placeholder:i,onInput:C,onChange:function({value:e,input:t}){if(!f&&!m||t)return;let n="function"==typeof f?f(e):e?new Date(e):null;j(n=isNaN(n)?v||null:n||null)},icon:"wxi-calendar",inputStyle:{cursor:"pointer",width:"100%",paddingRight:"calc(var(--wx-input-icon-size) + var(--wx-input-icon-indent) * 2)"},clear:m}),k&&!n&&(0,o.jsx)(U,{onCancel:C,width:l,align:a,autoFit:!!a,children:(0,o.jsx)(ef,{buttons:u,value:v,onChange:e=>j(e.value)})})]})}function ex({id:e=E(),label:t="",value:n,name:r="",inputValue:l="",disabled:a=!1,onChange:i}){let[s,u]=(0,c.useState)(!1),d=void 0!==n;return(0,o.jsxs)("div",{className:"wx-3lDF1s wx-radio",children:[(0,o.jsx)("input",{type:"radio",className:"wx-3lDF1s wx-input",id:e,disabled:a,name:r,value:l,checked:d?n:s,onChange:function(e){let t=e.target.checked;d||u(t),t&&i&&i({value:!0,inputValue:l})}}),(0,o.jsxs)("label",{htmlFor:e,className:"wx-3lDF1s wx-label",children:[(0,o.jsx)("span",{className:"wx-3lDF1s wx-circle"}),t&&(0,o.jsx)("span",{className:"wx-3lDF1s wx-radio-text",children:t})]})]})}function eg({value:e="",options:t=[],textOptions:n=null,placeholder:r="",disabled:l=!1,error:a=!1,title:i="",textField:s="label",clear:u=!1,children:d,onChange:h}){let f=(0,c.useRef)(null),m=(0,c.useRef)(null),[p,x]=L(e),g=(0,c.useMemo)(()=>p||0===p?(n||t).find(e=>e.id===p):null,[p,n,t]),w=(0,c.useCallback)(({id:e})=>{(e||0===e)&&(x(e),f.current(null),h&&h({value:e}))},[x,h]),y=(0,c.useCallback)(e=>{e.stopPropagation(),x(""),h&&h({value:""})},[x,h]),v=(0,c.useCallback)(()=>t.findIndex(e=>e.id===p),[t,p]);return(0,o.jsxs)("div",{className:`wx-2YgblL wx-richselect ${a?"wx-2YgblL wx-error":""} ${l?"wx-2YgblL wx-disabled":""} ${d?"":"wx-2YgblL wx-nowrap"}`,title:i,onClick:()=>f.current(v()),onKeyDown:e=>m.current(e,v()),tabIndex:0,children:[(0,o.jsx)("div",{className:"wx-2YgblL wx-label",children:g?d?d(g):g[s]:r?(0,o.jsx)("span",{className:"wx-2YgblL wx-placeholder",children:r}):"Â "}),u&&!l&&p?(0,o.jsx)("i",{className:"wx-2YgblL wx-icon wxi-close",onClick:y}):(0,o.jsx)("i",{className:"wx-2YgblL wx-icon wxi-angle-down"}),!l&&(0,o.jsx)(ee,{items:t,onReady:function(e){f.current=e.navigate,m.current=e.keydown},onSelect:w,children:({option:e})=>d?d(e):e[s]})]})}function ew({id:e=E(),label:t="",css:n="",min:r=0,max:l=100,value:a=0,step:i=1,title:s="",disabled:u=!1,onChange:d}){let[h,f]=L(a),m=(0,c.useRef)({value:h,input:h}),p=(0,c.useMemo)(()=>(h-r)/(l-r)*100+"%",[h,r,l]),x=(0,c.useMemo)(()=>u?"":`linear-gradient(90deg, var(--wx-slider-primary) 0% ${p}, var(--wx-slider-background) ${p} 100%)`,[u,p]);function g({target:e}){let t=+e.value;f(t),d&&d({value:t,previous:m.current.value}),m.current.value=t}(0,c.useEffect)(()=>{f(a)},[a]);let w=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(w.current)return w.current.addEventListener("change",g),()=>{w.current&&w.current.removeEventListener("change",g)}},[w,g]),(0,o.jsxs)("div",{className:`wx-2EDJ8G wx-slider ${n}`,title:s,children:[t&&(0,o.jsx)("label",{className:"wx-2EDJ8G wx-label",htmlFor:e,children:t}),(0,o.jsx)("div",{className:"wx-2EDJ8G wx-inner",children:(0,o.jsx)("input",{id:e,className:"wx-2EDJ8G wx-input",type:"range",min:r,max:l,step:i,disabled:u,value:h,onInput:function({target:e}){let t=+e.value;f(t),d&&d({value:t,previous:m.current.input,input:!0}),m.current.input=t},style:{background:x},ref:w})})]})}function ey({notice:e={}}){return(0,o.jsxs)("div",{className:`wx-11sNg5 wx-notice wx-${e.type?e.type:""}`,role:"status","aria-live":"polite",children:[(0,o.jsx)("div",{className:"wx-11sNg5 wx-text",children:e.text}),(0,o.jsx)("div",{className:"wx-11sNg5 wx-button",children:(0,o.jsx)("i",{className:"wx-11sNg5 wxi-close",onClick:function(){e.remove&&e.remove()}})})]})}function ev({data:e=[]}){return(0,o.jsx)("div",{className:"wx-3nwoO9 wx-notices",children:e.map(e=>(0,o.jsx)(ey,{notice:e},e.id))})}function eb({title:e="",buttons:t=["cancel","ok"],header:n,children:r,footer:l,onConfirm:a,onCancel:i}){let s=((0,c.useContext)(J)||F(G)).getGroup("core"),u=(0,c.useRef)(null);return(0,c.useEffect)(()=>{u.current?.focus()},[]),(0,o.jsx)("div",{className:"wx-1FxkZa wx-modal",ref:u,tabIndex:0,onKeyDown:function(e){switch(e.code){case"Enter":{let t=e.target.tagName;if("TEXTAREA"===t||"BUTTON"===t)return;a&&a({event:e});break}case"Escape":i&&i({event:e})}},children:(0,o.jsxs)("div",{className:"wx-1FxkZa wx-window",children:[n||(e?(0,o.jsx)("div",{className:"wx-1FxkZa wx-header",children:e}):null),(0,o.jsx)("div",{children:r}),l||t&&(0,o.jsx)("div",{className:"wx-1FxkZa wx-buttons",children:t.map(e=>(0,o.jsx)("div",{className:"wx-1FxkZa wx-button",children:(0,o.jsx)(q,{type:`block ${"ok"===e?"primary":"secondary"}`,onClick:t=>{let n;return n={event:t,button:e},void("cancel"===e?i&&i(n):a&&a(n))},children:s(e)})},e))})]})})}function ek({label:e="",position:t="",css:n="",error:r=!1,type:l="",required:a=!1,children:i}){let s=(0,c.useMemo)(()=>E(),[]);return(0,o.jsxs)("div",{className:`wx-2oVUvC wx-field wx-${t} ${n} ${r?"wx-error":""} ${a?"wx-required":""}`.trim(),children:[e&&(0,o.jsx)("label",{className:"wx-2oVUvC wx-label",htmlFor:s,children:e}),(0,o.jsx)("div",{className:`wx-2oVUvC wx-field-control wx-${l}`,children:O(i,{id:s})})]})}(0,c.forwardRef)(function({children:e},t){let[n,r]=(0,c.useState)(null),[l,a]=(0,c.useState)([]);return(0,c.useImperativeHandle)(t,()=>({showModal:e=>{let t={...e};return r(t),new Promise((e,n)=>{t.resolve=t=>{r(null),e(t)},t.reject=e=>{r(null),n(e)}})},showNotice:e=>{(e={...e}).id=e.id||E(),e.remove=()=>a(t=>t.filter(t=>t.id!==e.id)),-1!=e.expire&&setTimeout(e.remove,e.expire||5100),a(t=>[...t,e])}}),[]),(0,o.jsxs)(o.Fragment,{children:[e,n&&(0,o.jsx)(eb,{title:n.title,buttons:n.buttons,onConfirm:n.resolve,onCancel:n.reject,children:n.message}),(0,o.jsx)(ev,{data:l})]})});let eS=({value:e=!1,type:t="",icon:n="",disabled:r=!1,iconActive:l="",onClick:a,title:i="",css:s="",text:u="",textActive:d="",children:h,active:f,onChange:m})=>{let[p,x]=L(e),g=(0,c.useMemo)(()=>(p?"pressed":"")+(t?" "+t:""),[p,t]),w=(0,c.useCallback)(e=>{let t=!p;a&&a(e),e.defaultPrevented||(x(t),m&&m({value:t}))},[p,a,m]);return p&&f?(0,o.jsx)(q,{title:i,text:p&&d||u,css:s,type:g,icon:p&&l||n,onClick:w,disabled:r,children:O(f,{value:p})}):h?(0,o.jsx)(q,{title:i,text:p&&d||u,css:s,type:g,icon:p&&l||n,onClick:w,disabled:r,children:h}):(0,o.jsx)(q,{title:i,text:p&&d||u,css:s,type:g,icon:p&&l||n,onClick:w,disabled:r})},eC=new Date(0,0,0,0,0);function ej({value:e=eC,id:t,title:n="",css:r="",disabled:l=!1,error:a=!1,format:i="",onChange:s}){let u,[d,h]=L(e),{calendar:f,formats:m}=((0,c.useContext)(J)||F(G)).getRaw(),p=12==f.clockFormat,x=(0,c.useMemo)(()=>{let e=i||m?.timeFormat;return"function"==typeof e?e:A(e,f)},[i,m,f]),g=(0,c.useMemo)(()=>-1!=x(new Date(0,0,0,1)).indexOf("01"),[x]),w=(e,t)=>(e<10&&t?`0${e}`:`${e}`).slice(-2),y=(0,c.useCallback)((e,t)=>{let n;return n=e,Math.min(e=`${n}`.replace(/[^\d]/g,"")||0,t)},[]),[v,b]=(0,c.useState)(null),k=d||eC,S=y(k.getHours(),23),C=y(k.getMinutes(),59),j=S>12,M=(u=S,p&&0==(u%=12)?"12":w(u,g)),_=w(C,!0),N=(0,c.useMemo)(()=>x(new Date(0,0,0,S,C)),[S,C,x]),E=(0,c.useCallback)(()=>{b(!0)},[]),T=(0,c.useCallback)(()=>{let e=new Date(k);e.setHours(e.getHours()+(j?-12:12)),h(e),s&&s({value:e})},[k,j,s]),$=(0,c.useCallback)(({value:e})=>{if(k.getHours()===e)return;let t=new Date(k);t.setHours(e),h(t),s&&s({value:t})},[k,s]),D=(0,c.useCallback)(({value:e})=>{if(k.getMinutes()===e)return;let t=new Date(k);t.setMinutes(e),h(t),s&&s({value:t})},[k,s]),R=(0,c.useCallback)(e=>(e=y(e,23),p&&(12==(e*=1)&&(e=0),j&&(e+=12)),e),[y,p,j]),I=(0,c.useCallback)(()=>{b(null)},[]);return(0,o.jsxs)("div",{className:`wx-7f497i wx-timepicker ${a?"wx-7f497i wx-error":""} ${l?"wx-7f497i wx-disabled":""}`,onClick:l?void 0:E,style:{cursor:l?"default":"pointer"},children:[(0,o.jsx)(en,{id:t,css:r,title:n,value:N,readonly:!0,disabled:l,error:a,icon:"wxi-clock",inputStyle:{cursor:"pointer",width:"100%",paddingRight:"calc(var(--wx-input-icon-size) + var(--wx-input-icon-indent) * 2)"}}),v&&!l&&(0,o.jsx)(U,{onCancel:I,width:"unset",children:(0,o.jsxs)("div",{className:"wx-7f497i wx-wrapper",children:[(0,o.jsxs)("div",{className:"wx-7f497i wx-timer",children:[(0,o.jsx)("input",{className:"wx-7f497i wx-digit",value:M,onChange:e=>{$({value:R(e.target.value)})}}),(0,o.jsx)("div",{className:"wx-7f497i wx-separator",children:":"}),(0,o.jsx)("input",{className:"wx-7f497i wx-digit",value:_,onChange:e=>{D({value:y(e.target.value,59)})}}),p&&(0,o.jsx)(eS,{value:j,onClick:T,active:()=>(0,o.jsx)("span",{children:"pm"}),children:(0,o.jsx)("span",{children:"am"})})]}),(0,o.jsx)(ek,{width:"unset",children:(0,o.jsx)(ew,{label:f.hours,value:S,onChange:$,max:23})}),(0,o.jsx)(ek,{width:"unset",children:(0,o.jsx)(ew,{label:f.minutes,value:C,onChange:D,max:59})})]})})]})}function eM({children:e}){return(0,o.jsx)("div",{className:"wx-KgpO9N wx-modal",children:(0,o.jsx)("div",{className:"wx-KgpO9N wx-window",children:e})})}function e_({position:e="right",children:t,onCancel:n}){let r=(0,c.useRef)(null);return(0,c.useEffect)(()=>C(r.current,n).destroy,[]),(0,o.jsx)("div",{ref:r,className:`wx-2L733M wx-sidearea wx-pos-${e}`,children:t})}function eN({theme:e="",target:t,children:n}){let r=(0,c.useRef)(null),l=(0,c.useRef)(null),[a,i]=(0,c.useState)(null);r.current||(r.current=document.createElement("div"));let s=(0,c.useContext)(Q);return(0,c.useEffect)(()=>{i(t||function(e){let t=m.getTopNode(e);for(;e&&e!==t&&!e.getAttribute("data-wx-portal-root");)e=e.parentNode;return e}(l.current)||m.getTopNode(l.current))},[l.current]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{ref:l,style:{display:"none"}}),l.current&&a?(0,K.createPortal)((0,o.jsx)("div",{className:`wx-3ZWsT0 wx-${e||s}-theme`,children:n}),a):null]})}function eE(){return(0,o.jsx)(o.Fragment,{})}function eT(e){let{fonts:t=!0,children:n}=e;return(0,o.jsx)(Q.Provider,{value:"willow",children:(0,o.jsxs)(o.Fragment,{children:[n&&n&&(0,o.jsx)("div",{className:"wx-willow-theme",children:n}),t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("link",{rel:"preconnect",href:"https://cdn.webix.com",crossOrigin:"true"}),(0,o.jsx)(eE,{}),(0,o.jsx)("link",{rel:"stylesheet",href:"https://webix.io/dev/fonts/wxi/wx-icons.css"})]})]})})}p(m);let e$={gantt:{"Task name":"Task name","Start date":"Start date","Add task":"Add task",Duration:"Duration",Task:"Task",Milestone:"Milestone","Summary task":"Summary task",Save:"Save",Delete:"Delete",Name:"Name",Description:"Description","Select type":"Select type",Type:"Type","End date":"End date",Progress:"Progress",Predecessors:"Predecessors",Successors:"Successors","Add task name":"Add task name","Add description":"Add description","Select link type":"Select link type","End-to-start":"End-to-start","Start-to-start":"Start-to-start","End-to-end":"End-to-end","Start-to-end":"Start-to-end",Add:"Add","Child task":"Child task","Task above":"Task above","Task below":"Task below","Convert to":"Convert to",Edit:"Edit",Cut:"Cut",Copy:"Copy",Paste:"Paste",Move:"Move",Up:"Up",Down:"Down",Indent:"Indent",Outdent:"Outdent","Split task":"Split task","New task":"New task","Move up":"Move up","Move down":"Move down"}};var eD=new Date().valueOf();function eR(e,t){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||null===e)return e===t;if(typeof e!=typeof t||(null===e||null===t)&&e!==t||e instanceof Date&&t instanceof Date&&e.getTime()!==t.getTime())return!1;if("object"==typeof e)if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=e.length-1;n>=0;n--)if(!eR(e[n],t[n]))return!1;return!0}else{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in t)if(!eR(e[n],t[n]))return!1;return!0}return e===t}function eA(e){if("object"!=typeof e||null===e)return e;if(e instanceof Date)return new Date(e);if(e instanceof Array)return e.map(eA);let t={};for(let n in e)t[n]=eA(e[n]);return t}var eI=class{constructor(e){this._nextHandler=null,this._dispatch=e,this.exec=this.exec.bind(this)}async exec(e,t){return this._dispatch(e,t),this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}},eH=new Date().valueOf();function eF(){return"temp://"+eH++}var eL=class{constructor(e){this._data=e,this._pool=new Map;for(let t=0;t<e.length;t++){const n=e[t];this._pool.set(n.id,n)}}add(e){e={id:eH++,...e},this._data.push(e),this._pool.set(e.id,e)}update(e,t){let n=this._data.findIndex(t=>t.id==e),r={...this._data[n],...t};this._data[n]=r,this._pool.set(r.id,r)}remove(e){this._data=this._data.filter(t=>t.id!=e),this._pool.delete(e)}filter(e){this._data=this._data.filter(t=>{let n=e(t);return n||this._pool.delete(t.id),n})}byId(e){return this._pool.get(e)}map(e){return this._data.map(e)}forEach(e){this._data.forEach(e)}},ez=class{constructor(e){const t=new Map;t.set(0,{id:0,$level:0,data:[],parent:null}),this._pool=t,e&&e.length&&this.parse(e,0)}parse(e,t){let n=this._pool;for(let r=0;r<e.length;r++){let l=e[r];l.parent=l.parent||t,l.data=null,n.set(l.id,l)}for(let t=0;t<e.length;t++){let r=e[t],l=n.get(r.parent);l&&(l.data||(l.data=[]),l.data.push(r))}let r=n.get(t);this.setLevel(r,r.$level+1,!1)}add(e,t){let n=this._pool.get(e.parent||0);e.$level=n.$level+1,this._pool.set(e.id,e),n.data?-1===t?n.data=[...n.data,e]:eP(n,t,e):n.data=[e]}addAfter(e,t){if(!t)return this.add(e,-1);let n=this.byId(t),r=this.byId(n.parent),l=eW(r,n.id)+1;e.parent=r.id,e.$level=r.$level+1,this.add(e,l)}remove(e){let t=this._pool.get(e);this._remove(t);let n=this._pool.get(t.parent);n.data=n.data.filter(t=>t.id!=e),this._clearBranch(n)}_remove(e){e.data&&e.data.forEach(e=>this._remove(e)),this._pool.delete(e.id)}update(e,t){let n=this._pool.get(e),r=this._pool.get(n.parent),l=eW(r,n.id);n={...n,...t},r&&l>=0&&(r.data[l]=n,r.data=[...r.data]),this._pool.set(n.id,n)}move(e,t,n){var r,l;let a,i=this._pool.get(e),s="child"===t,o=this._pool.get(n),c=o.$level+ +!!s;if(!i||!o)return;let u=this._pool.get(i.parent),d=s?o:this._pool.get(o.parent);d.data||(d.data=[]);let h=eW(u,i.id);r=u,l=h,(a=[...r.data]).splice(l,1),r.data=a;let f=s?d.data.length:eW(d,o.id)+ +("after"===t);if(eP(d,f,i),u.id===d.id&&h===f)return null;i.parent=d.id,i.$level!==c&&(i.$level=c,this.setLevel(i,c+1,!0)),this.update(i.id,i),this._clearBranch(u)}_clearBranch(e){e.data&&!e.data.length&&(e.open&&delete e.open,this.update(e.id,{data:null}))}toArray(){let e=[],t=this._pool.get(0).data;return t&&function e(t,n){t.forEach(t=>{n.push(t),!0===t.open&&e(t.data,n)})}(t,e),e}byId(e){return this._pool.get(e)}getBranch(e){return this._pool.get(e).data}forEach(e){this._pool.forEach((t,n)=>{0!==n&&e(t)})}eachChild(e,t){let n=this.byId(t);n&&n.data&&n.data.forEach((t,n)=>{e(this.byId(t.id),n),this.eachChild(e,t.id)})}setLevel(e,t,n){e.data&&(e.data=e.data.map(e=>(n&&(e={...e},this._pool.set(e.id,e)),e.$level=t,e.data&&this.setLevel(e,t+1,n),e)))}};function eP(e,t,n){let r=[...e.data];r.splice(t,0,n),e.data=r}function eW(e,t){return e?.data.findIndex(e=>e.id===t)}var eO=class{constructor(e){e&&(this._writable=e.writable,this._async=e.async),this._values={},this._state={}}setState(e,t=0){let n={};return this._wrapProperties(e,this._state,this._values,"",n,t),n}getState(){return this._values}getReactive(){return this._state}_wrapProperties(e,t,n,r,l,a){for(let i in e){let s=t[i],o=n[i],c=e[i];if(s&&(o===c&&"object"!=typeof c||c instanceof Date&&o instanceof Date&&o.getTime()===c.getTime()))continue;let u=r+(r?".":"")+i;s?(s.__parse(c,u,l,a)&&(n[i]=c),2&a?l[u]=s.__trigger:s.__trigger()):(c&&c.__reactive?t[i]=this._wrapNested(c,c,u,l):t[i]=this._wrapWritable(c),n[i]=c),l[u]=l[u]||null}}_wrapNested(e,t,n,r){let l=this._wrapWritable(e);return this._wrapProperties(e,l,t,n,r,0),l.__parse=(e,n,r,a)=>(this._wrapProperties(e,l,t,n,r,a),!1),l}_wrapWritable(e){let t=[],n=function(){for(let n=0;n<t.length;n++)t[n](e)};return{subscribe:n=>(t.push(n),this._async?setTimeout(n,1,e):n(e),()=>{let e=t.indexOf(n);e>=0&&t.splice(e,1)}),__trigger:()=>{t.length&&(this._async?setTimeout(n,1):n())},__parse:function(t){return e=t,!0}}}},eY=class{constructor(e,t,n,r){"function"==typeof e?this._setter=e:this._setter=e.setState.bind(e),this._routes=t,this._parsers=n,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(e=>{e.in.forEach(t=>{let n=this._triggers.get(t)||[];n.push(e),this._triggers.set(t,n)}),e.out.forEach(t=>{let n=this._sources.get(t)||{};e.in.forEach(e=>n[e]=!0),this._sources.set(t,n)})}),this._routes.forEach(e=>{e.length=Math.max(...e.in.map(e=>(function e(t,n,r){let l=n.get(t);return l?Math.max(...Object.keys(l).map(t=>e(t,n,r+1))):r})(e,this._sources,1)))}),this._bus=r}init(e){let t={};for(let n in e)if(this._prev[n]!==e[n]){let r=this._parsers[n];t[n]=r?r(e[n]):e[n]}this._prev=this._prev?{...this._prev,...e}:{...e},this.setState(t),this._bus&&this._bus.exec("init-state",t)}setStateAsync(e){let t=this._setter(e,2);return this._async?Object.assign(this._async.signals,t):this._async={signals:t,timer:setTimeout(this._applyState.bind(this),1)},t}_applyState(){let e=this._async;if(e)for(let t in this._async=null,this._triggerUpdates(e.signals,[]),e.signals){let n=e.signals[t];n&&n()}}setState(e,t=[]){let n=this._setter(e);return this._triggerUpdates(n,t),n}_triggerUpdates(e,t){let n=Object.keys(e),r=!t.length;t=t||[];for(let e=0;e<n.length;e++){let r=n[e],l=this._triggers.get(r);l&&l.forEach(e=>{-1==t.indexOf(e)&&t.push(e)})}r&&this._execNext(t)}_execNext(e){for(;e.length;){e.sort((e,t)=>e.length<t.length?1:-1);let t=e[e.length-1];e.splice(e.length-1),t.exec(e)}}},eB=class{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(e,t,n){let r=this._handlers[e];r?n&&n.intercept?r.unshift(t):r.push(t):r=this._handlers[e]=[t],n&&n.tag&&this._tag.set(t,n.tag)}intercept(e,t,n){this.on(e,t,{...n,intercept:!0})}detach(e){for(let t in this._handlers){let n=this._handlers[t];for(let t=n.length-1;t>=0;t--)this._tag.get(n[t])===e&&n.splice(t,1)}}async exec(e,t){let n=this._handlers[e];if(n)for(let e=0;e<n.length;e++){let r=n[e](t);if(!1===r||r&&r.then&&await r===!1)return}return this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}};function eV(e,t){return"string"==typeof e?e.localeCompare(t,void 0,{numeric:!0}):"object"==typeof e?e.getTime()-t.getTime():(e??0)-(t??0)}function eG(e,t){return"string"==typeof e?-e.localeCompare(t,void 0,{numeric:!0}):"object"==typeof t?t.getTime()-e.getTime():(t??0)-(e??0)}function eK(e){let t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):new Date("number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?e:NaN)}function eq(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function eU(e,t){let n=eK(e);return isNaN(t)?eq(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function eQ(e,t){let n=eK(e);if(isNaN(t))return eq(e,NaN);if(!t)return n;let r=n.getDate(),l=eq(e,n.getTime());return l.setMonth(n.getMonth()+t+1,0),r>=l.getDate()?l:(n.setFullYear(l.getFullYear(),l.getMonth(),r),n)}function eX(e,t){let n=+eK(e);return eq(e,n+t)}let eJ={};function eZ(e,t){let n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??eJ.weekStartsOn??eJ.locale?.options?.weekStartsOn??0,r=eK(e),l=r.getDay();return r.setDate(r.getDate()-(7*(l<n)+l-n)),r.setHours(0,0,0,0),r}function e0(e){return eZ(e,{weekStartsOn:1})}function e1(e){let t=eK(e),n=t.getFullYear(),r=eq(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);let l=e0(r),a=eq(e,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);let i=e0(a);return t.getTime()>=l.getTime()?n+1:t.getTime()>=i.getTime()?n:n-1}function e2(e){let t=eK(e);return t.setHours(0,0,0,0),t}function e4(e){let t=eK(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),e-n}function e3(e,t){let n=e2(e),r=e2(t);return Math.round((n-e4(n)-(r-e4(r)))/864e5)}function e5(e){let t=e1(e),n=eq(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),e0(n)}function e6(e,t){return eU(e,7*t)}function e7(e,t){let n=eK(e),r=eK(t),l=n.getTime()-r.getTime();return l<0?-1:l>0?1:l}function e8(e,t){let n=e0(e),r=e0(t);return Math.round((n-e4(n)-(r-e4(r)))/6048e5)}function e9(e){return t=>{let n=(e?Math[e]:Math.trunc)(t);return 0===n?0:n}}function te(e){let t=eK(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function tt(e,t){let n,r,l,a=eK(e),i=eK(t),s=e7(a,i),o=Math.abs((r=eK(a),l=eK(i),12*(r.getFullYear()-l.getFullYear())+(r.getMonth()-l.getMonth())));if(o<1)n=0;else{var c;let t,r;1===a.getMonth()&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-s*o);let l=e7(a,i)===-s;c=eK(e),r=eK(c),+((t=eK(r)).setHours(23,59,59,999),t)==+te(r)&&1===o&&1===e7(e,i)&&(l=!1),n=s*(o-Number(l))}return 0===n?0:n}function tn(e){let t=eK(e),n=t.getMonth();return t.setMonth(n-n%3,1),t.setHours(0,0,0,0),t}function tr(e){let t=eK(e);return t.setDate(1),t.setHours(0,0,0,0),t}function tl(e){let t=eK(e),n=eq(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function ta(e){let t=eK(e),n=t.getMonth();return t.setMonth(n-n%3+3,0),t.setHours(23,59,59,999),t}let ti={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function ts(e){return (t={})=>{let n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}let to={date:ts({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:ts({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:ts({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},tc={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function tu(e){return(t,n)=>{let r;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){let t=e.defaultFormattingWidth||e.defaultWidth,l=n?.width?String(n.width):t;r=e.formattingValues[l]||e.formattingValues[t]}else{let t=e.defaultWidth,l=n?.width?String(n.width):e.defaultWidth;r=e.values[l]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function td(e){return(t,n={})=>{let r,l=n.width,a=l&&e.matchPatterns[l]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;let s=i[0],o=l&&e.parsePatterns[l]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}(o,e=>e.test(s)):function(e,t){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}(o,e=>e.test(s));return r=e.valueCallback?e.valueCallback(c):c,{value:r=n.valueCallback?n.valueCallback(r):r,rest:t.slice(s.length)}}}let th={code:"en-US",formatDistance:(e,t,n)=>{let r,l=ti[e];return r="string"==typeof l?l:1===t?l.one:l.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:to,formatRelative:(e,t,n,r)=>tc[e],localize:{ordinalNumber:(e,t)=>{let n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:tu({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:tu({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:tu({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:tu({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:tu({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(r={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{let n=e.match(r.matchPattern);if(!n)return null;let l=n[0],a=e.match(r.parsePattern);if(!a)return null;let i=r.valueCallback?r.valueCallback(a[0]):a[0];return{value:i=t.valueCallback?t.valueCallback(i):i,rest:e.slice(l.length)}}),era:td({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:td({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:td({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:td({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:td({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function tf(e,t){let n=eK(e),r=n.getFullYear(),l=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??eJ.firstWeekContainsDate??eJ.locale?.options?.firstWeekContainsDate??1,a=eq(e,0);a.setFullYear(r+1,0,l),a.setHours(0,0,0,0);let i=eZ(a,t),s=eq(e,0);s.setFullYear(r,0,l),s.setHours(0,0,0,0);let o=eZ(s,t);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function tm(e,t){let n=Math.abs(e).toString().padStart(t,"0");return(e<0?"-":"")+n}let tp={y(e,t){let n=e.getFullYear(),r=n>0?n:1-n;return tm("yy"===t?r%100:r,t.length)},M(e,t){let n=e.getMonth();return"M"===t?String(n+1):tm(n+1,2)},d:(e,t)=>tm(e.getDate(),t.length),a(e,t){let n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>tm(e.getHours()%12||12,t.length),H:(e,t)=>tm(e.getHours(),t.length),m:(e,t)=>tm(e.getMinutes(),t.length),s:(e,t)=>tm(e.getSeconds(),t.length),S(e,t){let n=t.length;return tm(Math.trunc(e.getMilliseconds()*Math.pow(10,n-3)),t.length)}},tx={G:function(e,t,n){let r=+(e.getFullYear()>0);switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){let t=e.getFullYear();return n.ordinalNumber(t>0?t:1-t,{unit:"year"})}return tp.y(e,t)},Y:function(e,t,n,r){let l=tf(e,r),a=l>0?l:1-l;return"YY"===t?tm(a%100,2):"Yo"===t?n.ordinalNumber(a,{unit:"year"}):tm(a,t.length)},R:function(e,t){return tm(e1(e),t.length)},u:function(e,t){return tm(e.getFullYear(),t.length)},Q:function(e,t,n){let r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return tm(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){let r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return tm(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){let r=e.getMonth();switch(t){case"M":case"MM":return tp.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){let r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return tm(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){let l,a,i,s,o=Math.round((eZ(s=eK(e),r)-(l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??eJ.firstWeekContainsDate??eJ.locale?.options?.firstWeekContainsDate??1,a=tf(s,r),(i=eq(s,0)).setFullYear(a,0,l),i.setHours(0,0,0,0),eZ(i,r)))/6048e5)+1;return"wo"===t?n.ordinalNumber(o,{unit:"week"}):tm(o,t.length)},I:function(e,t,n){let r,l=Math.round((e0(r=eK(e))-e5(r))/6048e5)+1;return"Io"===t?n.ordinalNumber(l,{unit:"week"}):tm(l,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):tp.d(e,t)},D:function(e,t,n){let r,l=e3(r=eK(e),tl(r))+1;return"Do"===t?n.ordinalNumber(l,{unit:"dayOfYear"}):tm(l,t.length)},E:function(e,t,n){let r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){let l=e.getDay(),a=(l-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return tm(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(l,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(l,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(l,{width:"short",context:"formatting"});default:return n.day(l,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){let l=e.getDay(),a=(l-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return tm(a,t.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(l,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(l,{width:"narrow",context:"standalone"});case"cccccc":return n.day(l,{width:"short",context:"standalone"});default:return n.day(l,{width:"wide",context:"standalone"})}},i:function(e,t,n){let r=e.getDay(),l=0===r?7:r;switch(t){case"i":return String(l);case"ii":return tm(l,t.length);case"io":return n.ordinalNumber(l,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){let r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){let r,l=e.getHours();switch(r=12===l?"noon":0===l?"midnight":l/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){let r,l=e.getHours();switch(r=l>=17?"evening":l>=12?"afternoon":l>=4?"morning":"night",t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return tp.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):tp.H(e,t)},K:function(e,t,n){let r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):tm(r,t.length)},k:function(e,t,n){let r=e.getHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):tm(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):tp.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):tp.s(e,t)},S:function(e,t){return tp.S(e,t)},X:function(e,t,n){let r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return tw(r);case"XXXX":case"XX":return ty(r);default:return ty(r,":")}},x:function(e,t,n){let r=e.getTimezoneOffset();switch(t){case"x":return tw(r);case"xxxx":case"xx":return ty(r);default:return ty(r,":")}},O:function(e,t,n){let r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+tg(r,":");default:return"GMT"+ty(r,":")}},z:function(e,t,n){let r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+tg(r,":");default:return"GMT"+ty(r,":")}},t:function(e,t,n){return tm(Math.trunc(e.getTime()/1e3),t.length)},T:function(e,t,n){return tm(e.getTime(),t.length)}};function tg(e,t=""){let n=e>0?"-":"+",r=Math.abs(e),l=Math.trunc(r/60),a=r%60;return 0===a?n+String(l):n+String(l)+t+tm(a,2)}function tw(e,t){return e%60==0?(e>0?"-":"+")+tm(Math.abs(e)/60,2):ty(e,t)}function ty(e,t=""){let n=Math.abs(e);return(e>0?"-":"+")+tm(Math.trunc(n/60),2)+t+tm(n%60,2)}let tv=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},tb=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},tk={p:tb,P:(e,t)=>{let n,r=e.match(/(P+)(p+)?/)||[],l=r[1],a=r[2];if(!a)return tv(e,t);switch(l){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",tv(l,t)).replace("{{time}}",tb(a,t))}},tS=/^D+$/,tC=/^Y+$/,tj=["D","DD","YY","YYYY"],tM=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,t_=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tN=/^'([^]*?)'?$/,tE=/''/g,tT=/[a-zA-Z]/;function t$(e,t,n){let r=n?.locale??eJ.locale??th,l=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??eJ.firstWeekContainsDate??eJ.locale?.options?.firstWeekContainsDate??1,a=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??eJ.weekStartsOn??eJ.locale?.options?.weekStartsOn??0,i=eK(e);if(!((i instanceof Date||"object"==typeof i&&"[object Date]"===Object.prototype.toString.call(i)||"number"==typeof i)&&!isNaN(Number(eK(i)))))throw RangeError("Invalid time value");let s=t.match(t_).map(e=>{let t=e[0];return"p"===t||"P"===t?(0,tk[t])(e,r.formatLong):e}).join("").match(tM).map(e=>{if("''"===e)return{isToken:!1,value:"'"};let t=e[0];if("'"===t){var n;let t;return{isToken:!1,value:(t=(n=e).match(tN))?t[1].replace(tE,"'"):n}}if(tx[t])return{isToken:!0,value:e};if(t.match(tT))throw RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});r.localize.preprocessor&&(s=r.localize.preprocessor(i,s));let o={firstWeekContainsDate:l,weekStartsOn:a,locale:r};return s.map(l=>{if(!l.isToken)return l.value;let a=l.value;return(!n?.useAdditionalWeekYearTokens&&tC.test(a)||!n?.useAdditionalDayOfYearTokens&&tS.test(a))&&function(e,t,n){var r,l,a;let i,s=(r=e,l=t,a=n,i="Y"===r[0]?"years":"days of the month",`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${l}\`) for formatting ${i} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`);if(console.warn(s),tj.includes(e))throw RangeError(s)}(a,t,String(e)),(0,tx[a[0]])(i,a,r.localize,o)}).join("")}function tD(e){let t=eK(e),n=t.getFullYear(),r=t.getMonth(),l=eq(e,0);return l.setFullYear(n,r+1,0),l.setHours(0,0,0,0),l.getDate()}function tR(e){let t,n=eK(e);return"Invalid Date"===String(new Date(n))?NaN:(t=eK(n).getFullYear())%400==0||t%4==0&&t%100!=0?366:365}function tA(e,t){return+eK(e)==+eK(t)}function tI(e,t,n,r){let l=e.getSummaryId(t.id);if(l){let t=e.byId(l),a={xMin:1/0,xMax:0};(function e(t,n,r,l){let{lengthUnit:a,start:i}=r;t.data?.forEach(t=>{if(!t.unscheduled){typeof t.$x>"u"&&(t.$x=Math.round(r.diff(t.start,i,a)*l),t.$w=Math.round(r.diff(t.end,t.start,a,!0)*l));let e="milestone"===t.type&&t.$h?t.$h/2:0;n.xMin>t.$x&&(n.xMin=t.$x+e);let s=t.$x+t.$w-e;n.xMax<s&&(n.xMax=s)}"summary"!==t.type&&e(t,n,r,l)})})(t,a,n,r),t.$x=a.xMin,t.$w=a.xMax-a.xMin,tI(e,t,n,r)}}function tH(e,t){let n;t&&(n=t.filter(t=>t.parent==e.id));let r={data:n,...e};if(r.data?.length)r.data.forEach(e=>{if(e.unscheduled&&!e.data)return;(t||"summary"!=e.type&&e.data)&&(e.unscheduled&&(e={...e,start:void 0,end:void 0}),e=tH(e,t)),e.start&&(!r.start||r.start>e.start)&&(r.start=new Date(e.start));let n="milestone"===e.type?e.start:e.end;n&&(!r.end||r.end<n)&&(r.end=new Date(n))});else if("summary"===e.type)throw Error("Summary tasks must have start and end dates if they have no subtasks");return r}function tF(e,t,n,r,l,a,i){let{start:s,end:o,lengthUnit:c,diff:u}=l,d=(i?"base_":"")+"start",h=(i?"base_":"")+"end",f="$x"+(i?"_base":""),m="$y"+(i?"_base":""),p="$w"+(i?"_base":""),x="$h"+(i?"_base":""),g="$skip"+(i?"_baseline":""),w=e[d],y=e[h];if(i&&!w){e[g]=!0;return}e[d]<s&&(e[h]<s||tA(e[h],s))?w=y=s:e[d]>o&&(w=y=o),e[f]=Math.round(u(w,s,c)*n),e[m]=i?e.$y+e.$h+4:r*t+3,e[p]=Math.round(u(y,w,c,!0)*n),e[x]=i?8:a?r-7-12:r-7,"milestone"===e.type&&(e[f]=e[f]-e.$h/2,e[p]=e.$h,i&&(e[m]=e.$y+8,e[p]=e[x]=e.$h)),e.unscheduled&&!i?e.$skip=!0:e[g]=tA(w,y)}class tL extends ez{_sort;constructor(e){super(),this.parse(e,0)}parse(e,t){if(!e||!e.length)return;let n=e.map(t=>this.normalizeTask(t,e));super.parse(n,t),this._sort&&this.sortBranch(this._sort,t)}getBranch(e){let t=this._pool.get(e);return this._pool.get(t.parent||0).data}contains(e,t){let n=this._pool.get(e).data,r=!1;if(n)for(let e=0;e<n.length;e++){if(n[e].id===t){r=!0;break}if(n[e].data&&(r=this.contains(n[e].id,t)))break}return r}getIndexById(e){return this.getBranch(e).findIndex(t=>t.id===e)}add(e,t){let n=this.normalizeTask(e);return super.add(n,t),n}copy(e,t,n){let r=this.add({...e,id:null,data:null,parent:t},n),l=[[e.id,r.id]];return e.data?.forEach((e,t)=>{let n=this.copy(e,r.id,t);l=l.concat(n)}),l}normalizeTask(e,t){let n=e.id||eF(),r=e.parent||0,l=e.text||"",a=e.type||"task",i=e.progress||0,s=e.details||"",o={...e,id:n,text:l,parent:r,progress:i,type:a,details:s};if("summary"===o.type&&!(o.start&&o.end)){let{start:e,end:n}=tH({...o},t);o.start=e,o.end=n}return o}getSummaryId(e){let t=this._pool.get(e);if(!t.parent)return null;let n=this._pool.get(t.parent);return"summary"===n.type?n.id:this.getSummaryId(n.id)}sort(e){this._sort=e,e&&this.sortBranch(e,0)}sortBranch(e,t){let n=this._pool.get(t||0).data;n&&(n.sort(function(e){if(!e||!e.length)return;let t=e.map(e=>(function({key:e,order:t}){let n="asc"===t?eV:eG;return(t,r)=>n(t[e],r[e])})(e));return 1===e.length?t[0]:function(e,n){for(let r=0;r<t.length;r++){let l=t[r](e,n);if(0!==l)return l}return 0}}(e)),n.forEach(t=>{this.sortBranch(e,t.id)}))}serialize(){let e=[],t=this._pool.get(0).data;return t&&function e(t,n){t.forEach(t=>{n.push(t),t.data&&e(t.data,n)})}(t,e),e}}let tz={year:function(e,t){let n,r,l=eK(e),a=eK(t),i=e7(l,a),s=Math.abs((n=eK(l),r=eK(a),n.getFullYear()-r.getFullYear()));l.setFullYear(1584),a.setFullYear(1584);let o=e7(l,a)===-i,c=i*(s-o);return 0===c?0:c},quarter:function(e,t,n){let r=tt(e,t)/3;return e9(n?.roundingMethod)(r)},month:tt,week:e8,day:e3,hour:function(e,t,n){let r=(eK(e)-eK(t))/36e5;return e9(n?.roundingMethod)(r)},minute:function(e,t,n){let r=(eK(e)-eK(t))/6e4;return e9(n?.roundingMethod)(r)}},tP={year:{quarter:4,month:12,week:function(e){let t=e5(e);return Math.round((e5(e6(t,60))-t)/6048e5)},day:function(e){return e?tR(e):365},hour:function(e){return 24*tR(e)}},quarter:{month:3,week:function(e){let t=tn(e);return e8(eU(e2(ta(e)),1),t)},day:tW,hour:function(e){return 24*tW(e)}},month:{week:function(e){if(e){let t=tr(e);return e8(eU(e2(te(e)),1),t)}return 5},day:function(e){return e?tD(e):30},hour:function(e){return 24*tD(e)}},week:{day:7,hour:168},day:{hour:24},hour:{minute:60}};function tW(e){if(e){let t=tn(e);return e3(ta(e),t)+1}return 91}function tO(e,t,n){let r=tP[e][t];return r?"number"==typeof r?r:r(n):1}let tY={year:function(e,t){return eQ(e,12*t)},quarter:function(e,t){return eQ(e,3*t)},month:eQ,week:e6,day:eU,hour:function(e,t){return eX(e,36e5*t)},minute:function(e,t){return eX(e,6e4*t)}};function tB(e){return(t,n,r,l)=>!tP[e][r]||"number"==typeof tP[e][r]||tU(e,t,n)?tV(e,t,n,r,l):function(e,t,n,r,l){let a=0,i=tK(n,t);if(t>i){let e=tY[n](i,1);a=tV(n,e,t,r),t=e}let s=0;return tU(n,t,e)||(s=tV(n,tK(n,e),t),t=tY[n](t,s)),(s+=a+tV(n,e,t,r))||!l||(s=tV(n,e,t,r,l)),s}(t,n,e,r,l)}function tV(e,t,n,r,l){let a=r||e,i=n,s=t;return(l&&(i=tK(a,n),(s=tK(a,t))<t&&(s=tY[a](s,1))),e===a)?tz[a](s,i):tz[a](s,i)/tO(e,a,n)}let tG={year:tl,quarter:tn,month:tr,week:e=>eZ(e,{weekStartsOn:1}),day:e2,hour:function(e){let t=eK(e);return t.setMinutes(0,0,0),t}};function tK(e,t){let n=tG[e];return n?n(t):new Date(t)}let tq={year:function(e,t){let n=eK(e),r=eK(t);return n.getFullYear()===r.getFullYear()},quarter:function(e,t){return+tn(e)==+tn(t)},month:function(e,t){let n=eK(e),r=eK(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()},week:(e,t)=>{var n;return+eZ(e,n={weekStartsOn:1})==+eZ(t,n)},day:function(e,t){return+e2(e)==+e2(t)}};function tU(e,t,n){let r=tq[e];return!!r&&r(t,n)}function tQ(e){let t=new Date;return e.map(e=>({item:e,len:tY[e.unit](t,1)})).sort((e,t)=>e.len<t.len?-1:1)[0].item}let tX=["year","quarter","month","week","day","hour"],tJ={year:"yyyy",quarter:"QQQ",month:"MMM",week:"w",day:"MMM d",hour:"HH:mm"},tZ=function(e,t,n,r,l){let a=Math.round(r/2)-3;if(!t||!n||!t.$y||!n.$y||t.$skip||n.$skip)return e.$p="",e;let i=!1,s=!1;switch(e.type){case"e2s":s=!0;break;case"s2s":i=!0,s=!0;break;case"s2e":i=!0}let o=i?t.$x:t.$x+t.$w,c=l?t.$y-7:t.$y,u=s?n.$x:n.$x+n.$w,d=l?n.$y-7:n.$y;if(o!==u||c!==d){var h,f,m,p,x,g,w,y,v,b;let t,n,k,S,C,j,M=(h=o,f=c+a,m=u,p=d+a,x=i,g=s,w=r/2,y=l,t=h+20*(x?-1:1),k=[h,f,t,f,0,0,0,0,n=m+20*(g?-1:1),p,m,p],S=n-t,C=p-f,(j=g===x)||(n<=h+20-2&&g||n>h&&!g)&&(C=y?C-w+6:C-w),j&&g&&t>n||j&&!g&&t<n?(k[4]=k[2]+S,k[5]=k[3],k[6]=k[4],k[7]=k[5]+C):(k[4]=k[2],k[5]=k[3]+C,k[6]=k[4]+S,k[7]=k[5]),k.join(",")),_=(v=u,b=d+a,s?`${v-5},${b-3},${v-5},${b+3},${v},${b}`:`${v+5},${b+3},${v+5},${b-3},${v},${b}`);e.$p=`${M},${_}`}return e},t0=["start","end","duration"],t1=[{id:"text",header:"Task name",flexgrow:1,sort:!0},{id:"start",header:"Start date",align:"center",sort:!0},{id:"duration",header:"Duration",width:100,align:"center",sort:!0},{id:"add-task",header:"Add task",width:50,align:"center",sort:!1,resize:!1}];function t2(e,t,n,r){let{selected:l,tasks:a}=e.getState(),i=l.length,s=!i&&"add-task"===t,o={parent:["indent-task:add","move-task:down","move-task:up"].includes(t),level:{"indent-task:remove":2}[t]};if(!(!(n=n||(i?l[l.length-1]:null))&&!s)){if("paste-task"!==t&&(e._temp=null),["edit-task","paste-task"].includes(t)||s||1===l.length)t4(e,t,n,r);else if(i){var c,u,d;let n,i=["copy-task","cut-task"].includes(t)?l:(c=l,u=a,d=o,n=c.map(e=>{let t=u.byId(e);return{id:e,level:t.$level,parent:t.parent,index:u.getIndexById(e)}}),(d.parent||d.level)&&(n=n.filter(e=>d.level&&e.level<=d.level||!c.includes(e.parent))),n.sort((e,t)=>e.level-t.level||e.index-t.index),n.map(e=>e.id));["copy-task","cut-task","delete-task","indent-task:remove","move-task:down"].includes(t)&&i.reverse(),i.forEach(n=>t4(e,t,n,r))}}}function t4(e,t,n,r){let l=e.exec?e.exec:e.in.exec,a=t.split(":")[0],i=t.split(":")[1],s={id:n},o={};if("copy-task"==a||"cut-task"==a){e._temp||(e._temp=[]),e._temp.push({id:n,cut:"cut-task"==a});return}if("paste-task"==a){e._temp&&e._temp.length&&(e._temp.forEach(e=>{l(e.cut?"move-task":"copy-task",{id:e.id,target:n,mode:"after"})}),e._temp=null);return}"add-task"===a?(o={task:{type:"task",text:r("New Task")},target:n},s={}):"edit-task"===a?a="show-editor":"convert-task"===a?(a="update-task",o={task:{type:i}},i=void 0):"indent-task"===a&&(i="add"===i),"u">typeof i&&(o={mode:i,...o}),l(a,s={...s,...o})}function t3(e,t){return e.some(e=>e.data?t3(e.data,t):e.id===t)}function t5(e,t,n){t7(e,t),e.base_start&&t7(e,t,!0),t6(t,n)}function t6(e,t,n,r){var l;e.unscheduled||(n&&(l=e,"duration"===r&&(l.end=null),l.start&&l.end&&(l.start>=l.end?l.end=null:l.duration=null),l.base_start&&l.base_end&&(l.base_start>=l.base_end?l.base_end=null:l.base_duration=null)),t8(e,t)),e.base_start&&t8(e,t,!0)}function t7(e,t,n=!1){t.type=t.type||e.type;let[r,l,a]=t9(n);"milestone"!==t.type?(e[l]&&t[r]||(t[r]=e[r]),t[r]&&!(t[a]||t[l])?(t[l]=e[l]>t[r]?e[l]:null,t[l]||(t[a]=1)):t[l]&&!(t[a]||t[r])?(t[r]=e[r]<t[l]?e[r]:t[l],t[r]===t[l]&&(t[a]=1,delete t[l])):t[a]&&!(t[r]||t[l])&&(t[r]=e[r])):(t[l]&&delete t[l],e[l]&&delete e[l])}function t8(e,t="day",n){let[r,l,a]=t9(n);"milestone"===e.type?e[a]=0:e[r]&&(e[a]?e[l]||(e[l]=(0,tY[t])(e[r],e[a])):e[l]?e[a]=tB(t)(e[l],e[r]):(e[l]=e[r],e[a]=0))}function t9(e){return e?["base_start","base_end","base_duration"]:["start","end","duration"]}class ne extends eO{in;_router;constructor(e){super({writable:e,async:!1}),this._router=new eY(super.setState.bind(this),[{in:["tasks","start","end","scales","autoScale"],out:["_start","_end"],exec:e=>{let{_end:t,_start:n,start:r,end:l,tasks:a,scales:i,autoScale:s}=this.getState();if(r&&l&&!s)this.setState({_start:r,_end:l},e);else{var o,c,u,d,h;let f,m,p,x,g,w=(o=r,c=l,u=s,d=tQ(i).unit,h=a,f=o,m=c,p=!1,x=!1,h&&h.forEach(e=>{(!o||u)&&(!f||e.start<=f)&&(f=e.start,p=!0);let t="milestone"===e.type?e.start:e.end;(!c||u)&&(!m||t>=m)&&(m=t,x=!0)}),g=tY[d||"day"],f?p&&(f=g(f,-1)):f=m?g(m,-30):new Date,m?x&&(m=g(m,1)):m=g(f,30),{_start:f,_end:m});(w._end!=t||w._start!=n)&&this.setState(w,e)}}},{in:["_start","_end","cellWidth","scaleHeight","scales","lengthUnit"],out:["_scales"],exec:e=>{var t,n,r,l,a,i,s;let o,c,u,d,h,f,m,p=this.getState(),{lengthUnit:x}=p,{_start:g,_end:w,cellWidth:y,scaleHeight:v,scales:b}=p,k=tQ(b).unit;k===(t=x)||tP[k]&&tP[k][t]||(x=k);let S=(n=g,r=w,l=x,a=y,i=v,u=(c=tB(o=tQ(s=b).unit))(r,n,"",!0),d=tK(o,r),n=tK(o,n),r=d<r?tY[o](d,1):d,h=i*s.length,f=s.map(e=>{let t=[],l=tY[e.unit],s=tK(e.unit,n);for(;s<r;){let i=l(s,e.step);s<n&&(s=n),i>r&&(i=r);let o=c(i,s,"",!0)*a,u="function"==typeof e.format?e.format(s,i):t$(s,e.format,{firstWeekContainsDate:4,weekStartsOn:1}),d="";e.css&&(d+="function"==typeof e.css?e.css(s):e.css),t.push({width:o,value:u,date:s,css:d,unit:e.unit}),s=i}return{cells:t,add:l,height:i}}),m=a,o!==l&&(m=Math.round(m/tO(o,l))||1),{rows:f,width:u*a,height:h,diff:c,start:n,end:r,lengthUnit:l,minUnit:o,lengthUnitWidth:m});this.setState({_scales:S},e)}},{in:["_scales","tasks","cellHeight","baselines"],out:["_tasks"],exec:e=>{let{cellWidth:t,cellHeight:n,tasks:r,_scales:l,baselines:a}=this.getState(),i=r.toArray().map((e,r)=>(tF(e,r,t,n,l,a,!1),a&&tF(e,r,t,n,l,a,!0),e));this.setState({_tasks:i},e)}},{in:["_tasks","links","cellHeight"],out:["_links"],exec:e=>{let{tasks:t,links:n,cellHeight:r,baselines:l}=this.getState(),a=n.map(e=>{let n=t.byId(e.source),a=t.byId(e.target);return tZ(e,n,a,r,l)}).filter(e=>null!==e);this.setState({_links:a},e)}},{in:["tasks","activeTask"],out:["_activeTask"],exec:e=>{let{tasks:t,activeTask:n}=this.getState();this.setState({_activeTask:t.byId(n)||null},e)}},{in:["tasks","selected"],out:["_selected"],exec:e=>{let{tasks:t,selected:n}=this.getState(),r=n.map(e=>t.byId(e)).filter(e=>!!e);this.setState({_selected:r},e)}},{in:["start","end"],out:["cellWidth"],exec:e=>{let{_cellWidth:t,cellWidth:n}=this.getState();t!=n&&this.setState({cellWidth:t},e)}},{in:["markers","_scales","cellWidth"],out:["_markers"],exec:e=>{let{markers:t,_scales:n,cellWidth:r}=this.getState(),{start:l,diff:a}=n,i=t.map(e=>(e.left=a(e.start,l)*r,e));this.setState({_markers:i},e)}}],{tasks:e=>new tL(e),links:e=>new eL(e),columns:e=>e&&e.length?e.map(e=>{var t,n;let r=e.align||"left",l="add-task"===e.id,a=!l&&e.flexgrow?e.flexgrow:null,i=a?1:e.width||(l?50:120),s=e.template;if(!s)switch(e.id){case"start":s=e=>t$(e,"dd-MM-yyyy");break;case"end":s=e=>e?t$(e,"dd-MM-yyyy"):"-"}let o=e.editor&&(t=e.id,"function"==typeof(n=e.editor)?n:t0.includes(t)?("string"==typeof n&&(n={type:n,config:{}}),n.config||(n.config={}),"datepicker"===n.type&&(n.config.buttons=["today"]),(e,t)=>!function(e,t){let{type:n,unscheduled:r}=e;return r||"summary"===n?!t0.includes(t):"milestone"!==n||!["end","duration"].includes(t)}(e,t.id)?null:n):n);return{width:i,align:r,header:e.header,id:e.id,template:s,...a&&{flexgrow:a},cell:e.cell,resize:e.resize??!0,sort:e.sort??!l,...o&&{editor:o},...e.options&&{options:e.options}}}):[]});const t=this.in=new eB;t.on("show-editor",({id:e})=>{this.setStateAsync({activeTask:e})}),t.on("select-task",({id:e,toggle:n,range:r,show:l})=>{let{selected:a,_tasks:i,activeTask:s}=this.getState(),o=!1,c;if(a.length&&(n||r)){let t=[...a];if(r){let n=t[t.length-1],r=i.findIndex(e=>e.id==n),l=i.findIndex(t=>t.id==e),a=Math.min(r,l),s=Math.max(r,l)+1,o=i.slice(a,s).map(e=>e.id);r>l&&o.reverse(),o.forEach(e=>{t.includes(e)||t.push(e)})}else if(n){let n=t.findIndex(t=>t==e);-1===n?t.push(e):(o=!0,t.splice(n,1))}c=t}else c=[e];let u={selected:c};l&&c.length&&(u._scrollTask={id:c[0],mode:l}),this.setStateAsync(u),!o&&s&&s!=e&&t.exec("show-editor",{id:e})}),t.on("delete-link",({id:e})=>{let{links:t}=this.getState();t.remove(e),this.setStateAsync({links:t})}),t.on("update-link",e=>{let{links:t}=this.getState(),{id:n,link:r}=e;t.update(n,r),this.setStateAsync({links:t}),e.link=t.byId(n)}),t.on("add-link",e=>{let{link:t}=e,{links:n}=this.getState();t.source&&t.target&&(t.type||(t.type="e2s"),t.id=t.id||eF(),n.add(t),this.setStateAsync({links:n}),e.id=t.id,e.link=n.byId(t.id))});let n=null;t.on("move-task",e=>{let{tasks:r}=this.getState(),{mode:l,target:a}=e,{id:i,inProgress:s}=e,o=r.byId(i);if(typeof s>"u"?e.source=o.parent:e.source=n=n??o.parent,!1===s){r.update(o.id,{$reorder:!1}),this.setState({tasks:r}),n=null;return}if(a===i||r.contains(i,a)){e.skipProvider=!0;return}if("up"===l||"down"===l){let n=r.getBranch(i),s=r.getIndexById(i);if("up"===l){let t=0===o.parent;if(0===s&&t){e.skipProvider=!0;return}s-=1,l="before"}else if("down"===l){let t=s===n.length-1,r=0===o.parent;if(t&&r){e.skipProvider=!0;return}s+=1,l="after"}if(a=n[s]&&n[s].id||o.parent){let e=r.getBranch(a),n=r.getIndexById(a),s=e[n];if(s.data){if("before"===l){if(s.parent===o.parent){for(;s.data;)s.open||t.exec("open-task",{id:s.id,mode:!0}),s=s.data[s.data.length-1];a=s.id}}else if("after"===l){let r;s.parent===o.parent?(r=s,a=(s=s.data[0]).id,l="before"):e.length-1!==n&&(r=s,n+=1,s=e[n],o.$level>s.$level&&s.data?(r=s,a=(s=s.data[0]).id,l="before"):a=s.id),r&&!r.open&&t.exec("open-task",{id:r.id,mode:!0})}}let c=r.getSummaryId(o.id);r.move(i,l,a);let u=r.getSummaryId(i);c!=u&&(c&&this.resetSummaryDates(c,"move-task"),u&&this.resetSummaryDates(u,"move-task"))}}else{let e=r.byId(a),n=e,s=!1;for(;n.$level>o.$level;)(n=r.byId(n.parent)).id===i&&(s=!0);if(s)return;let c=r.getSummaryId(o.id);if(r.move(i,l,a),"child"==l){let n=e;for(;0!==n.id&&!n.open;)t.exec("open-task",{id:n.id,mode:!0}),n=r.byId(n.parent)}let u=r.getSummaryId(i);c!=u&&(c&&this.resetSummaryDates(c,"move-task"),u&&this.resetSummaryDates(u,"move-task"))}s?this.setState({tasks:r}):this.setStateAsync({tasks:r}),e.target=a,e.mode=l}),t.on("drag-task",e=>{let{id:t,width:n,left:r,top:l,inProgress:a}=e,{tasks:i,_tasks:s,_selected:o,_scales:c,cellWidth:u}=this.getState(),d=i.byId(t);"u">typeof n&&(d.$w=n,tI(i,d,c,u)),"u">typeof r&&("summary"===d.type&&function e(t,n){(t.open||"summary"!=t.type)&&t.data?.forEach(t=>{t.$x+=n,e(t,n)})}(d,r-d.$x),d.$x=r,tI(i,d,c,u)),"u">typeof l&&(d.$y=l+4,d.$reorder=a),"u">typeof n&&(d.$w=n),"u">typeof r&&(d.$x=r),"u">typeof l&&(d.$y=l+4,d.$reorder=a),this.setState({_tasks:s,_selected:o})}),t.on("update-task",e=>{let{id:t,task:n,eventSource:r}=e,l=e.diff,{tasks:a,_scales:i,durationUnit:s}=this.getState(),o=a.byId(t);if("add-task"===r||"copy-task"===r||"move-task"===r||"update-task"===r||"delete-task"===r){t5(o,n,s),a.update(t,n);return}let c=i.lengthUnit,u=tY[c],d=tB(c);if(l&&(n.start&&(n.start=u(n.start,l)),n.end&&(n.end=u(n.end,l))),n.start&&n.end){if((!tA(n.start,o.start)||!tA(n.end,o.end))&&"summary"===o.type&&(!n.type||"summary"===n.type)&&o.data?.length){if(!l&&(l=d(n.start,o.start),d(n.end,o.end)!==l))return;this.moveSummaryKids(o,e=>u(e,l),"update-task")}}else if("summary"==o.type&&(n.start&&!n.end||n.end&&!n.start||n.duration))return;t5(o,n,s),a.update(t,n),"summary"===n.type&&"summary"!==o.type&&this.resetSummaryDates(t,"update-task");let h=a.getSummaryId(t);h&&this.resetSummaryDates(h,"update-task"),this.setStateAsync({tasks:a}),e.task=a.byId(t)}),t.on("add-task",e=>{let{tasks:n,_scales:r,baselines:l,unscheduledTasks:a,durationUnit:i}=this.getState(),{target:s,mode:o,task:c,show:u}=e;c.unscheduled=a;let d=-1,h,f;if(s?(f=n.byId(s),"child"==o?c.parent=(h=f).id:(null!==f.parent&&(c.parent=(h=n.byId(f.parent)).id),d=n.getIndexById(s),"after"==o&&(d+=1))):c.parent&&(h=n.byId(c.parent)),!c.start){if(h?.start)c.start=new Date(h.start.valueOf());else if(f)c.start=new Date(f.start.valueOf());else{let e,t=n.getBranch(0);if(t?.length){let n=t[t.length-1];if(!n.$skip){let t=new Date(n.start.valueOf());r.start<=t&&(e=t)}}c.start=e||tY[i](r.start,1)}c.duration=1,l&&(c.base_start=c.start,c.base_duration=c.duration)}t6(c,i);let m=n.add(c,d);if(h)for(;h&&h.id;)t.exec("open-task",{id:h.id,mode:!0}),h=n.byId(h.parent);e.id=m.id;let p=n.getSummaryId(m.id);p&&this.resetSummaryDates(p,"add-task"),this.setStateAsync({tasks:n}),t.exec("select-task",{id:m.id,show:u||!1}),e.id=m.id,e.task=m}),t.on("delete-task",e=>{let{id:t}=e,{tasks:n,links:r,selected:l}=this.getState();e.source=n.byId(t).parent;let a=n.getSummaryId(t),i=[t];n.eachChild(e=>i.push(e.id),t),r.filter(e=>!(i.includes(e.source)||i.includes(e.target)));let s={tasks:n,links:r};l.includes(t)&&(s.selected=l.filter(e=>e!==t)),n.remove(t),a&&this.resetSummaryDates(a,"delete-task"),this.setStateAsync(s)}),t.on("indent-task",({id:e,mode:n})=>{let{tasks:r}=this.getState();if(n){let n=r.getBranch(e)[r.getIndexById(e)-1];n&&t.exec("move-task",{id:e,mode:"child",target:n.id})}else{let n=r.byId(e),l=r.byId(n.parent);l&&null!==l.parent&&t.exec("move-task",{id:e,mode:"after",target:n.parent})}}),t.on("copy-task",e=>{let{id:n,target:r,mode:l,eventSource:a}=e;if("copy-task"===a)return;let{tasks:i,links:s}=this.getState();if(i.contains(n,r)){e.skipProvider=!0;return}let o=i.getSummaryId(n),c=i.getSummaryId(r),u=i.getIndexById(r);"before"==l&&(u-=1);let d=i.byId(n),h=i.copy(d,i.byId(r).parent,u+1);e.source=e.id,e.id=h[0][1],d.lazy&&(e.lazy=!0),o!=c&&c&&this.resetSummaryDates(c,"copy-task");let f=[];for(let e=1;e<h.length;e++){let[t,n]=h[e];s.forEach(e=>{if(e.source===t){let t={...e};delete t.target,f.push({...t,source:n})}else if(e.target===t){let t={...e};delete t.source,f.push({...t,target:n})}})}f=f.reduce((e,t)=>{let n=e.findIndex(e=>e.id===t.id);return n>-1?e[n]={...e[n],...t}:e.push(t),e},[]);for(let e=1;e<h.length;e++){let[n,r]=h[e],l=i.byId(r);t.exec("copy-task",{source:n,id:r,lazy:!!l.lazy,eventSource:"copy-task",target:l.parent,mode:"child"})}f.forEach(e=>{t.exec("add-link",{link:{source:e.source,target:e.target,type:e.type}})}),this.setStateAsync({tasks:i})}),t.on("open-task",({id:e,mode:n})=>{let{tasks:r}=this.getState(),l=r.byId(e);l.lazy?t.exec("request-data",{id:l.id}):(r.toArray().forEach(e=>e.$y=0),r.update(e,{open:n}),this.setState({tasks:r}))}),t.on("scroll-chart",({left:e,top:t})=>{if(!isNaN(e)){let t=this.calcScaleDate(e);this.setState({scrollLeft:e,_scaleDate:t})}isNaN(t)||this.setState({scrollTop:t})}),t.on("render-data",e=>{this.setState({area:e})}),t.on("provide-data",e=>{let{tasks:t,links:n}=this.getState(),r=t.byId(e.id);r.lazy?(r.lazy=!1,r.open=!0):r.data=[],t.parse(e.data.tasks,e.id),this.setStateAsync({tasks:t,links:new eL(n.map(e=>e).concat(e.data.links))})}),t.on("zoom-scale",({dir:e,offset:t})=>{let{zoom:n,cellWidth:r,_cellWidth:l,scrollLeft:a}=this.getState(),i=t+a,s=this.calcScaleDate(i),o=r;e<0&&(o=l||r);let c=o+50*e,u=n.levels[n.level],d=e<0&&r>u.maxCellWidth;if(c<u.minCellWidth||c>u.maxCellWidth||d){if(!this.changeScale(n,e))return}else this.setState({cellWidth:c,_cellWidth:c});let{_scales:h,_start:f,cellWidth:m}=this.getState(),p=tK(h.minUnit,f),x=h.diff(s,p,"hour");typeof t>"u"&&(t=m);let g=Math.round(x*m)-t;g<0&&(g=0),this.setState({scrollLeft:g,_scaleDate:s,_zoomOffset:t})}),t.on("expand-scale",({minWidth:e})=>{let{_start:t,_scales:n,start:r,end:l,_end:a,cellWidth:i,_scaleDate:s,_zoomOffset:o}=this.getState(),c=tY[n.minUnit],u=n.width;if(r&&l){if(u<e&&u){let t=e/u;this.setState({cellWidth:i*t})}return!0}let d=0;for(;u<e;)u+=i,d++;let h=d?l?-d:-1:0,f=r||c(t,h),m=0;s&&(m=Math.max(0,Math.round(n.diff(s,f,"hour")*i)-(o||0))),this.setState({_start:f,_end:l||c(a,d),scrollLeft:m})}),t.on("sort-tasks",({key:e,order:t,add:n})=>{let r=this.getState(),{tasks:l}=r,a=r._sort,i={key:e,order:t},s=a?.length||0;s&&n?(a.forEach((t,n)=>{t.key===e&&(s=n)}),a[s]=i):a=[i],l.sort(a),this.setState({_sort:a,tasks:l})}),t.on("hotkey",({key:e,event:t,eventSource:n})=>{switch(e){case"arrowup":case"arrowdown":{let r,{selected:l,_tasks:a}=this.getState();t.preventDefault();let i=l.length;(r="arrowup"===e?i?this.getPrevRow(l[i-1])?.id:a[a.length-1]?.id:i?this.getNextRow(l[i-1])?.id:a[0]?.id)&&this.in.exec("select-task",{id:r,show:"chart"!==n||"xy"});break}case"ctrl+c":t2(this,"copy-task",null,null);break;case"ctrl+x":t2(this,"cut-task",null,null);break;case"ctrl+v":t2(this,"paste-task",null,null);break;case"ctrl+d":case"backspace":t.preventDefault(),t2(this,"delete-task",null,null)}})}init(e){let t=this.getState().area?{}:{scrollLeft:0,scrollTop:0,area:{from:0,start:0,end:0}};if(e.cellWidth&&(e._cellWidth=e.cellWidth),e._sort=null,Array.isArray(e.tasks)&&e.tasks.forEach(t=>t6(t,e.durationUnit)),this._router.init({_scrollTask:null,selected:[],markers:[],autoScale:!0,durationUnit:"day",...t,...e}),e.zoom){let t=function(e,t,n){let r="boolean"==typeof e?{}:e,l=tX.indexOf(tQ(t).unit);if(typeof r.level>"u"&&(r.level=l),r.levels)r.levels.forEach(e=>{e.minCellWidth||(e.minCellWidth=r.minCellWidth??50),e.maxCellWidth||(e.maxCellWidth=r.maxCellWidth??300)});else{let e=[],n=t.length||1,a=r.minCellWidth??50,i=r.maxCellWidth??300;t.forEach(e=>{e.format&&!tJ[e.unit]&&(tJ[e.unit]=e.format)}),tX.forEach((r,s)=>{if(s===l)e.push({minCellWidth:a,maxCellWidth:i,scales:t});else{let t=[];if(s)for(let e=n-1;e>0;e--){let n=tX[s-e];n&&t.push({unit:n,step:1,format:tJ[n]})}t.push({unit:r,step:1,format:tJ[r]}),e.push({minCellWidth:a,maxCellWidth:i,scales:t})}}),r.levels=e}r.levels[r.level]||(r.level=0);let a=r.levels[r.level],i=Math.min(Math.max(n,a.minCellWidth),a.maxCellWidth);return{_zoom:r,scales:a.scales,cellWidth:i}}(e.zoom,e.scales,e.cellWidth);this.setState({zoom:t._zoom,cellWidth:t.cellWidth,_cellWidth:t.cellWidth,scales:t.scales})}}setState(e,t){return this._router.setState(e,t)}setStateAsync(e){this._router.setStateAsync(e)}getTask(e){let{tasks:t}=this.getState();return t.byId(e)}serialize(){let{tasks:e}=this.getState();return e.serialize()}changeScale(e,t){let n=e.level+t,r=e.levels[n];if(r){var l,a,i;let s,o,c,u,d,h,f,{cellWidth:m,scales:p,_scales:x}=this.getState(),g=(l=x.lengthUnit,e.level=n,a=d=tQ(u=r.scales||r).unit,i=l,s=tX.indexOf(a),h=(o=tX.indexOf(i))>=s?"hour"===a?"hour":"day":tX[o],c=-1===t?m*tO(d,l):Math.round(m/tO(tQ(p).unit,d)),f=r.minCellWidth??50,{scales:u,cellWidth:Math.min(r.maxCellWidth??300,Math.max(f,c)),lengthUnit:h,zoom:e});return g._cellWidth=g.cellWidth,this.setState(g),!0}return!1}isScheduled(e){return!this.getState().unscheduledTasks||e.some(e=>!e.unscheduled||e.data&&this.isScheduled(e.data))}resetSummaryDates(e,t){let{tasks:n}=this.getState(),r=n.byId(e),l=r.data;if(l?.length&&this.isScheduled(l)){let l=tH({...r,start:void 0,end:void 0,duration:void 0});if(!tA(r.start,l.start)||!tA(r.end,l.end)){this.in.exec("update-task",{id:e,task:l,eventSource:t});let r=n.getSummaryId(e);r&&this.resetSummaryDates(r,t)}}}moveSummaryKids(e,t,n){let{tasks:r}=this.getState();e.data.forEach(e=>{let l={...r.byId(e.id),start:t(e.start)};"milestone"!==l.type&&(l.end=t(e.end)),delete l.id,this.in.exec("update-task",{id:e.id,task:l,eventSource:n}),e.data?.length&&this.moveSummaryKids(e,t,n)})}calcScaleDate(e){let{_scales:t,_start:n}=this.getState(),r="day"===t.lengthUnit?t.lengthUnitWidth/24:t.lengthUnitWidth;return tY.hour(tK(t.minUnit,n),Math.floor(e/r))}getNextRow(e){let t=this.getState()._tasks,n=t.findIndex(t=>t.id==e);return t[n+1]}getPrevRow(e){let t=this.getState()._tasks,n=t.findIndex(t=>t.id==e);return t[n-1]}}function nt(e){return e.map(e=>{switch(e.data&&nt(e.data),e.id){case"add-task:before":case"move-task:up":e.check=(e,t)=>{var n,r;return n=e,r=t,r[0]?.id!==n.id};break;case"move-task:down":e.check=(e,t)=>{var n,r;return n=e,r=t,r[r.length-1]?.id!==n.id};break;case"indent-task:add":e.check=(e,t)=>{var n,r;let l;return n=e,l=(r=t).findIndex(e=>e.id===n.id),(r[l-1]?.id??n.parent)!==e.parent};break;case"indent-task:remove":e.check=e=>0!==e.parent}return e})}let nn=nt([{id:"add-task",text:"Add",icon:"wxi-plus",data:[{id:"add-task:child",text:"Child task"},{id:"add-task:before",text:"Task above"},{id:"add-task:after",text:"Task below"}]},{type:"separator"},{id:"convert-task",text:"Convert to",icon:"wxi-swap-horizontal",dataFactory:e=>{let t;return{id:`convert-task:${e.id}`,text:`${e.label}`,check:(t=e.id,e=>e.type!==t)}}},{id:"edit-task",text:"Edit",icon:"wxi-edit",subtext:"Ctrl+E"},{id:"cut-task",text:"Cut",icon:"wxi-content-cut",subtext:"Ctrl+X"},{id:"copy-task",text:"Copy",icon:"wxi-content-copy",subtext:"Ctrl+C"},{id:"paste-task",text:"Paste",icon:"wxi-content-paste",subtext:"Ctrl+V"},{id:"move-task",text:"Move",icon:"wxi-swap-vertical",data:[{id:"move-task:up",text:"Up"},{id:"move-task:down",text:"Down"}]},{type:"separator"},{id:"indent-task:add",text:"Indent",icon:"wxi-indent"},{id:"indent-task:remove",text:"Outdent",icon:"wxi-unindent"},{type:"separator"},{id:"delete-task",icon:"wxi-delete",text:"Delete",subtext:"Ctrl+D / BS"}]),nr=nt([{id:"add-task",comp:"button",icon:"wxi-plus",text:"New task",type:"primary"},{id:"edit-task",comp:"icon",icon:"wxi-edit",menuText:"Edit",text:"Ctrl+E"},{id:"delete-task",comp:"icon",icon:"wxi-delete",menuText:"Delete",text:"Ctrl+D, Backspace"},{comp:"separator"},{id:"move-task:up",comp:"icon",icon:"wxi-angle-up",menuText:"Move up"},{id:"move-task:down",comp:"icon",icon:"wxi-angle-down",menuText:"Move down"},{comp:"separator"},{id:"copy-task",comp:"icon",icon:"wxi-content-copy",menuText:"Copy",text:"Ctrl+V"},{id:"cut-task",comp:"icon",icon:"wxi-content-cut",menuText:"Cut",text:"Ctrl+X"},{id:"paste-task",comp:"icon",icon:"wxi-content-paste",menuText:"Paste",text:"Ctrl+V"},{comp:"separator"},{id:"indent-task:add",comp:"icon",icon:"wxi-indent",menuText:"Indent"},{id:"indent-task:remove",comp:"icon",icon:"wxi-unindent",menuText:"Outdent"}]),nl=[{key:"text",comp:"text",label:"Name",config:{placeholder:"Add task name"}},{key:"details",comp:"textarea",label:"Description",config:{placeholder:"Add description"}},{key:"type",comp:"select",label:"Type"},{key:"start",comp:"date",label:"Start date"},{key:"end",comp:"date",label:"End date"},{key:"duration",comp:"counter",label:"Duration",config:{min:1}},{key:"unscheduled",comp:"twostate",label:"",config:{value:!0,text:"Unschedule",textActive:"Schedule"}},{key:"progress",comp:"slider",label:"Progress",config:{min:1,max:100}},{key:"links",comp:"links",label:""}],na=[{id:"task",label:"Task"},{id:"summary",label:"Summary task"},{id:"milestone",label:"Milestone"}];function ni(e,t){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||null===e)return e===t;if(typeof e!=typeof t||(null===e||null===t)&&e!==t||e instanceof Date&&t instanceof Date&&e.getTime()!==t.getTime())return!1;if("object"==typeof e)if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=e.length-1;n>=0;n--)if(!ni(e[n],t[n]))return!1;return!0}else{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in t)if(!ni(e[n],t[n]))return!1;return!0}return e===t}new Date().valueOf();var ns=class{constructor(e){e&&(this._writable=e.writable,this._async=e.async),this._values={},this._state={}}setState(e,t=0){let n={};return this._wrapProperties(e,this._state,this._values,"",n,t),n}getState(){return this._values}getReactive(){return this._state}_wrapProperties(e,t,n,r,l,a){for(let i in e){let s=t[i],o=n[i],c=e[i];if(s&&(o===c&&"object"!=typeof c||c instanceof Date&&o instanceof Date&&o.getTime()===c.getTime()))continue;let u=r+(r?".":"")+i;s?(s.__parse(c,u,l,a)&&(n[i]=c),2&a?l[u]=s.__trigger:s.__trigger()):(c&&c.__reactive?t[i]=this._wrapNested(c,c,u,l):t[i]=this._wrapWritable(c),n[i]=c),l[u]=l[u]||null}}_wrapNested(e,t,n,r){let l=this._wrapWritable(e);return this._wrapProperties(e,l,t,n,r,0),l.__parse=(e,n,r,a)=>(this._wrapProperties(e,l,t,n,r,a),!1),l}_wrapWritable(e){let t=[],n=function(){for(let n=0;n<t.length;n++)t[n](e)};return{subscribe:n=>(t.push(n),this._async?setTimeout(n,1,e):n(e),()=>{let e=t.indexOf(n);e>=0&&t.splice(e,1)}),__trigger:()=>{t.length&&(this._async?setTimeout(n,1):n())},__parse:function(t){return e=t,!0}}}},no=class{constructor(e,t,n,r){"function"==typeof e?this._setter=e:this._setter=e.setState.bind(e),this._routes=t,this._parsers=n,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(e=>{e.in.forEach(t=>{let n=this._triggers.get(t)||[];n.push(e),this._triggers.set(t,n)}),e.out.forEach(t=>{let n=this._sources.get(t)||{};e.in.forEach(e=>n[e]=!0),this._sources.set(t,n)})}),this._routes.forEach(e=>{e.length=Math.max(...e.in.map(e=>(function e(t,n,r){let l=n.get(t);return l?Math.max(...Object.keys(l).map(t=>e(t,n,r+1))):r})(e,this._sources,1)))}),this._bus=r}init(e){let t={};for(let n in e)if(this._prev[n]!==e[n]){let r=this._parsers[n];t[n]=r?r(e[n]):e[n]}this._prev=this._prev?{...this._prev,...e}:{...e},this.setState(t),this._bus&&this._bus.exec("init-state",t)}setStateAsync(e){let t=this._setter(e,2);return this._async?Object.assign(this._async.signals,t):this._async={signals:t,timer:setTimeout(this._applyState.bind(this),1)},t}_applyState(){let e=this._async;if(e)for(let t in this._async=null,this._triggerUpdates(e.signals,[]),e.signals){let n=e.signals[t];n&&n()}}setState(e,t=[]){let n=this._setter(e);return this._triggerUpdates(n,t),n}_triggerUpdates(e,t){let n=Object.keys(e),r=!t.length;t=t||[];for(let e=0;e<n.length;e++){let r=n[e],l=this._triggers.get(r);l&&l.forEach(e=>{-1==t.indexOf(e)&&t.push(e)})}r&&this._execNext(t)}_execNext(e){for(;e.length;){e.sort((e,t)=>e.length<t.length?1:-1);let t=e[e.length-1];e.splice(e.length-1),t.exec(e)}}},nc=class{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(e,t,n){let r=this._handlers[e];r?n&&n.intercept?r.unshift(t):r.push(t):r=this._handlers[e]=[t],n&&n.tag&&this._tag.set(t,n.tag)}intercept(e,t,n){this.on(e,t,{...n,intercept:!0})}detach(e){for(let t in this._handlers){let n=this._handlers[t];for(let t=n.length-1;t>=0;t--)this._tag.get(n[t])===e&&n.splice(t,1)}}async exec(e,t){let n=this._handlers[e];if(n)for(let e=0;e<n.length;e++){let r=n[e](t);if(!1===r||r&&r.then&&await r===!1)return}return this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}};function nu(e,t){var n;return(t.getter||(n=t.id,e=>e[n]))(e)}function nd(e,t,n){var r;return(t.setter||(r=t.id,(e,t)=>e[r]=t))(e,n)}function nh(e,t){let n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}function nf(e,t){let n=nu(e,t)??"";return t.template&&(n=t.template(n,e,t)),t.optionsMap&&(n=Array.isArray(n)?n.map(e=>t.optionsMap.get(e)):t.optionsMap.get(n)),typeof n>"u"?"":n+""}function nm(e,t,n,r,l){let a=/\n|"|;|,/;for(let i=0;i<t[0][e].length;i++){let s=[];for(let n=0;n<t.length;n++){let r=(t[n][e][i].text||"")+"";a.test(r)&&(r='"'+r.replace(/"/g,'""')+'"'),s.push(r)}n+=(n?l:"")+s.join(r)}return n}function np(e,t,n,r,l,a,i){for(let s=0;s<t[0][e].length;s++){let o=[];for(let n=0;n<t.length;n++){let c=t[n][e][s],u=c.colspan?c.colspan-1:0,d=c.rowspan?c.rowspan-1:0;(u||d)&&r.push({from:{row:s+l,column:n},to:{row:s+l+d,column:n+u}});let h=c.text??"",f;a.headerCellStyle&&(f=a.headerCellStyle(h,c,t[n],e)),a.headerCellTemplate&&(h=a.headerCellTemplate(h,c,t[n],e)??h);let m=nx(h,"header"==e?+(s==t[0][e].length-1):s?4:3,f,i);o.push(m)}n.push(o)}}function nx(e,t,n,r){var l;let a=t;if(e&&e instanceof Date&&(e=(l=e)?25569+(l.getTime()-6e4*l.getTimezoneOffset())/864e5:null,(n=n||{}).format=n.format||"dd/mm/yyyy"),n){n={...r[t],...n};let e=r.findIndex(e=>ni(e,n));e<0?(r.push(n),a=r.length-1):a=e}return{v:e+"",s:a}}let ng={a3:{width:11.7,height:16.5},a4:{width:8.27,height:11.7},letter:{width:8.5,height:11}};function nw(e,t,n){let r=[];return e.forEach((l,a)=>{let i=l[t];for(let l=0;l<n.length;l++){r[l]||(r[l]=[]);let s={...i[l]};if(null!==r[l][a]){if(!a&&!s.rowspan&&!s.colspan){let r=1,i=e[a+1][t][l],o=s.width;for(;!i.rowspan&&!i.colspan;)o+=(i=e[a+ ++r][t][l]).width;s.colspan=r,s.width=o,s.height=n[l]}if(r[l].push(s),!s.collapsed&&s.colspan>1){let t=s.colspan-1;if(s.colspan+a>e.length){let n=s.colspan-(s.colspan+a-e.length);s.colspan=n,s.width=e.slice(a,a+t+1).reduce((e,t)=>e+t.width,0),n>1&&(t=n-1)}for(let e=0;e<t;e++)r[l].push(null)}if(s.rowspan>1){let e=s.rowspan;for(let t=1;t<e;t++)r[l+t]||(r[l+t]=[]),r[l+t].push(null)}}}if(l.collapsed)for(let e=0;e<r.length;e++){let t=r[e],n=t[a];if(n&&n.collapsed){if(t[a]=null,!e)break}else{let e=n||t.findLast(e=>e?.colspan>=1);e&&(e.colspan=e.colspan-1,e.width=e.width-l.width)}}}),r.map(e=>e.filter(e=>e&&0!==e.colspan))}function ny(e,t){return e.flexgrow?`min-width:${t}px;width:auto`:`width:${e.width}px; max-width:${e.width}px; height:${e.height}px`}let nv=["resize-column","hide-column","update-cell"],nb=["delete-row","update-row","update-cell"],nk=["move-item"],nS=["resize-column","move-item"];class nC{undo=[];redo=[];progress={};in;getState;setState;_previousValues={};constructor(e,t,n){this.in=e,this.getState=t,this.setState=n,this.setHandlers(),this.resetStateHistory()}getHandlers(){return{"add-row":{handler:e=>({action:"delete-row",data:{id:e.id},source:{action:"add-row",data:e}})},"delete-row":{handler:e=>{let{id:t}=e,{data:n}=this.getPrev(),r=n.findIndex(e=>e.id==t);return{action:"add-row",data:{id:t,row:n[r],before:r<n.length-1?n[r+1].id:void 0},source:{action:"delete-row",data:e}}}},"update-cell":{handler:e=>{let{id:t,column:n}=e,r=nu(this.getRow(t),this.getColumn(n));return ni(r,e.value)?null:{action:"update-cell",data:{id:t,column:n,value:r},source:{action:"update-cell",data:e}}}},"update-row":{handler:e=>{let{id:t}=e,n=this.getRow(t);return{action:"update-row",data:{id:t,row:n},source:{action:"update-row",data:e}}}},"resize-column":{handler:e=>{let{id:t,width:n}=e,r=this.getColumn(t),{_sizes:l}=this.getState();return{action:"resize-column",data:{id:t,width:r.width??l.columnWidth},source:{action:"resize-column",data:{id:t,width:n}}}}},"hide-column":{handler:e=>{let{id:t}=e,n=this.getColumn(t);return{action:"hide-column",data:{id:t,mode:n.hidden},source:{action:"hide-column",data:e}}}},"collapse-column":{handler:e=>{let{id:t,row:n,mode:r}=e;return{action:"collapse-column",data:{id:t,row:n,mode:"boolean"==typeof r?!r:r},source:{action:"collapse-column",data:e}}}},"move-item":{handler:e=>{let{id:t,target:n,mode:r}=e,{flatData:l}=this.getPrev(),a=l.findIndex(e=>e.id==t);return{action:"move-item",data:{id:t,target:l[a+(a?-1:1)].id,mode:a?"after":"before"},source:{action:"move-item",data:{id:t,target:n,mode:r}}}}},"open-row":{handler:e=>{let{id:t,nested:n}=e;return{action:"close-row",data:{id:t,nested:n},source:{action:"open-row",data:e}}}},"close-row":{handler:e=>{let{id:t,nested:n}=e;return{action:"open-row",data:{id:t,nested:n},source:{action:"close-row",data:e}}}}}}resetHistory(){this.undo=[],this.redo=[],this.progress={},this.resetStateHistory()}getPrev(){return this._previousValues}setHandlers(){let e=this.getHandlers();for(let t in e)this.in.intercept(t,e=>{if(!("undo"===e.eventSource||"redo"===e.eventSource||e.skipUndo)){if(nS.includes(t)){(e.inProgress&&!this.progress[t]||"boolean"!=typeof e.inProgress)&&(nk.includes(t)&&this.setPrev("flatData"),nv.includes(t)&&this.setPrev("columns")),this.progress[t]=e.inProgress;return}nb.includes(t)&&this.setPrev("data"),nv.includes(t)&&this.setPrev("columns")}}),this.in.on(t,n=>{if("undo"===n.eventSource||"redo"===n.eventSource||n.skipUndo||n.inProgress)return;let r=e[t].handler(n);r&&this.addToHistory(r)})}setPrev(e){this._previousValues[e]=function e(t){if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t);if(t instanceof Array)return t.map(e);let n={};for(let r in t)n[r]=e(t[r]);return n}(this.getState()[e])}addToHistory(e){this.undo.push(e),this.redo=[],this.setStateHistory()}handleUndo(){if(!this.undo.length)return;let e=this.undo.pop();this.redo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"undo"}),this.setStateHistory()}handleRedo(){if(!this.redo.length)return;let e=this.redo.pop();this.undo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"redo"}),this.setStateHistory()}resetStateHistory(){this.setState({history:{undo:0,redo:0}})}setStateHistory(){this.setState({history:{undo:this.undo.length,redo:this.redo.length}})}getRow(e){let{data:t}=this.getPrev();return this.getState().tree?this.getTreeRow(t,e):t.find(t=>t.id==e)}getTreeRow(e,t){for(let n=0;n<e.length;n++){if(e[n].id==t)return e[n];if(e[n].data){let r=this.getTreeRow(e[n].data,t);if(r)return r}}return null}getColumn(e){let{columns:t}=this.getPrev();return t.find(t=>t.id==e)}}function nj(e,t){return typeof e>"u"||null===e?-1:typeof t>"u"||null===t?1:e===t?0:e>t?1:-1}function nM(e,t){return-nj(e,t)}function n_(e,t,n,r,l){let a,i,s=document.createElement("div"),o=document.createElement("div"),c=document.body;l=l?`${l}px`:"auto",o.className=t,s.classList.add(`wx-${n}-theme`),s.style.cssText=`height:auto;position:absolute;top:0px;left:100px;overflow:hidden;width=${l};white-space:nowrap;`,s.appendChild(o),c.appendChild(s),"object"!=typeof e&&(e=[e]);for(let t=0;t<e.length;t++){o.innerText=e[t]+"";let n=s.getBoundingClientRect(),l=Math.ceil(n.width)+(r&&r.length?r[t]:0),c=Math.ceil(n.height);a=Math.max(a||0,l),i=Math.max(i||0,c)}return s.remove(),{width:a,height:i}}function nN(e,t,n,r,l){let a=[];for(let i=0;i<e.length;i++){let s=e[i][t],o=s.length;for(let e=0;e<o;e++){let{text:i,vertical:o,collapsed:c,rowspan:u,css:d}=s[e];if(!i){a[e]=Math.max(a[e]||0,r);continue}let h=0;if(o&&!c){let o=`wx-measure-cell-${t}`;if(o+=d?` ${d}`:"",h=n_(i,o,l).width,(u>1||!s[e+1])&&n>e+1){let t=u||n-e,l=a.slice(e,e+t).reduce((e,t)=>e+t,0);if(l<h){let n=Math.ceil((h-l)/t);for(let l=e;l<e+t;l++)a[l]=(a[l]||r)+n}continue}}a[e]=Math.max(a[e]||r,h)}}return a}let nE={text:(e,t)=>e?-1!==e.toLowerCase().indexOf(t.toLowerCase()):!t,richselect:(e,t)=>"number"!=typeof t&&!t||e==t};class nT extends ns{in;_router;_branches;_xlsxWorker;_historyManager;constructor(e){super({writable:e,async:!1});const t={rowHeight:37,columnWidth:160,headerHeight:36,footerHeight:36};this._router=new no(super.setState.bind(this),[{in:["columns","sizes","_skin"],out:["_columns","_sizes"],exec:e=>{let{columns:t,sizes:n,_skin:r}=this.getState(),l=this.copyColumns(t),a=l.reduce((e,t)=>Math.max(t.header.length,e),0),i=l.reduce((e,t)=>Math.max(t.footer.length,e),0);l.forEach(this.setCollapsibleColumns);let s=this.normalizeSizes(l,n,a,i,r);l.forEach((e,t)=>{this.normalizeColumns(l,t,"header",a,s),this.normalizeColumns(l,t,"footer",i,s)}),this.setState({_columns:l,_sizes:s},e)}},{in:["data","tree","_filterIds"],out:["flatData"],exec:e=>{let{data:t,tree:n,_filterIds:r}=this.getState(),l=n?this.flattenRows(t,[],r):t.filter(e=>!r||r.includes(e.id));this.setState({flatData:l},e)}}],{sizes:e=>({...t,...e})});const n=this.in=new nc;n.on("close-editor",({ignore:e})=>{let{editor:t}=this.getState();t&&(e||n.exec("update-cell",t),this.setState({editor:null}))}),n.on("open-editor",({id:e,column:t})=>{let r=this.getState().editor;r&&n.exec("close-editor",{});let l=this.getRow(e),a=t?this.getColumn(t):this.getNextEditor(l);if(a?.editor){let t=a.editor;if("function"==typeof t&&(t=t(l,a)),!t)return;r={column:a.id,id:e,value:nu(l,a)??"",renderedValue:nf(l,a)},"object"==typeof t&&t.config&&(r.config=t.config,t.config.options&&(r.options=t.config.options)),a.options&&!r.options&&(r.options=a.options),this.setState({editor:r})}}),n.on("editor",({value:e})=>{let t=this.getState().editor;t&&(t.value=e,this.setState({editor:t}))}),n.on("add-row",e=>{let t=this.getState(),{data:r}=t,{select:l,_filterIds:a}=t,{row:i,before:s,after:o,select:c}=e;if(e.id=i.id=e.id||i.id||nD(),s||o){let t=s||o,n=r.findIndex(e=>e.id===t);r.splice(n+ +!!o,0,e.row),r=[...r]}else r=[...r,e.row];let u={data:r};a&&(u._filterIds=[...a,e.id]),this.setState(u),!("boolean"==typeof c&&!c)&&(c||l)&&n.exec("select-row",{id:i.id,show:!0})}),n.on("delete-row",e=>{let{data:t,selectedRows:n,focusCell:r}=this.getState(),{id:l}=e,a={data:t.filter(e=>e.id!==l)};this.isSelected(l)&&(a.selectedRows=n.filter(e=>e!==l)),this.setState(a),r?.row===l&&this.in.exec("focus-cell",{eventSource:"delete-row"})}),n.on("update-cell",e=>{let t=this.getState(),{data:n}=t;n=[...n];let{tree:r}=t,{id:l,column:a,value:i}=e,s=this.getColumn(a);if(r){let e={...this._branches[l]};nd(e,s,i);let t=this.updateTreeRow(e);0===e.$parent&&(n=t)}else{let e=n.findIndex(e=>e.id==l),t={...n[e]};nd(t,s,i),n[e]=t}this.setState({data:n})}),n.on("update-row",e=>{let{data:t}=this.getState(),{id:n,row:r}=e,l=t.findIndex(e=>e.id==n);(t=[...t])[l]={...t[l],...r},this.setState({data:t})}),n.on("select-row",({id:e,toggle:t,range:n,mode:r,show:l,column:a})=>{let i=this.getState(),{focusCell:s}=i,{selectedRows:o}=i;if(o.length||(n=t=!1),n){let{data:t}=this.getState(),n=t.findIndex(e=>e.id==o[o.length-1]),r=t.findIndex(t=>t.id==e);n>r&&([n,r]=[r,n]),t.slice(n,r+1).forEach(e=>{-1===o.indexOf(e.id)&&o.push(e.id)})}else if(t&&this.isSelected(e)){if(!0===r)return;o=o.filter(t=>t!==e)}else if(t){if(!1===r)return;o.push(e)}else o=[e];this.setState({selectedRows:o}),s?.row!==e&&this.in.exec("focus-cell",{eventSource:"select-row"}),l&&this.in.exec("scroll",{row:e,column:a})}),this.in.on("focus-cell",e=>{let{row:t,column:n,eventSource:r}=e,{_columns:l,split:a}=this.getState();t&&n?(this.setState({focusCell:{row:t,column:n}}),"click"!==r&&((!a.left||l.findIndex(t=>t.id==e.column)>=a.left)&&(!a.right||l.findIndex(t=>t.id==e.column)<l.length-a.right)?this.in.exec("scroll",{row:t,column:n}):this.in.exec("scroll",{row:t}))):this.setState({focusCell:null})}),n.on("resize-column",e=>{let{id:t,auto:n,maxRows:r,inProgress:l}=e;if(!1===l)return;let a=e.width||0,i=[...this.getState().columns],s=i.find(e=>e.id==t);if(n){if("data"==n||!0===n){let{flatData:e,_skin:t}=this.getState(),n=e.length;r&&(n=Math.min(r,n)),a=function(e,t,n){let r=[],l=[],a="wx-measure-cell-body";a+=e.css?` ${e.css}`:"";for(let n=0;n<t.length;n++){let a=nf(t[n],e);a&&(r.push(a),e.treetoggle?l.push(28*t[n].$level+28*!!t[n].$count+28*!!e.draggable):e.draggable&&l.push(28))}return n_(r,a,n,l).width}(s,e.slice(0,n),t)}if("header"==n||!0===n){let{_skin:e}=this.getState();a=Math.max(function(e,t){let n,r="wx-measure-cell-header",l=20*!!e.sort,a=e.header;if("string"==typeof a)return n_(a,r,t).width+l;Array.isArray(a)||(a=[a]);for(let e=0;e<a.length;e++){let i=a[e],s=n_("string"==typeof i?i:i.text,r+("string"==typeof i?"":` ${i.css}`),t).width;e===a.length-1&&(s+=l),n=Math.max(n||0,s)}return n}(s,e),a)}}s.width=Math.max(17,a),delete s.flexgrow,this.setState({columns:i})}),n.on("hide-column",e=>{let{id:t,mode:n}=e,r=[...this.getState().columns],l=r.find(e=>e.id==t),a=r.reduce((e,t)=>e+ +!t.hidden,0);!n||a>1?(l.hidden=!l.hidden,this.setState({columns:r})):e.skipUndo=!0}),n.on("sort-rows",e=>{let{key:t,add:n}=e,{order:r="asc"}=e,l=this.getState(),a=l.sortMarks,{columns:i,data:s,tree:o}=l,c=Object.keys(a),u=c.length;a[t]&&(r="asc"===a[t].order?"desc":"asc"),n&&u&&(1!==u||!a[t])?(1===u&&(a[c[0]]={...a[c[0]],index:0}),a={...a,[t]:{order:r,index:a[t]?.index??u}}):a={[t]:{order:r}};let d=Object.keys(a).sort((e,t)=>a[e].index-a[t].index).map(e=>({key:e,order:a[e].order}));this.setState({sortMarks:a});let h=function(e,t){if(!e||!e.length)return;let n=e.map(e=>{var n,r;let l;return n=e.order,r=t.find(t=>t.id==e.key),l="asc"===n?nj:nM,function(e,t){return l(nu(e,r),nu(t,r))}});return 1===e.length?n[0]:function(e,t){for(let r=0;r<n.length;r++){let l=n[r](e,t);if(0!==l)return l}return 0}}(d,i);if(h){let e=[...s];o?this.sortTree(e,h):e.sort(h),this.setState({data:e})}}),n.on("filter-rows",e=>{let{value:t,key:n,filter:r}=e;if(!Object.keys(e).length)return void this.setState({filterValues:{},_filterIds:null});let l=this.getState(),{data:a,tree:i}=l,s=l.filterValues,o={};n&&(o.filterValues=s={...s,[n]:t});let c=r??this.createFilter(s),u=[];i?u=this.filterTree(a,c,u):a.forEach(e=>{c(e)&&u.push(e.id)}),o._filterIds=u,this.setState(o)}),n.on("collapse-column",e=>{let{id:t,row:n,mode:r}=e,l=[...this.getState().columns],a=this.getColumn(t).header,i=Array.isArray(a)?a[n]:a;"object"==typeof i&&(i.collapsed=r??!i.collapsed,this.setState({columns:l}))}),n.on("move-item",e=>{let t,{id:n,target:r,mode:l="after",inProgress:a}=e,{data:i,flatData:s,tree:o}=this.getState(),c=s.findIndex(e=>e.id==n),u=s.findIndex(e=>e.id==r);-1!==c&&-1!==u&&!1!==a&&(t=this.moveItem(n,r,i,l),this.setState({data:o?this.normalizeTreeRows(t):t}))}),n.on("open-row",e=>{let{id:t,nested:n}=e;this.toggleBranch(t,!0,n)}),n.on("close-row",e=>{let{id:t,nested:n}=e;this.toggleBranch(t,!1,n)}),n.on("export",e=>new Promise((t,n)=>{let r=e.options||{},l=`${r.fileName||"data"}.${r.format}`;if("csv"==r.format){let n=function(e,t){let n=/\n|"|;|,/,r="",l=t.rows||`
`,a=t.cols||"	",i=e._columns,s=e.flatData;!1!==t.header&&i[0].header&&(r=nm("header",i,r,a,l));for(let e=0;e<s.length;e++){let t=[];for(let r=0;r<i.length;r++){let l=nf(s[e],i[r]);n.test(l)&&(l='"'+l.replace(/"/g,'""')+'"'),t.push(l)}r+=(r?l:"")+t.join(a)}return!1!==t.footer&&i[0].footer&&(r=nm("footer",i,r,a,l)),r}(this.getState(),r);!1!==r.download?nh(new Blob(["\uFEFF"+n],{type:"text/csv"}),l):e.result=n,t(!0)}else if("xlsx"==r.format){var a;let n,i,s,o,c,u=r.styles;u||!1===u||(a=this.getState()._skin,n={material:"0.5px solid #dfdfdf",willow:"0.5px solid #e6e6e6","willow-dark":"0.5px solid #384047"},i=({material:"#000000",willow:"#000000","willow-dark":"#ffffff"})[a],s="0.5px solid "+({material:"#dfdfdf",willow:"#e6e6e6","willow-dark":"#384047"})[a],c={fontWeight:"bold",color:i,background:({material:"#fafafb",willow:"#f2f3f7","willow-dark":"#20262b"})[a],...o={verticalAlign:"center",align:"left"},borderBottom:s,borderRight:s},u={cell:{color:i,background:({material:"none",willow:"none","willow-dark":"#2a2b2d"})[a],borderBottom:n[a],borderRight:n[a],...o},header:{...c},footer:{...c}});let d=u,h=d?[{...d.header},{...d.lastHeaderCell||d.header},{...d.cell},{...d.firstFooterCell||d.footer},{...d.footer}]:[,,,,,].fill({}),{cells:f,merged:m,rowSizes:p,colSizes:x,styles:g}=function(e,t,n){let r=[],l=[],a=[],i=[],s=e._columns,o=e.flatData,c=e._sizes;for(let e of s)a.push({width:e.flexgrow?c.columnWidth:e.width});let u=0;!1!==t.header&&s[0].header&&(np("header",s,r,l,u,t,n),i=i.concat(c.headerRowHeights.map(e=>({height:e}))),u+=s[0].header.length);for(let e=0;e<o.length;e++){let l=[];for(let r=0;r<s.length;r++){let a=o[e],i=s[r],c=nu(a,i)??"",u=nf(a,i),d;t.cellStyle&&(d=t.cellStyle(c,a,i)),t.cellTemplate&&(u=t.cellTemplate(c,a,i)??u);let h=nx(u,2,d,n);l.push(h)}r.push(l),i.push({height:c.rowHeight})}return u+=o.length,!1!==t.footer&&s[0].footer&&(np("footer",s,r,l,u,t,n),i=i.concat(c.footerRowHeights.map(e=>({height:e})))),{cells:r,merged:l,rowSizes:i,colSizes:a,styles:n}}(this.getState(),r,h),w=r.cdn||"https://cdn.dhtmlx.com/libs/json2excel/1.3.2/worker.js";this.getXlsxWorker(w).then(n=>{n.onmessage=n=>{if("ready"==n.data.type){let a=n.data.blob;!1!==r.download?nh(a,l):e.result=a,t(!0)}},n.postMessage({type:"convert",data:{data:[{name:r.sheetName||"data",cells:f,cols:x,rows:p,merged:m}],styles:g}})})}else n()})),n.on("hotkey",({key:e,event:t,isInput:n})=>{switch(e){case"arrowup":{let{flatData:e,focusCell:r,select:l}=this.getState();if(t.preventDefault(),n)return;let a=r?r.column:this._getFirstVisibleColumn()?.id,i=r?this.getPrevRow(r.row)?.id:e[e.length-1]?.id;a&&i&&(this.in.exec("focus-cell",{row:i,column:a,eventSource:"key"}),l&&this.in.exec("select-row",{id:i}));break}case"arrowdown":{let{flatData:e,focusCell:r,select:l}=this.getState();if(t.preventDefault(),n)return;let a=r?r.column:this._getFirstVisibleColumn()?.id,i=r?this.getNextRow(r.row)?.id:e[0]?.id;a&&i&&(this.in.exec("focus-cell",{row:i,column:a,eventSource:"key"}),l&&this.in.exec("select-row",{id:i}));break}case"arrowright":{let{focusCell:e}=this.getState();if(n)return;if(t.preventDefault(),e){let t=this.getNextColumn(e.column,!0)?.id;t&&this.in.exec("focus-cell",{row:e.row,column:t,eventSource:"key"})}break}case"arrowleft":{let{focusCell:e}=this.getState();if(n)return;if(t.preventDefault(),e){let t=this.getPrevColumn(e.column,!0)?.id;t&&this.in.exec("focus-cell",{row:e.row,column:t,eventSource:"key"})}break}case"tab":{let{editor:e,focusCell:n,select:r}=this.getState();if(e){t.preventDefault();let n=e.column,l=e.id,a=this.getNextEditor(this.getRow(l),this.getColumn(n));if(!a){let e=this.getNextRow(l);e&&(l=e.id,a=this.getNextEditor(e))}a&&(this.in.exec("open-editor",{id:l,column:a.id}),this.in.exec("focus-cell",{row:l,column:a.id,eventSource:"key"}),r&&!this.isSelected(l)&&this.in.exec("select-row",{id:l}))}else n&&this.in.exec("focus-cell",{eventSource:"key"});break}case"shift+tab":{let{editor:e,focusCell:n,select:r}=this.getState();if(e){t.preventDefault();let n=e.column,l=e.id,a=this.getPrevEditor(this.getRow(l),this.getColumn(n));if(!a){let e=this.getPrevRow(l);e&&(l=e.id,a=this.getPrevEditor(e))}a&&(this.in.exec("open-editor",{id:l,column:a.id}),this.in.exec("focus-cell",{row:l,column:a.id,eventSource:"key"}),r&&!this.isSelected(l)&&this.in.exec("select-row",{id:l}))}else n&&this.in.exec("focus-cell",{eventSource:"key"});break}case"escape":{let{editor:e}=this.getState();e&&(this.in.exec("close-editor",{ignore:!0}),this.in.exec("focus-cell",{row:e.id,column:e.column,eventSource:"key"}));break}case"f2":{let{editor:e,focusCell:t}=this.getState();!e&&t&&this.in.exec("open-editor",{id:t.row,column:t.column});break}case"enter":{let{focusCell:e,tree:t}=this.getState();if(!n&&t&&e&&this.getColumn(e.column).treetoggle){let t=this.getRow(e.row);if(!t.data)return;this.in.exec(t.open?"close-row":"open-row",{id:e.row,nested:!0})}break}case"home":{let{editor:e,focusCell:n}=this.getState();if(!e&&n){t.preventDefault();let e=this._getFirstVisibleColumn()?.id;this.in.exec("focus-cell",{row:n.row,column:e,eventSource:"key"})}break}case"ctrl+home":{let{editor:e,focusCell:n,flatData:r,select:l}=this.getState();if(!e&&n){t.preventDefault();let e=r[0]?.id,n=this._getFirstVisibleColumn()?.id;e&&n&&(this.in.exec("focus-cell",{row:e,column:n,eventSource:"key"}),l&&!this.isSelected(e)&&this.in.exec("select-row",{id:e}))}break}case"end":{let{editor:e,focusCell:n}=this.getState();if(!e&&n){t.preventDefault();let e=this._getLastVisibleColumn()?.id,r=n.row;this.in.exec("focus-cell",{row:r,column:e,eventSource:"key"})}break}case"ctrl+end":{let{editor:e,focusCell:n,flatData:r,select:l}=this.getState();if(!e&&n){t.preventDefault();let e=r.at(-1).id,n=this._getLastVisibleColumn()?.id;e&&n&&(this.in.exec("focus-cell",{row:e,column:n,eventSource:"key"}),l&&!this.isSelected(e)&&this.in.exec("select-row",{id:e}))}break}case"ctrl+z":this.in.exec("undo",{});break;case"ctrl+y":this.in.exec("redo",{})}}),n.on("scroll",e=>{let{_columns:t,split:n,_sizes:r,flatData:l,dynamic:a}=this.getState(),i=-1,s=-1,o=0;if(e.column){i=0;let r=t.findIndex(t=>t.id==e.column);o=t[r].width;for(let e=n.left??0;e<r;e++){let n=t[e];n.hidden||(i+=n.width)}}if(e.row&&!a){let t=l.findIndex(t=>t.id===e.row);t>=0&&(s=r.rowHeight*t)}this.setState({scroll:{top:s,left:i,width:o,height:r.rowHeight}})}),n.on("print",e=>{let t=function(e={}){let{mode:t,ppi:n,paper:r}=e;return{mode:t||"portrait",ppi:n||100,paper:r||"a4"}}(e);this.setState({_print:t}),this.setStateAsync({_print:null})}),n.on("undo",()=>{this._historyManager?.handleUndo()}),n.on("redo",()=>{this._historyManager?.handleRedo()}),this.initOnce()}getXlsxWorker(e){if(!this._xlsxWorker){let t=window.URL.createObjectURL(new Blob([`importScripts('${e}');`],{type:"text/javascript"}));this._xlsxWorker=new Promise(e=>{let n=new Worker(t);n.addEventListener("message",t=>{"init"===t.data.type&&e(n)})})}return this._xlsxWorker}initOnce(){this._router.init({sortMarks:{},_filterIds:null,data:[],filterValues:{},scroll:null,editor:null,focusCell:null,_print:null,history:{undo:0,redo:0}})}init(e){e.hasOwnProperty("_skin")&&!e._skin&&(e._skin=function(){if(typeof document>"u")return"willow";let e=document.querySelector('[class^="wx"][class$="theme"]');return e?e.className.substring(3,e.className.length-6):"willow"}()),e.columns&&e.columns.forEach(e=>{e.options&&(e.optionsMap=new Map(e.options.map(e=>[e.id,e.label])))}),ni(this.getState().data,e.data)||(e.tree?(this._branches={0:{data:e.data}},e.data=this.normalizeTreeRows(e.data)):e.data=this.normalizeRows(e.data),this.setState({_filterIds:null,filterValues:{},sortMarks:{}}),this._historyManager&&this._historyManager.resetHistory()),e.undo&&!this._historyManager&&(this._historyManager=new nC(this.in,this.getState.bind(this),this.setState.bind(this))),this._router.init({...e})}setState(e,t){return this._router.setState(e,t)}setStateAsync(e){this._router.setStateAsync(e)}getRow(e){let{tree:t}=this.getState();return t?this._branches[e]:this.getState().data.find(t=>t.id==e)}getRowIndex(e,t){return t||(t=this.getState().flatData),t.findIndex(t=>t.id==e)}getNextRow(e){let t=this.getState().flatData,n=this.getRowIndex(e,t);return t[n+1]}getPrevRow(e){let t=this.getState().flatData,n=this.getRowIndex(e,t);return t[n-1]}getColumn(e){return this.getState().columns.find(t=>t.id==e)}getNextColumn(e,t){let n=this.getState()._columns,r=n.findIndex(t=>t.id==e);return t?this._getFirstVisibleColumn(r+1):n[r+1]}getPrevColumn(e,t){let n=this.getState()._columns,r=n.findIndex(t=>t.id==e);return t?this._getLastVisibleColumn(r-1):n[r-1]}_getFirstVisibleColumn(e){let t=this.getState()._columns,n=e??0;for(;n<t.length&&(t[n]?.hidden||t[n]?.collapsed);)n++;return t[n]}_getLastVisibleColumn(e){let t=this.getState()._columns,n=e??t.length-1;for(;n<t.length&&(t[n]?.hidden||t[n]?.collapsed);)n--;return t[n]}isCellEditable(e,t){let{editor:n,hidden:r}=t;return!!n&&!r&&("function"!=typeof n||n(e,t))}getNextEditor(e,t){let n=this.getState().columns;if(t){let e=n.findIndex(e=>e.id==t.id);n=n.slice(e+1)}return n.find(t=>this.isCellEditable(e,t))}getPrevEditor(e,t){let n=this.getState().columns;if(t){let e=n.findLastIndex(e=>e.id==t.id);n=n.slice(0,e)}return n.findLast(t=>this.isCellEditable(e,t))}toggleBranch(e,t,n){let r=this._branches[e],{data:l}=this.getState();if(l=[...l],0!==e){r={...r,open:t};let e=this.updateTreeRow(r);0===r.$parent&&(l=e)}n&&r.data?.length&&r.data.forEach(r=>{let a=this.toggleKids(r,t,n);0===e&&(l=a)}),this.setState({data:l})}toggleKids(e,t,n){e={...e,open:t};let r=this.updateTreeRow(e);return n&&e.data?.length&&e.data.forEach(e=>{this.toggleKids(e,t,n)}),r}updateTreeRow(e){let t=e.id;this._branches[t]=e;let n=this._branches[e.$parent],r=n.data.findIndex(e=>e.id==t);return n.data=[...n.data],n.data[r]=e,n.data}isSelected(e){return -1!==this.getState().selectedRows.indexOf(e)}findAndRemove(e,t){for(let n=0;n<e.length;n++){if(e[n].id==t)return e.splice(n,1)[0];if(e[n].data){let r=[...e[n].data],l=this.findAndRemove(r,t);if(l)return e[n]={...e[n],data:r},l}}return null}insertItem(e,t,n,r){for(let l=0;l<e.length;l++){if(e[l].id==t){let t=e[l],a="before"===r?l:l+1;if(t.data){if("before"===r){let t=l>0?e[l-1]:null;return t?.data&&t.open?e[l-1]={...t,data:[...t.data,n]}:e.splice(a,0,n),!0}else if(t.open)return e[l]={...t,data:[n,...t.data]},!0}return e.splice(a,0,n),!0}if(e[l].data&&(e[l]={...e[l],data:[...e[l].data]},this.insertItem(e[l].data,t,n,r)))return!0}return!1}moveItem(e,t,n,r){let l=[...n],a=this.findAndRemove(l,e);return this.insertItem(l,t,a,r),l}copyColumns(e){let t=[];return e.forEach(e=>{let n={...e};this.copyHeaderFooter(n,"header"),this.copyHeaderFooter(n,"footer"),t.push(n)}),t}copyHeaderFooter(e,t){let n=e[t];(n=Array.isArray(n)?[...n]:[n]).forEach((e,t)=>{n[t]="string"==typeof e?{text:e}:{...e}}),e[t]=n}setCollapsibleColumns(e,t,n){let r=e.header;for(let l=0;l<r.length;l++){let a=r[l];if(a.collapsible&&a.collapsed){if("first"!==a.collapsible){e.collapsed=!0,e.width=36,a.vertical=!0;let t=r.length-l;(r=r.slice(0,l+1))[l].rowspan=t}let i=a.colspan;if(i){let e=r[l+1],a=1;e&&e.colspan&&!e.collapsed&&(a=e.colspan);for(let e=a;e<i;e++){let r=n[t+e];r&&(r.hidden=!0)}}}}}normalizeColumns(e,t,n,r,l){let a=e[t];a.width||(a.width=a.flexgrow?17:l.columnWidth),a._colindex=t+1;let i=a[n],s=l[`${n}RowHeights`];for(let o=0;o<r;o++){let c=i[o];c.id=a.id,o===i.length-1&&(c.rowspan=c.rowspan?Math.min(c.rowspan,r-o):r-o);for(let r=1;r<c.rowspan;r++){i.splice(o+r,0,{_hidden:!0});for(let l=1;l<c.colspan;l++)e[t+l][n].splice(o+r,0,{})}if(c.rowspan){let e=(c.rowspan===r?s:s.slice(o,c.rowspan+o)).reduce((e,t)=>e+t,0);c.height=e,o+c.rowspan!=r&&c.height--}if(c.colspan){let n=a.width,r=a.flexgrow||0,i=c.colspan;for(let a=1;a<i;a++){let i=e[t+a];i&&(i.hidden?c.colspan-=1:i.flexgrow?r+=i.flexgrow:n+=i.width||l.columnWidth),r?c.flexgrow=r:c.width=n}}else c.width=a.width,c.flexgrow=a.flexgrow;"header"===n&&c.filter&&"string"==typeof c.filter&&(c.filter={type:c.filter})}i.length>r&&(i.length=r),a[n]=i}normalizeRows(e){return e.forEach(e=>{e.id||(e.id=nD())}),e}normalizeTreeRows(e,t,n){return e.forEach(e=>{e.id||(e.id=nD()),e.$level=t||0,e.$parent=n||0,this._branches[e.id]=e,e.data&&(e.data.length?(e.$count=e.data.length,this.normalizeTreeRows(e.data,e.$level+1,e.id)):(delete e.data,delete e.$count,delete e.open))}),e}sortTree(e,t){e.sort(t),e.forEach(e=>{e.data&&this.sortTree(e.data,t)})}filterTree(e,t,n){return e.forEach(e=>{t(e)&&n.push(e.id),e.data&&this.filterTree(e.data,t,n)}),n}flattenRows(e,t,n){return e.forEach(e=>{(!n||n.includes(e.id))&&t.push(e),e.data?.length&&!1!==e.open&&this.flattenRows(e.data,t,n)}),t}createFilter(e){let{_columns:t}=this.getState(),n=[];for(let r in e){let{config:l,type:a}=t.find(e=>e.id==r).header.find(e=>e.filter).filter,i=e[r];n.push(e=>l?.handler?l.handler(e[r],i):nE[a](e[r],i))}return e=>{for(let t=0;t<n.length;t++)if(!n[t](e))return!1;return!0}}normalizeSizes(e,t,n,r,l){let a=nN(e,"header",n,t.headerHeight,l),i=nN(e,"footer",r,t.footerHeight,l),s=a.reduce((e,t)=>e+t,0),o=i.reduce((e,t)=>e+t,0);return{...t,headerRowHeights:a,footerRowHeights:i,headerHeight:s,footerHeight:o}}}let n$=new Date().valueOf();function nD(){return"temp://"+n$++}function nR(e,{keys:t,exec:n}){for(let e in t){let n=e.toLowerCase().replace(/ /g,"");n!==e&&(t[n]=t[e])}function r(r){let l=r.code.replace("Key","").toLowerCase();" "===l&&(l="space");let a=`${r.ctrlKey||r.metaKey?"ctrl+":""}${r.shiftKey?"shift+":""}${r.altKey?"alt+":""}${l.replace(/^key/,"")}`,i=t[a];if("u">typeof i){let t="INPUT"===r.target.tagName||"TEXTAREA"===r.target.tagName||(function(e,t="data-id"){let n=e;for(!n.tagName&&e.target&&(n=e.target);n;){if(n.getAttribute&&n.getAttribute(t))return n;n=n.parentNode}return null})(r.target,"data-header-id")?.classList.contains("wx-filter")||!!r.target.closest(".wx-cell.wx-editor");"function"==typeof i?i({key:a,event:r,node:e,isInput:t}):i&&n({key:a,event:r,node:e,isInput:t})}}return e.addEventListener("keydown",r),{destroy:()=>{e.removeEventListener("keydown",r)}}}new Date().valueOf();let nA={grid:{"Add before":"Add before","Add after":"Add after",Copy:"Copy",Delete:"Delete"}},nI=1,nH={};function nF({onClick:e,onShow:t,option:n}){let r=(0,c.useRef)(null),l=(0,c.useCallback)(()=>{t(!!n.data&&n.id,r.current)},[t,n]),a=(0,c.useMemo)(()=>{var e;return n&&n.comp?nH[e=n.comp]||e:null},[n]);return(0,o.jsxs)("div",{ref:r,className:`wx-cDCz9rZQ wx-option ${n.css||""}`,"data-id":n.id,onMouseEnter:l,onClick:e,children:[n.icon?(0,o.jsx)("i",{className:`wx-cDCz9rZQ wx-icon ${n.icon}`}):null,n.comp?a?(0,o.jsx)(a,{item:n,option:n}):null:(0,o.jsxs)("span",{className:"wx-cDCz9rZQ wx-value",children:[" ",n.text," "]}),n.subtext?(0,o.jsx)("span",{className:"wx-cDCz9rZQ wx-subtext",children:n.subtext}):null,n.data?(0,o.jsx)("i",{className:"wx-cDCz9rZQ wx-sub-icon wxi-angle-right"}):null]})}function nL({options:e,left:t=0,top:n=0,at:r="bottom",parent:u=null,mount:d=null,context:h=null,css:f="",onClick:p}){let[x,g]=(0,c.useState)(-1e4),[w,y]=(0,c.useState)(-1e4),[v,b]=(0,c.useState)(20),[k,S]=(0,c.useState)(),N=(0,c.useRef)(null),[E,T]=(0,c.useState)(!1),[$,D]=(0,c.useState)(null),R=(0,c.useCallback)(()=>{let e=function(e,t,n="bottom",r=0,o=0){if(!e)return null;l=r,a=o,i="auto";let c=0,u=0,d=function(e){let t=m.getTopNode(e);for(e&&(e=e.parentElement);e;){let n=getComputedStyle(e).position;if(e===t||"relative"===n||"absolute"===n||"fixed"===n)return e;e=e.parentNode}return null}(e),h=_(n)?m.getTopNode(e):d;if(!d)return null;let f=d.getBoundingClientRect(),p=e.getBoundingClientRect(),x=h.getBoundingClientRect();if(t&&(c=Math.max(function(e,t){let n=0,r=m.getTopNode(e);for(;e&&e!==r;){let r=getComputedStyle(e).position;if(("absolute"===r||"relative"===r||"fixed"===r)&&(n=parseInt(getComputedStyle(e).zIndex)||0),(e=e.parentNode)===t)break}return n}(t,d)+1,20)),t){if(s=t.getBoundingClientRect(),M(n)&&(i=s.width+"px"),"point"!==n)if(-1!==n.indexOf("center"))M(n)?l=0:(l=x.width/2,u=1),a=(x.height-p.height)/2;else{let e=+!_(n);l=j(n)?s.right+e:s.left-e,a=-1!==n.indexOf("bottom")?s.bottom+1:s.top}}else s={left:r,right:r,top:o,bottom:o};-1!==n.indexOf("left")&&(l=s.left,u=2),-1!==n.indexOf("top")&&(a=s.top-p.height);let g=a+p.height-x.bottom;return g>0&&(a-=g),l+p.width-x.right>0&&(j(n)?u=2:l=x.right-p.width),u&&(l=Math.round(l-p.width*u/2)),l<0&&(l="left"!==n?0:s.right),l+=h.scrollLeft-f.left,a+=h.scrollTop-f.top,{x:l,y:a,z:c,width:i=i||"auto"}}(N.current,u,r,t,n);e&&(g(e.x),y(e.y),b(e.z),S(e.width))},[u,r,t,n]);(0,c.useEffect)(()=>{d&&d(R)},[]);let A=(0,c.useCallback)(()=>{T(!1)},[]),I=(0,c.useCallback)(()=>{p&&p({action:null,option:null})},[p]),H=(0,c.useCallback)((e,t)=>{T(e),D(t)},[]),F=(0,c.useMemo)(()=>(function e(t,n){return t.map(t=>{let r=n(t);return t.data&&t.data.length&&(r.data=e(t.data,n)),r})})(e,e=>{let t={...e,id:e.id||nI++};return t.type&&(t.comp=t.type),t}),[e]);return(0,c.useEffect)(()=>{R()},[u,R]),(0,c.useEffect)(()=>{if(N.current)return C(N.current,{callback:I,modal:!0}).destroy},[I]),(0,o.jsx)("div",{ref:N,"data-wx-menu":"true",className:`wx-XMmAGqVx wx-menu ${f}`,style:{position:"absolute",top:w+"px",left:x+"px",width:k,zIndex:v},onMouseLeave:A,children:F.map(e=>(0,o.jsxs)(c.Fragment,{children:["separator"===e.comp?(0,o.jsx)("div",{className:"wx-XMmAGqVx wx-separator"}):(0,o.jsx)(nF,{option:e,onShow:H,onClick:t=>{if(!e.data&&!t.defaultPrevented){let n={context:h,action:e,option:e,event:t};e.handler&&e.handler(n),p&&p(n),t.stopPropagation()}}}),e.data&&E===e.id?(0,o.jsx)(nL,{css:f,options:e.data,at:"right-overlap",parent:$,context:h,onClick:p}):null]},e.id))})}let nz=(0,c.forwardRef)(function(e,t){let{options:n,at:r="bottom",resolver:l=null,dataKey:a="contextId",filter:i=null,css:s="",children:u,onClick:d}=e,[h,m]=(0,c.useState)(null),[p,x]=(0,c.useState)(null),[g,w]=(0,c.useState)(0),[y,v]=(0,c.useState)(0),b=(0,c.useMemo)(()=>null!==h&&i?function e(t,n){let r=[];return t.forEach(t=>{if(t.data){let l=e(t.data,n);l.length&&r.push({...t,data:l})}else n(t)&&r.push(t)}),r}(n,e=>i(e,h)):n,[h,i,n]),k=(0,c.useCallback)(e=>{x(null),d&&d(e)},[d]),S=(0,c.useCallback)((e,t)=>{let n=null;for(;e&&e.dataset&&!n;)n=e.dataset[t],e=e.parentNode;return n?f(n):null},[]),C=(0,c.useCallback)((e,t)=>{if(!e)return void x(null);if(e.defaultPrevented)return;let n=e.target;if(n&&n.dataset&&n.dataset.menuIgnore)return;w(e.clientX+1),v(e.clientY+1);let r="u">typeof t?t:S(n,a);(!l||(r=l(r,e)))&&(m(r),x(n),e.preventDefault())},[a,S,l]);return(0,c.useImperativeHandle)(t,()=>({show:C}),[C]),(0,o.jsxs)(o.Fragment,{children:[u?(0,o.jsx)("span",{onClick:C,"data-menu-ignore":"true",children:"function"==typeof u?u():u}):null,p?(0,o.jsx)(eN,{children:(0,o.jsx)(nL,{css:s,at:r,top:y,left:g,parent:p,context:h,onClick:k,options:b},p)}):null]})});(0,c.forwardRef)(function(e,t){let{options:n,at:r="bottom",css:l="",children:a,onClick:i}=e,[s,u]=(0,c.useState)(null),d=(0,c.useCallback)(e=>{u(e.target),e.preventDefault()},[]);(0,c.useImperativeHandle)(t,()=>({show:d}),[d]);let h=(0,c.useRef)(0),f=(0,c.useRef)(s);return(0,c.useEffect)(()=>{f.current!==s&&(h.current+=1,f.current=s)},[s]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{onClick:function(e){let t=e.target;for(;!t.dataset.menuIgnore;)u(t),t=t.parentNode},"data-menu-ignore":"true",children:a}),s?(0,o.jsx)(eN,{children:(0,o.jsx)(nL,{css:l,at:r,parent:s,options:n,onClick:function(e){u(null),i&&i(e)}},h.current)}):null]})});let nP=(0,c.forwardRef)(function(e,t){let{options:n,at:r="bottom",resolver:l=null,dataKey:a="contextId",filter:i=null,css:s="",children:u}=e,d=e.onClick??e.onclick,h=(0,c.useRef)(null),f=(0,c.useCallback)((e,t)=>{h.current.show(e,t)},[]);return(0,c.useImperativeHandle)(t,()=>({show:f}),[f]),(0,o.jsxs)(o.Fragment,{children:[u?(0,o.jsx)("span",{onContextMenu:f,"data-menu-ignore":"true",children:u}):null,(0,o.jsx)(nz,{css:s,at:r,options:n,resolver:l,dataKey:a,filter:i,ref:h,onClick:d})]})});var nW=Array.isArray,nO=Object.defineProperty,nY=globalThis.process?.env?.NODE_ENV,nB=nY&&!nY.toLowerCase().startsWith("prod"),nV=[];function nG(e){var t=this.ownerDocument,n=e.type,r=e.composedPath?.()||[],l=r[0]||e.target,a=0,i=e==e&&e.__root;if(i){var s=r.indexOf(i);if(-1!==s&&(this===document||this===window)){e.__root=this;return}var o=r.indexOf(this);if(-1===o)return;s<=o&&(a=s)}if((l=r[a]||e.target)!==this){nO(e,"currentTarget",{configurable:!0,get:()=>l||t});try{for(var c,u=[];null!==l;){var d=l.assignedSlot||l.parentNode||l.host||null;try{var h=l["__"+n];if(null!=h&&(!l.disabled||e.target===l))if(nW(h)){var[f,...m]=h;f.apply(l,[e,...m])}else h.call(l,e)}catch(e){c?u.push(e):c=e}if(e.cancelBubble||d===this||null===d)break;l=d}if(c){for(let e of u)queueMicrotask(()=>{throw e});throw c}}finally{e.__root=this,delete e.currentTarget}}}if(nB){let e=function(e){if(!(e in globalThis)){let t;Object.defineProperty(globalThis,e,{configurable:!0,get:()=>{if(void 0!==t)return t;if(nB){let t=Error(`rune_outside_svelte
The \`${e}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files
https://svelte.dev/e/rune_outside_svelte`);throw t.name="Svelte error",t}throw Error("https://svelte.dev/e/rune_outside_svelte")},set:e=>{t=e}})}};e("$state"),e("$effect"),e("$derived"),e("$inspect"),e("$props"),e("$bindable")}let nK=(0,c.createContext)(null);function nq(e){let t=e.getBoundingClientRect(),n=document.body;return{y:Math.round(t.top+n.scrollTop-n.clientTop||0),x:Math.round(t.left+n.scrollLeft-n.clientLeft||0),width:e.offsetWidth,height:e.offsetHeight}}function nU(e,t){let n=nq(t);return{x:e.clientX-n.x,y:e.clientY-n.y}}function nQ(e){e.scrollSpeedFactor=1,e.autoScrollTimer&&(e.autoScrollTimer=clearTimeout(e.autoScrollTimer),e.activeAutoScroll=clearInterval(e.activeAutoScroll))}function nX(e,t,n){var r,l,a,i,s,o;let{x:c,y:u}=n;e.scrollSpeedFactor+=.004,0!==c&&(r=e,l=t,a=c,function(e,t,n){n.node[t]=e}(l.node.scrollLeft+Math.round(l.sense/3)*r.scrollSpeedFactor*a,"scrollLeft",l)),0!==u&&(i=e,s=t,o=u,function(e,t,n){n.node[t]=e}(s.node.scrollTop+Math.round(s.sense/3)*i.scrollSpeedFactor*o,"scrollTop",s))}function nJ(e,t,n,r,l,a){let i={};return e&&(i.width=`${e}px`,i.minWidth=`${e}px`),t&&(i.flexGrow=t),a&&(i.height=`${a}px`),n&&(i.position="sticky",n.left&&(i.left=`${r}px`),n.right&&(i.right=`${l}px`)),i}function nZ(e,t,n){let r="";if(e.fixed)for(let t in e.fixed)r+=-1===e.fixed[t]?"wx-shadow ":"wx-fixed ";return r+((t.rowspan>1?"wx-rowspan ":"")+(t.colspan>1?"wx-colspan ":"")+(t.vertical?"wx-vertical ":""))+(n?n(e)+" ":"")}function n0(e){let{row:t,column:n,cellStyle:r=null,columnStyle:l=null,children:a,reorder:i}=e,[s,u]=L(e.focusable),d=(0,c.useContext)(nK),h=z(d,"focusCell"),f=(0,c.useMemo)(()=>nJ(n.width,n.flexgrow,n.fixed,n.left,n.right),[n.width,n.flexgrow,n.fixed,n.left,n.right]),m=(0,c.useMemo)(()=>"wx-cell"+((n.fixed?" "+(-1===n.fixed?"wx-shadow":"wx-fixed"):"")+(l?" "+l(n):"")+(r?" "+r(t,n):""))+(n.treetoggle?" wx-tree-cell":""),[l,r,n,t]),p=(0,c.useMemo)(()=>"function"==typeof n.draggable?!1!==n.draggable(t,n):n.draggable,[n,t]),x=(0,c.useRef)(null);(0,c.useEffect)(()=>{let e=h?.row===t.id&&h?.column===n.id;x.current&&s&&e&&x.current.focus()},[h,s,t.id,n.id]);let g=(0,c.useCallback)(()=>{s&&!h&&d.exec("focus-cell",{row:t.id,column:n.id,eventSource:"focus"})},[d,s,h,t.id,n.id]);(0,c.useEffect)(()=>()=>{s&&h&&(d.exec("focus-cell",{eventSource:"destroy"}),u(!1))},[d,u]);let w=(0,c.useMemo)(()=>[m,n.fixed&&-1===n.fixed.left||-1===n.fixed.right?"wx-shadow":"",n.fixed&&n.fixed.right?"wx-fixed-right":""].filter(Boolean).join(" "),[m,n]),y=n.cell;return(0,o.jsxs)("div",{className:"wx-TSCaXsGV "+w,ref:x,onFocus:g,style:f,"data-row-id":t.id,"data-col-id":n.id,tabIndex:s?"0":"-1",role:"gridcell","aria-colindex":n._colindex,"aria-readonly":!n.editor||void 0,children:[i&&n.draggable?p?(0,o.jsx)("i",{"draggable-data":"true",className:"wx-TSCaXsGV wx-draggable wxi-drag"}):(0,o.jsx)("i",{className:"wx-TSCaXsGV wx-draggable-stub"}):null,n.treetoggle?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{style:{marginLeft:`${28*t.$level}px`}}),t.$count?(0,o.jsx)("i",{"data-action":"toggle-row",className:`wx-TSCaXsGV wx-table-tree-toggle wxi-menu-${!1!==t.open?"down":"right"}`}):null]}):null,y?(0,o.jsx)(y,{api:d,row:t,column:n,onAction:({action:e,data:t})=>d.exec(e,t)}):a?a():nf(t,n)]})}function n1(e,t){let n,r;function l(r){n=r.clientX,e.style.opacity=1,document.body.style.cursor="ew-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",a),window.addEventListener("mouseup",i),t&&t.down&&t.down(e)}function a(e){r=e.clientX-n,t&&t.move&&t.move(r)}function i(){e.style.opacity="",document.body.style.cursor="",document.body.style.userSelect="",t&&t.up&&t.up(r),window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",i)}return e.addEventListener("mousedown",l),{destroy(){e.removeEventListener("mousedown",l)}}}let n2={text:function({filter:e,column:t,action:n,filterValue:r}){return(0,o.jsx)(en,{...e.config??{},value:r,onChange:function({value:e}){n({value:e,key:t.id})}})},richselect:function({filter:e,column:t,action:n,filterValue:r}){let l=z((0,c.useContext)(nK),"flatData"),a=(0,c.useMemo)(()=>{let n;return e?.config?.options||t?.options||(n=[],l.forEach(e=>{let r=nu(e,t);n.includes(r)||n.push(r)}),n.map(e=>({id:e,label:e})))},[e,t,l]),i=(0,c.useMemo)(()=>e?.config?.template,[e]);return(0,o.jsx)("div",{style:{width:"100%"},onKeyDown:function(e){"Tab"!==e.key&&e.preventDefault()},children:(0,o.jsx)(eg,{placeholder:"",clear:!0,...e?.config??{},options:a,value:r,onChange:function({value:e}){n({value:e,key:t.id})},children:e=>i?i(e):e.label})})}};function n4({filter:e,column:t}){let n=(0,c.useContext)(nK),r=z(n,"filterValues"),l=(0,c.useMemo)(()=>n2[e.type],[e.type]);return(0,o.jsx)(l,{filter:e,column:t,action:function(e){n.exec("filter-rows",e)},filterValue:r[t.id]})}function n3(e){let t,{cell:n,column:r,row:l,lastRow:a,sortRow:i,columnStyle:s,bodyHeight:u,hasSplit:d}=e,h=(0,c.useContext)(nK),f=z(h,"sortMarks"),m=(0,c.useMemo)(()=>f?f[r.id]:void 0,[f,r.id]),p=(0,c.useRef)(),x=(0,c.useCallback)(e=>{p.current=n.flexgrow?e.parentNode.clientWidth:n.width},[n.flexgrow,n.width]),g=(0,c.useCallback)((e,t)=>{h.exec("resize-column",{id:n.id,width:Math.max(1,(p.current||0)+e),inProgress:t})},[h,n.id]),w=(0,c.useCallback)(e=>g(e,!0),[g]),y=(0,c.useCallback)(e=>g(e,!1),[g]),v=(0,c.useCallback)(e=>{!r.sort||n.filter||h.exec("sort-rows",{key:n.id,add:e.ctrlKey})},[h,n.id,n.filter,r.sort]),b=(0,c.useCallback)(e=>{e&&e.stopPropagation(),h.exec("collapse-column",{id:n.id,row:l})},[h,n.id,l]),k=(0,c.useCallback)(e=>{"Enter"===e.key&&b()},[b]),S=(0,c.useCallback)(e=>{"Enter"!==e.key||n.filter||v(e)},[v,n.filter]),C=(0,c.useMemo)(()=>n.collapsed&&r.collapsed,[n.collapsed,r.collapsed]),j=(0,c.useMemo)(()=>C&&!d&&"header"!==n.collapsible,[C,d,n.collapsible]),M=(0,c.useMemo)(()=>j?{top:-u/2,position:"absolute"}:{},[j,u]),_=(0,c.useMemo)(()=>nJ(n.width,n.flexgrow,r.fixed,r.left,n.right??r.right,n.height+(C&&j?u:0)),[n.width,n.flexgrow,r.fixed,r.left,n.right,r.right,n.height,C,j,u]),N=(0,c.useMemo)(()=>nZ(r,n,s),[r,n,s]),E=(0,c.useCallback)(()=>Object.fromEntries(Object.entries(n).filter(([e])=>"cell"!==e)),[n]),T=`wx-cell ${N} ${n.css||""} wx-collapsed`,$=["wx-cell",N,n.css||"",n.filter?"wx-filter":"",r.fixed&&r.fixed.right?"wx-fixed-right":""].filter(Boolean).join(" "),D=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=D.current;if(!e)return;let t=n1(e,{down:x,move:w,up:y});return()=>{"function"==typeof t&&t()}},[x,w,y,n1]),C?(0,o.jsx)("div",{className:"wx-RsQD74qC "+T,style:_,role:"button","aria-label":`Expand column ${n.text||""}`,"aria-expanded":!n.collapsed,tabIndex:0,onKeyDown:k,onClick:b,"data-header-id":r.id,children:(0,o.jsx)("div",{className:"wx-RsQD74qC wx-text",style:M,children:n.text||""})}):(0,o.jsxs)("div",{className:"wx-RsQD74qC "+$,style:_,onClick:v,"data-header-id":r.id,tabIndex:n._hidden||!r.sort||n.filter?void 0:0,role:"columnheader","aria-colindex":n._colindex,"aria-colspan":n.colspan>1?n.colspan:void 0,"aria-rowspan":n.rowspan>1?n.rowspan:void 0,"aria-sort":!m?.order||n.filter?"none":m?.order==="asc"?"ascending":"descending",onKeyDown:S,children:[n.collapsible?(0,o.jsx)("div",{className:"wx-RsQD74qC wx-collapse",role:"button","aria-label":n.collapsed?"Expand column":"Collapse column","aria-expanded":!n.collapsed,tabIndex:0,onKeyDown:k,onClick:b,children:(0,o.jsx)("i",{className:`wx-RsQD74qC wxi-angle-${n.collapsed?"down":"right"}`})}):null,n.cell?(t=n.cell,(0,o.jsx)(t,{api:h,cell:E(),column:r,row:l,onAction:({action:e,data:t})=>h.exec(e,t)})):n.filter?(0,o.jsx)(n4,{filter:n.filter,column:r}):(0,o.jsx)("div",{className:"wx-RsQD74qC wx-text",children:n.text||""}),r.resize&&a&&!n._hidden?(0,o.jsx)("div",{className:"wx-RsQD74qC wx-grip",role:"presentation","aria-label":"Resize column",ref:D,onClick:e=>e.stopPropagation(),children:(0,o.jsx)("div",{})}):null,i?(0,o.jsx)("div",{className:"wx-RsQD74qC wx-sort",children:m?(0,o.jsxs)(o.Fragment,{children:["u">typeof m.index?(0,o.jsx)("div",{className:"wx-RsQD74qC wx-order",children:m.index+1}):null,(0,o.jsx)("i",{className:`wx-RsQD74qC wxi-arrow-${"asc"===m.order?"up":"down"}`})]}):null}):null]})}function n5({cell:e,column:t,row:n,columnStyle:r}){let l=(0,c.useContext)(nK),a=(0,c.useMemo)(()=>nJ(e?.width,e?.flexgrow,t?.fixed,t?.left,e?.right??t?.right,e?.height),[e?.width,e?.flexgrow,t?.fixed,t?.left,e?.right,t?.right,e?.height]),i=(0,c.useMemo)(()=>nZ(t,e,r),[t,e,r]),s=(0,c.useCallback)(()=>Object.fromEntries(Object.entries(e||{}).filter(([e])=>"cell"!==e)),[e]),u=`wx-6Sdi3Dfd wx-cell ${i||""} ${e?.css||""}`+(t?.fixed&&t?.fixed.right?" wx-fixed-right":"");return(0,o.jsx)("div",{className:u,style:a,children:t?.collapsed||e?.collapsed?null:e?.cell?c.default.createElement(e.cell,{api:l,cell:s(),column:t,row:n,onAction:({action:e,data:t})=>l.exec(e,t)}):(0,o.jsx)("div",{className:"wx-6Sdi3Dfd wx-text",children:e?.text||""})})}function n6({deltaLeft:e,contentWidth:t,columns:n,type:r="header",columnStyle:l,bodyHeight:a}){let i=(0,c.useContext)(nK),s=z(i,"_sizes"),u=z(i,"split"),d=(0,c.useMemo)(()=>s?.[`${r}RowHeights`],[s,r]),h=(0,c.useMemo)(()=>{let e=[];if(n&&n.length){let t=n[0][r].length;for(let l=0;l<t;l++){let t=0;e.push([]),n.forEach((a,i)=>{let s={...a[r][l]};if(t||e[l].push(s),s.colspan>1){if(t=s.colspan-1,a.right){let e=a.right;for(let t=1;t<s.colspan;t++)e-=n[i+t].width;s.right=e}}else t&&t--})}}return e},[n,r]),f=(0,c.useMemo)(()=>u?.left||u?.right,[u]);function m(e){return n.find(t=>t.id===e)}function p(e,t){let n=t;return e.rowspan&&(n+=e.rowspan-1),n===h.length-1}return(0,o.jsx)("div",{className:`wx-sAsPVaUK wx-${r}`,style:{paddingLeft:`${e}px`,width:`${t}px`},role:"rowgroup",children:h.map((e,t)=>(0,o.jsx)("div",{className:"header"===r?"wx-sAsPVaUK wx-h-row":"wx-sAsPVaUK wx-f-row",style:{height:`${d?.[t]}px`,display:"flex"},role:"row",children:e.map(e=>{let n=m(e.id);return"header"===r?(0,o.jsx)(n3,{cell:e,columnStyle:l,column:n,row:t,lastRow:p(e,t),bodyHeight:a,sortRow:function(e,t,n){if(!n.sort)return!1;for(let e=h.length-1;e>=0;e--){let r=n.header[e];if(!r.filter&&!r._hidden)return t===e}return p(e,t)}(e,t,n),hasSplit:f},e.id):(0,o.jsx)(n5,{cell:e,columnStyle:l,column:m(e.id),row:t},e.id)})},t))})}function n7({overlay:e}){let t=(0,c.useContext)(nK);return(0,o.jsx)("div",{className:"wx-1ty666CQ wx-overlay",children:"function"==typeof e?(0,o.jsx)(e,{onAction:({action:e,data:n})=>t.exec(e,n)}):e})}let n8={text:function(e){let{actions:t,editor:n}=e,[r,l]=(0,c.useState)(n?.value||""),a=(0,c.useRef)(null);return(0,c.useEffect)(()=>{a.current&&a.current.focus()},[]),(0,o.jsx)("input",{className:"wx-e7Ao5ejY wx-text",onInput:function(){a.current&&(l(a.current.value),t.updateValue(a.current.value))},onKeyDown:function({key:e}){"Enter"===e&&t.save()},ref:a,type:"text",value:r})},combo:function({actions:e,editor:t,onAction:n}){let[r,l]=(0,c.useState)(t?.value),[a,i]=(0,c.useState)(t?.renderedValue),[s,u]=(0,c.useState)(t?.options||[]),d=(0,c.useMemo)(()=>t?.config?.template,[t]),h=(0,c.useMemo)(()=>t?.config?.cell,[t]),f=(0,c.useMemo)(()=>(s||[]).findIndex(e=>e.id===r),[s,r]),m=(0,c.useRef)(null),p=(0,c.useRef)(null),x=(0,c.useCallback)(e=>{m.current=e.navigate,p.current=e.keydown,m.current(f)},[f,m]),g=(0,c.useCallback)(e=>{let n=e?.target?.value??"";i(n);let r=n?(t?.options||[]).filter(e=>(e.label||"").toLowerCase().includes(n.toLowerCase())):t?.options||[];u(r),r.length?m.current(-1/0):m.current(null)},[t]),w=(0,c.useRef)(null);(0,c.useEffect)(()=>{w.current&&w.current.focus()},[]),(0,c.useEffect)(()=>{l(t?.value),i(t?.renderedValue),u(t?.options||[])},[t]);let y=(0,c.useCallback)(({id:t})=>{e.updateValue(t),e.save()},[e]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{className:"wx-0UYfSd1x wx-input",ref:w,value:a??"",onChange:g,onKeyDown:e=>p.current?p.current(e,f):void 0}),(0,o.jsx)(ee,{items:s,onReady:x,onSelect:y,children:({option:e})=>d?d(e):h?(0,o.jsx)(h,{data:e,onAction:n}):e.label})]})},datepicker:function({actions:e,editor:t,onAction:n}){let[r]=(0,c.useState)(()=>t.value||new Date),[l]=(0,c.useState)(()=>t.config?.template),[a]=(0,c.useState)(()=>t.config?.cell),i=(0,c.useRef)(null);return(0,c.useEffect)(()=>{i.current&&i.current.focus(),"u">typeof window&&window.getSelection&&window.getSelection().removeAllRanges()},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"wx-lNWNYUb6 wx-value",ref:i,tabIndex:0,onClick:()=>e.cancel(),onKeyDown:e=>e.preventDefault(),children:l?l(r):a?(0,o.jsx)(a,{data:t.value,onAction:n}):(0,o.jsx)("span",{className:"wx-lNWNYUb6 wx-text",children:t.renderedValue})}),(0,o.jsx)(U,{width:"auto",children:(0,o.jsx)(ef,{value:r,onChange:function({value:t}){e.updateValue(t),e.save()},buttons:t.config?.buttons})})]})},richselect:function(e){let t,n,{actions:r,editor:l}=e,a=e.onAction??e.onaction,i=l.config||{},[s]=(0,c.useState)(l.options.find(e=>e.id===l.value)),[u]=(0,c.useState)(l.value),[d]=(0,c.useState)(l.options),h=(0,c.useMemo)(()=>d.findIndex(e=>e.id===u),[d,u]),[f,m]=(0,c.useState)(),p=(0,c.useRef)(null);return(0,c.useEffect)(()=>{p.current&&p.current.focus(),"u">typeof window&&window.getSelection&&window.getSelection().removeAllRanges()},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{ref:p,className:"wx-ywGRk611 wx-value",tabIndex:0,onClick:()=>r.cancel(),onKeyDown:e=>{f(e,h),e.preventDefault()},children:i.template?i.template(s):i.cell?(n=i.cell,(0,o.jsx)(n,{data:s,onAction:a})):(0,o.jsx)("span",{className:"wx-ywGRk611 wx-text",children:l.renderedValue})}),(0,o.jsx)(ee,{items:d,onReady:function(e){t=e.navigate,m(()=>e.keydown),t(h)},onSelect:function({id:e}){r.updateValue(e),r.save()},children:({option:e})=>{let t;return i.template?i.template(e):i.cell?(t=i.cell,(0,o.jsx)(t,{data:e,onAction:a})):e.label}})]})}};function n9({column:e,row:t}){let n=(0,c.useContext)(nK),r=z(n,"editor"),l=(0,c.useCallback)((e,t)=>{n.exec("close-editor",{ignore:e}),t&&n.exec("focus-cell",{...t,eventSource:"click"})},[n]),a=(0,c.useCallback)(e=>{l(!1,e?null:{row:r?.id,column:r?.column})},[r,l]),i=(0,c.useCallback)(()=>{l(!0,{row:r?.id,column:r?.column})},[r,l]),s=(0,c.useCallback)(e=>{n.exec("editor",{value:e})},[n]),u=(0,c.useCallback)(e=>{"Enter"===e.key&&r&&i()},[r,i]),d=(0,c.useMemo)(()=>nJ(e.width,e.flexgrow,e.fixed,e.left,e.right),[e.width,e.flexgrow,e.fixed,e.left,e.right]),h=(0,c.useMemo)(()=>{let n=e.editor;return"function"==typeof n&&(n=n(t,e)),n8["string"==typeof n?n:n.type]},[e,t]),f=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(!f.current)return;let e=C(f.current,()=>a(!0));return()=>{"function"==typeof e&&e()}},[a]),(0,c.useEffect)(()=>{f.current&&"string"==typeof d&&f.current.setAttribute("style",d)},[d]);let m="u">typeof t.$parent?"gridcell":"cell",p="u">typeof t.$parent?!e.editor:void 0;return(0,o.jsx)("div",{className:"wx-8l724t2g wx-cell wx-editor",ref:f,style:"object"==typeof d&&null!==d?d:void 0,role:m,"aria-readonly":p,tabIndex:-1,onClick:e=>e.stopPropagation(),onDoubleClick:e=>e.stopPropagation(),onKeyDown:u,children:h?(0,o.jsx)(h,{editor:r,actions:{save:a,cancel:i,updateValue:s},onAction:({action:e,data:t})=>n.exec(e,t)}):null})}function re(e){let{columns:t,type:n,columnStyle:r}=e,l=(0,c.useContext)(nK),{filterValues:a,_columns:i,_sizes:s}=l.getState();return(0,o.jsx)(o.Fragment,{children:t.map((e,t)=>(0,o.jsx)("tr",{children:e.map(e=>{let c=i.find(t=>t.id==e.id),u=`wx-print-cell-${n}${r?" "+r(c):""}${e.filter?" wx-print-cell-filter":""}${e.vertical?" wx-vertical":""}`,d=e.cell;return(0,o.jsx)("th",{style:Y(ny(e,s.columnWidth)),className:"wx-Gy81xq2u "+u,rowSpan:e.rowspan,colSpan:e.colspan,children:d?(0,o.jsx)(d,{api:l,cell:Object.fromEntries(Object.entries(e).filter(([e])=>"cell"!==e)),column:c,row:t}):e.filter?(0,o.jsx)("div",{className:"wx-Gy81xq2u wx-print-filter",children:function(e,t,n){let r=e[n.id];if("richselect"===n.filter.type&&r){let e=n.filter.config?.options||t.find(({id:e})=>e==n.id).options;e&&(r=e.find(({id:e})=>e==r).label)}return r??""}(a,i,e)}):(0,o.jsx)("div",{className:"wx-Gy81xq2u wx-text",children:e.text??""})},e.id)})},t))})}function rt(e){let{columns:t,rowStyle:n,columnStyle:r,cellStyle:l,header:a,footer:i,reorder:s}=e,u=(0,c.useContext)(nK),{flatData:d,_sizes:h}=u.getState(),f=a&&nw(t,"header",h.headerRowHeights),m=i&&nw(t,"footer",h.footerRowHeights);return(0,o.jsxs)("table",{className:`wx-8NTMLH0z wx-print-grid ${t.some(e=>e.flexgrow)?"wx-flex-columns":""}`,children:[a?(0,o.jsx)("thead",{children:(0,o.jsx)(re,{columns:f,type:"header",columnStyle:r})}):null,(0,o.jsx)("tbody",{children:d.map((e,a)=>(0,o.jsx)("tr",{className:"wx-8NTMLH0z wx-row"+(n?" "+n(e):""),children:t.map(t=>{let n;return t.collapsed?null:(0,o.jsxs)("td",{className:`wx-8NTMLH0z wx-print-cell wx-cell ${(r?" "+r(t):"")+(l?" "+l(e,t):"")}`,style:Y(ny(t,h.columnWidth)),children:[s&&t.draggable?(0,o.jsx)("span",{className:"wx-8NTMLH0z wx-print-draggable",children:("function"==typeof t.draggable?!1!==t.draggable(e,t):t.draggable)?(0,o.jsx)("i",{className:"wx-8NTMLH0z wxi-drag"}):null}):null,t.treetoggle?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{style:{marginLeft:28*e.$level+"px"}}),e.$count?(0,o.jsx)("i",{className:`wx-8NTMLH0z wx-print-grid-tree-toggle wxi-menu-${!1!==e.open?"down":"right"}`}):null]}):null,t.cell?(n=t.cell,(0,o.jsx)(n,{api:u,row:e,column:t})):(0,o.jsx)("span",{children:nf(e,t)})]},t.id)})},a))}),i?(0,o.jsx)("tfoot",{children:(0,o.jsx)(re,{columns:m,type:"footer",columnStyle:r})}):null]})}function rn(e){let{config:t,...n}=e,{_skin:r,_columns:l}=(0,c.useContext)(nK).getState(),a=(0,c.useMemo)(()=>{let e,n,r,a,i;return e=[],n=[],r=0,a=l.filter(e=>!e.hidden),i=function(e){let{mode:t,ppi:n,paper:r}=e,{width:l,height:a}=ng[r];return("portrait"===t?l:a)*n}(t),a.forEach((t,l)=>{r+t.width<=i?(r+=t.width,n.push(t)):(n.length&&e.push(n),n=[t],r=t.width),l===a.length-1&&n.length&&e.push(n)}),e},[]),i=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=document.body;e.classList.add("wx-print");let n=i.current;if(!n)return;let r=n.cloneNode(!0);e.appendChild(r);let l=`@media print { @page { size: ${t.paper} ${t.mode}; }`,a=document.createElement("style");a.setAttribute("type","text/css"),a.setAttribute("media","print"),document.getElementsByTagName("head")[0].appendChild(a),a.appendChild(document.createTextNode(l)),window.print(),a.remove(),e.classList.remove("wx-print"),r.remove()},[]),(0,o.jsx)("div",{className:`wx-4zwCKA7C wx-${r}-theme wx-print-container`,ref:i,children:a.map((e,t)=>(0,o.jsx)("div",{className:"wx-4zwCKA7C wx-print-grid-wrapper",children:(0,o.jsx)(rt,{columns:e,...n})},t))})}function rr(e){let{header:t,footer:n,overlay:r,multiselect:l,reorder:a,onreorder:i,rowStyle:s,columnStyle:h,cellStyle:m,autoRowHeight:p,resize:x,clientWidth:g,clientHeight:w,responsiveLevel:y}=e,v=(0,c.useContext)(nK),b=z(v,"dynamic"),k=z(v,"_columns"),S=z(v,"flatData"),j=z(v,"split"),M=z(v,"_sizes"),[_,N]=W(v,"selectedRows"),E=z(v,"select"),T=z(v,"editor"),$=z(v,"tree"),D=z(v,"focusCell"),R=z(v,"_print"),A=z(v,"undo"),[I,H]=(0,c.useState)(0);(0,c.useEffect)(()=>{let e,t;H(((e=document.createElement("div")).style.cssText="position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth,document.body.removeChild(e),t))},[]);let[F,L]=(0,c.useState)(0),[P,O]=(0,c.useState)(0),Y=(0,c.useMemo)(()=>(k||[]).some(e=>!e.hidden&&e.flexgrow),[k]),B=(0,c.useMemo)(()=>M?.rowHeight||0,[M]),G=(0,c.useRef)(null),[K,q]=(0,c.useState)(null),[U,Q]=(0,c.useState)(null),X=(0,c.useMemo)(()=>{let e=[],t=0;return j&&j.left&&((e=(k||[]).slice(0,j.left).filter(e=>!e.hidden).map(e=>({...e}))).forEach(e=>{e.fixed={left:1},e.left=t,t+=e.width}),e.length&&(e[e.length-1].fixed={left:-1})),{columns:e,width:t}},[j,k]),J=(0,c.useMemo)(()=>{let e=[],t=0;if(j&&j.right){e=(k||[]).slice(-1*j.right).filter(e=>!e.hidden).map(e=>({...e}));for(let n=e.length-1;n>=0;n--){let r=e[n];r.fixed={right:1},r.right=t,t+=r.width}e.length&&(e[0].fixed={right:-1})}return{columns:e,width:t}},[j,k]),Z=(0,c.useMemo)(()=>{let e=(k||[]).slice(j?.left||0,(k||[]).length-(j?.right??0)).filter(e=>!e.hidden);return e.forEach(e=>{e.fixed=0}),e},[k,j]),ee=(0,c.useMemo)(()=>(k||[]).reduce((e,t)=>(t.hidden||(e+=t.width),e),0),[k]);function et(e,t,n){let r=t,l=e;if(Z.length){let t=Z.length;for(let r=e;r>=0;r--)Z[r][n].forEach(n=>{n.colspan>1&&r>e-n.colspan&&r<t&&(t=r)});if(t!==Z.length&&t<e){for(let n=t;n<e;n++)r-=Z[n].width;l=t}}return{index:l,delta:r}}let en=(0,c.useMemo)(()=>{let e,t,n,r=F+(g||0),l=0,a=0,i=0,s=0;Z.forEach((e,t)=>{F>i&&(l=t,s=i),r>(i+=e.width)&&(a=t+1)});let o={header:0,footer:0};for(let e=a;e>=l;e--)["header","footer"].forEach(t=>{Z[e]&&Z[e][t].forEach(n=>{let r=n.colspan;if(r&&r>1){let n=r-(a-e+1);n>0&&(o[t]=Math.max(o[t],n))}})});let c=et(l,s,"header"),u=et(l,s,"footer"),d=c.delta,h=c.index,f=u.delta,m=u.index;return Y&&ee>(g||0)?e=t=n=[...X.columns,...Z,...J.columns]:(e=[...X.columns,...Z.slice(l,a+1),...J.columns],t=[...X.columns,...Z.slice(h,a+o.header+1),...J.columns],n=[...X.columns,...Z.slice(m,a+o.footer+1),...J.columns]),{data:e||[],header:t||[],footer:n||[],d:s,df:f,dh:d}},[Z,X,J,F,g,Y,ee]),er=(0,c.useMemo)(()=>t&&M?.headerHeight||0,[t,M]),el=(0,c.useMemo)(()=>n&&M?.footerHeight||0,[n,M]),ea=(0,c.useMemo)(()=>!!g&&!!w&&ee>=g,[g,w,ee]),ei=(0,c.useMemo)(()=>(w||0)-er-el-(ea?I:0),[w,er,el,ea,I]),es=(0,c.useMemo)(()=>Math.ceil((ei||0)/(B||1))+1,[ei,B]),eo=(0,c.useRef)([]),[ec,eu]=(0,c.useState)(0),[ed,eh]=(0,c.useState)(void 0),ef=(0,c.useMemo)(()=>{let e=0,t=0;if(p){let n=P;for(;n>0;)n-=eo.current[e]||B,e++;t=P-n;for(let n=Math.max(0,e-2-1);n<e;n++)t-=eo.current[e-n]||B;e=Math.max(0,e-2)}else t=(e=Math.max(0,(e=Math.floor(P/(B||1)))-2))*(B||0);let n=Math.min(b?b.rowCount:(S||[]).length,e+(es||0)+2);return{d:t,start:e,end:n}},[p,P,B,b,S,es]),em=(0,c.useMemo)(()=>{let e=b?b.rowCount:(S||[]).length,t=e*(B||0);return p?ec+ef.d+(e-(ed||0))*(B||0):t},[b,S,B,p,ec,ef.d,ed]),ep=(0,c.useMemo)(()=>!!g&&!!w&&em+er+el>=w-(ee>=(g||0)?I:0),[g,w,em,er,el,ee,I]),ex=(0,c.useMemo)(()=>Y&&ee<=(g||0)?(g||0)-0-(ep?I:0):ee,[Y,ee,g,ep,I,ea]),eg=(0,c.useMemo)(()=>Y&&ee<=(g||0)?g||0:ex<(g||0)?ee+(ep?I:0):-1,[Y,ee,g,ex,ep,I]),ew=(0,c.useRef)({});(0,c.useEffect)(()=>{if(b&&(ew.current.start!==ef.start||ew.current.end!==ef.end)){let{start:e,end:t}=ef;ew.current={start:e,end:t},v&&v.exec&&v.exec("request-data",{row:{start:e,end:t}})}},[b,ef,v]);let ey=(0,c.useMemo)(()=>b?S||[]:(S||[]).slice(ef.start,ef.end),[b,S,ef]),ev=(0,c.useMemo)(()=>(_||[]).filter(e=>(ey||[]).some(t=>t.id===e)),[N,ey]),eb=(0,c.useMemo)(()=>ef.start,[ef.start]),ek=(0,c.useCallback)(e=>{O(e.target.scrollTop),L(e.target.scrollLeft)},[]),eS=(0,c.useCallback)(e=>{e.shiftKey&&e.preventDefault(),G.current&&G.current.focus&&G.current.focus()},[]),eC=(0,c.useCallback)(()=>!!(k||[]).find(e=>!!e.draggable),[k]),ej=(0,c.useRef)(null),eM=(0,c.useRef)(null),e_=(0,c.useRef)({dblclick:(e,t)=>{let n={id:e,column:d(t,"data-col-id")};v.exec("open-editor",n)},click:(e,t)=>{if(ej.current)return;let n=d(t,"data-col-id"),r=v.getState().focusCell;if(r&&r.row===e&&r.column===n||v.exec("focus-cell",{row:e,column:n,eventSource:"click"}),!1===E)return;let a=l&&t.ctrlKey,i=l&&t.shiftKey,s=v.getState().selectedRows;(1!==s.length||s[0]!==e)&&E&&v.exec("select-row",{id:e,toggle:a,range:i})},"toggle-row":e=>{let t=v.getRow(e);v.exec(!1!==t.open?"close-row":"open-row",{id:e})},"ignore-click":()=>!1}),eN=(0,c.useMemo)(()=>({top:er,bottom:el,left:X.width,xScroll:ea,yScroll:ep,sense:p&&U?U.offsetHeight:Math.max(M?.rowHeight||0,40),node:G.current&&G.current.firstElementChild}),[er,el,X.width,ea,ep,p,U,M]),eE=(0,c.useMemo)(()=>eg>0?{width:`${eg}px`}:void 0,[eg]),eT=(0,c.useRef)(null);(0,c.useEffect)(()=>{ey&&p&&Promise.resolve().then(()=>{let e=0,t=eb,n=eT.current;n&&(Array.from(n.children).forEach((n,r)=>{eo.current[eb+r]=n.offsetHeight,e+=n.offsetHeight,t++}),eu(e),eh(t))})},[ey,p,eb]);let[e$,eD]=(0,c.useState)();(0,c.useEffect)(()=>{if(D&&(!E||!ev.length||ev.includes(D.row)))eD({...D});else if(ey.length&&en.data.length){if(!e$||ev.length&&!ev.includes(e$.row)||-1===ey.findIndex(e=>e.id==e$.row)||-1===en.data.findIndex(e=>e.id==e$.column&&!e.collapsed)){let e=ev[0]||ey[0].id,t=en.data.findIndex(e=>!e.collapsed);eD(-1!==t?{row:e,column:en.data[t].id}:null)}}else eD(null)},[D]);let eR=(0,c.useRef)(null);(0,c.useEffect)(()=>{let e,t=G.current;if(!t)return;let n=((e=new ResizeObserver(e=>{requestAnimationFrame(()=>x(e[0].contentRect))})).observe(t.parentNode),{destroy(){e.disconnect()}});return()=>{"function"==typeof n&&n()}},[x]);let eA=(0,c.useRef)({});Object.assign(eA.current,{start:function(e,t){let{container:n,sourceNode:r,from:l}=t;if(eC()&&!r.getAttribute("draggable-data"))return!1;q(l),v.getRow(l).open&&v.exec("close-row",{id:l,nested:!0});let a=u(r,"data-id"),i=a.cloneNode(!0);i.classList.remove("wx-selected"),i.querySelectorAll("[tabindex]").forEach(e=>e.setAttribute("tabindex","-1")),n.appendChild(i),Q(i);let s=F-en.d,o=ep?I:0;n.style.width=Math.min((g||0)-o,Y&&ee<=(g||0)?ex:ex-o)+s+"px",t.offset={x:s,y:-Math.round(nq(a).height/2)},eM.current||(eM.current=e.clientY)},move:function(e,t){let{from:n}=t,r=t.pos,l=nq(G.current);r.x=l.x;let a=eN.top;if(r.y<a)r.y=a;else{let e=l.height-(ea&&I>0?I:Math.round(eN.sense/2))-eN.bottom;r.y>e&&(r.y=e)}if(G.current.contains(t.targetNode)){let l=u(t.targetNode,"data-id"),s=f(l?.getAttribute("data-id"));if(s&&s!==n){t.to=s;let i=p?U?.offsetHeight:M?.rowHeight;if(0===P||r.y>a+i-1){let t=l.getBoundingClientRect(),r=nq(U).y>t.y?-1:1,a=1===r?"after":"before",i=Math.abs(v.getRowIndex(n)-v.getRowIndex(s));if(1===i&&(-1===r&&e.clientY>eM.current||1===r&&e.clientY<eM.current))return;eM.current=e.clientY,v.exec("move-item",{id:n,target:s,mode:1!==i?"before"===a?"after":"before":a,inProgress:!0})}}i&&i({event:e,context:t})}!function(e,t,n,r){var l,a,i;let{node:s,left:o,top:c,bottom:u,sense:d,xScroll:h,yScroll:f}=r,m=nU(e,s);n.scrollState||(n.scrollState={dirX:0,dirY:0,scrollSpeedFactor:1});let p=0,x=0;m.x<o+d?p=-1:m.x>t.width-d&&(p=1),m.y<c+Math.round(d/2)?x=-1:m.y>t.height-u-Math.round(d/2)&&(x=1),(n.scrollState.dirX!==p||n.scrollState.dirY!==x)&&(nQ(n),n.scrollState.dirX=p,n.scrollState.dirY=x),(h&&0!==n.scrollState.dirX||f&&0!==n.scrollState.dirY)&&(l=n,a=r,i={x:n.scrollState.dirX,y:n.scrollState.dirY},l.autoScrollTimer||(l.autoScrollTimer=setTimeout(()=>{l.activeAutoScroll=setInterval(nX,15,l,a,i)},250)))}(e,l,t,eN)},end:function(e,t){let{from:n,to:r}=t;v.exec("move-item",{id:n,target:r,inProgress:!1}),ej.current=setTimeout(()=>{ej.current=0},1),q(null),Q(null),eM.current=null,nQ(t)},getReorder:()=>a,getDraggableInfo:()=>({hasDraggable:eC()})}),(0,c.useEffect)(()=>{let e=G.current;return e?function(e,t){let n=t.current,r=null,l,a,i=!1,s=!1,o=document.createElement("DIV");function c(){clearTimeout(l),l=null}function d(t){let n=u(t);n&&(a=(r={container:o,sourceNode:t.target,from:f(n.getAttribute("data-id")),pos:nU(t,e)}).pos,h(t))}function h(t){if(!r)return;let l=r.pos=nU(t,e);if(!i){if(!s&&!t?.target?.getAttribute("draggable-data")&&5>Math.abs(a.x-l.x)&&5>Math.abs(a.y-l.y))return;if(!1===function(t){if(i=!0,n.start){if(!1===n.start(t,r))return!1;e.appendChild(o),document.body.style.cursor="move"}}(t))return S()}if(s){let e=window.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft,n=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop;r.targetNode=document.elementFromPoint(t.pageX-e,t.pageY-n)}else r.targetNode=t.target;n.move&&n.move(t,r),o.style.left=-(r.offset?r.offset.x:0)+"px",o.style.top=r.pos.y+(r.offset?r.offset.y:0)+"px"}function m(e){o.parentNode&&o.parentNode.removeChild(o),o.innerHTML="",i&&n.end&&n.end(e,r),r=a=null,S()}function p(e){n.getReorder&&!n.getReorder()||0===e.button&&(k(e),window.addEventListener("mousemove",x),window.addEventListener("mouseup",g),d(e))}function x(e){h(e)}function g(e){m(e)}function w(t){(!n.getReorder||n.getReorder())&&(l=setTimeout(()=>{s=!0,d(t.touches[0])},700),k(t),t.target.addEventListener("touchmove",y),t.target.addEventListener("touchend",function e(){l&&c(),t.target.removeEventListener("touchmove",y),t.target.removeEventListener("touchend",e),m(t)}),e.addEventListener("contextmenu",v))}function y(e){i?(e.preventDefault(),h(e.touches[0])):l&&c()}function v(e){if(i||l)return e.preventDefault(),!1}function b(e){e.preventDefault()}function k(e){if(!n.getDraggableInfo)return;let{hasDraggable:t}=n.getDraggableInfo();(!t||e.target.getAttribute("draggable-data"))&&(document.body.style.userSelect="none",document.body.style.webkitUserSelect="none")}function S(t){i=s=!1,document.body.style.cursor="",document.body.style.userSelect="",document.body.style.webkitUserSelect="",window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",g),t&&(e.removeEventListener("mousedown",p),e.removeEventListener("touchstart",w),e.removeEventListener("dragstart",b))}return o.className="wx-drag-zone",o.setAttribute("tabindex",-1),e.addEventListener("mousedown",p),e.addEventListener("touchstart",w),e.addEventListener("dragstart",b),{destroy(){S(!0)}}}(e,eA).destroy:void 0},[a,G.current]),(0,c.useEffect)(()=>{var e;let t=G.current;return t?nR(t,{keys:{tab:!0,"shift+tab":!0,arrowup:!0,arrowdown:!0,arrowright:!0,arrowleft:!0,enter:!0,escape:!0,f2:!0,home:!0,end:!0,"ctrl+home":!0,"ctrl+end":!0,"ctrl+z":(e={undo:A}).undo,"ctrl+y":e.undo},exec:e=>v.exec("hotkey",e)}).destroy:void 0},[v,A]);let eI=(0,c.useRef)({scroll:v.getReactiveState().scroll});eI.current.getWidth=()=>(g||0)-(ep?I:0),eI.current.getHeight=()=>ei,eI.current.getScrollMargin=()=>X.width+J.width,(0,c.useEffect)(()=>{var e,t;let n;e=eR.current,t=eI.current,n=null,t.scroll.subscribe(r=>{if(!r||r===n)return;n=r;let{left:l,top:a,height:i,width:s}=r,o=t.getHeight(),c=t.getWidth(),u=t.getScrollMargin();if(a>=0){let t=e.scrollTop;a<t?e.scrollTop=a:a+i>t+o&&(e.scrollTop=a-o+i)}if(l>=0){let t=e.scrollLeft;l<t?e.scrollLeft=l:l+s>t+c-u&&(e.scrollLeft=l-c+s+u)}})},[]);let eH=(0,c.useRef)(null);(0,c.useEffect)(()=>{var e;let t,n=eH.current;if(!n)return;let r=[];return r.push(C(n,()=>v.exec("focus-cell",{eventSource:"click"})).destroy),r.push((t=[V(n,e=e_.current,"click")],e.dblclick&&t.push(V(n,e.dblclick,"dblclick")),()=>{t.forEach(e=>e())})),()=>r.forEach(e=>e())},[]);let eF=`wx-grid ${y?`wx-responsive-${y}`:""}`;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"wx-4VuBwK2D "+eF,style:{"--header-height":`${er}px`,"--footer-height":`${el}px`,"--split-left-width":`${X.width}px`,"--split-right-width":`${J.width}px`},children:(0,o.jsx)("div",{ref:G,className:"wx-4VuBwK2D wx-table-box",style:eE,role:$?"treegrid":"grid","aria-colcount":en.data.length,"aria-rowcount":ey.length,"aria-multiselectable":!!$&&!!l||void 0,tabIndex:-1,children:(0,o.jsxs)("div",{ref:eR,className:"wx-4VuBwK2D wx-scroll",style:{overflowX:ea?"scroll":"hidden",overflowY:ep?"scroll":"hidden"},onScroll:ek,children:[t?(0,o.jsx)("div",{className:"wx-4VuBwK2D wx-header-wrapper",children:(0,o.jsx)(n6,{contentWidth:ex,deltaLeft:en.dh,columns:en.header,columnStyle:h,bodyHeight:ei-n})}):null,(0,o.jsxs)("div",{ref:eH,className:"wx-4VuBwK2D wx-body",style:{width:`${ex}px`,height:`${em}px`},onMouseDown:e=>eS(e),children:[r?(0,o.jsx)(n7,{overlay:r}):null,(0,o.jsx)("div",{ref:eT,className:"wx-4VuBwK2D wx-data",style:{paddingTop:`${ef.d}px`,paddingLeft:`${en.d}px`},children:ey.map((e,t)=>{let n=-1!==_.indexOf(e.id),r=K===e.id,l="wx-row"+(p?" wx-autoheight":"")+(s?" "+s(e):"")+(n?" wx-selected":"")+(r?" wx-inactive":""),i=p?{minHeight:`${B}px`}:{height:`${B}px`};return(0,o.jsx)("div",{className:"wx-4VuBwK2D "+l,"data-id":e.id,"data-context-id":e.id,style:i,role:"row","aria-rowindex":t,"aria-expanded":e.open,"aria-level":$?e.$level+1:void 0,"aria-selected":$?n:void 0,tabIndex:-1,children:en.data.map(t=>t.collapsed?(0,o.jsx)("div",{className:"wx-4VuBwK2D wx-cell wx-collapsed"},t.id):T?.id===e.id&&T.column==t.id?(0,o.jsx)(n9,{row:e,column:t},t.id):(0,o.jsx)(n0,{row:e,column:t,columnStyle:h,cellStyle:m,reorder:a,focusable:e$?.row===e.id&&e$?.column==t.id},t.id))},e.id)})})]}),n&&(S||[]).length?(0,o.jsx)(n6,{type:"footer",contentWidth:ex,deltaLeft:en.df,columns:en.footer,columnStyle:h}):null]})})}),R?(0,o.jsx)(rn,{config:R,rowStyle:s,columnStyle:h,cellStyle:m,header:t,footer:n,reorder:a}):null]})}let rl=(0,c.forwardRef)(function({data:e=[],columns:t=[],rowStyle:n=null,columnStyle:r=null,cellStyle:l=null,selectedRows:a,select:i=!0,multiselect:s=!1,header:u=!0,footer:d=!1,dynamic:h=null,overlay:f=null,reorder:m=!1,onReorder:p=null,autoRowHeight:x=!1,sizes:g,split:w,tree:y=!1,autoConfig:v=!1,init:b=null,responsive:k=null,sortMarks:S,undo:C=!1,...j},M){let _=(0,c.useRef)();_.current=j;let N=(0,c.useMemo)(()=>new nT(B),[]),E=(0,c.useMemo)(()=>N.in,[N]),T=(0,c.useRef)(null);null===T.current&&(T.current=new eI((e,t)=>{let n="on"+e.split("-").map(e=>e?e.charAt(0).toUpperCase()+e.slice(1):"").join("");_.current&&_.current[n]&&_.current[n](t)}),E.setNext(T.current));let $=(0,c.useMemo)(()=>({getState:N.getState.bind(N),getReactiveState:N.getReactive.bind(N),getStores:()=>({data:N}),exec:E.exec,setNext:e=>(T.current=T.current.setNext(e),T.current),intercept:E.intercept.bind(E),on:E.on.bind(E),detach:E.detach.bind(E),getRow:N.getRow.bind(N),getRowIndex:N.getRowIndex.bind(N),getColumn:N.getColumn.bind(N)}),[N,E]),[D,R]=(0,c.useState)(0),[A,I]=(0,c.useState)(0),[H,F]=(0,c.useState)(null),[L,z]=(0,c.useState)(null),P=(0,c.useMemo)(()=>{if(v&&!t.length&&e.length){let t=e[0],n=[];for(let e in t)if("id"!==e&&"$"!==e[0]){let t={id:e,header:e[0].toUpperCase()+e.slice(1)};"object"==typeof v&&(t={...t,...v}),n.push(t)}return n}return(L&&L.columns)??t},[v,t,e,L]),W=(0,c.useMemo)(()=>(L&&L.sizes)??g,[L,g]),O=(0,c.useCallback)(e=>{if(R(e.width),I(e.height),k){let t=Object.keys(k).map(Number).sort((e,t)=>e-t).find(t=>e.width<=t)??null;t!==H&&(z(k[t]),F(t))}},[k,H]),Y=(0,c.useMemo)(()=>{let e=!y;return e=!0,!!e&&m},[y,m]),V=(0,c.useContext)(Z.theme),G=(0,c.useRef)(0);return(0,c.useEffect)(()=>{if(G.current){let t=N.getState();N.init({data:e,columns:P,split:w||t.split,sizes:W||t.sizes,selectedRows:a||t.selectedRows,dynamic:h,tree:y,sortMarks:S||t.sortMarks,undo:C,_skin:V,_select:i})}else b&&b($);G.current++},[N,e,P,w,W,a,h,y,S,C,V,i,b,$]),0===G.current&&N.init({data:e,columns:P,split:w||{left:0},sizes:W||{},selectedRows:a||[],dynamic:h,tree:y,sortMarks:S||{},undo:C,_skin:V,select:i}),(0,c.useImperativeHandle)(M,()=>({...$}),[$]),(0,o.jsx)(nK.Provider,{value:$,children:(0,o.jsx)(eu,{words:nA,optional:!0,children:(0,o.jsx)(rr,{header:u,footer:d,overlay:f,rowStyle:n,columnStyle:r,cellStyle:l,reorder:Y,onReorder:p,multiselect:s,autoRowHeight:x,clientWidth:D,clientHeight:A,responsiveLevel:H,resize:O})})})});p({addEvent:function(e,t,n,r={}){var l=function(e,t,n,r={}){function l(e){if(r.capture||nG.call(t,e),!e.cancelBubble)return n?.call(this,e)}if(e.startsWith("pointer")||e.startsWith("touch")||"wheel"===e){if(0===nV.length){var a=nV;queueMicrotask(()=>{a===nV&&function(){var e=nV;nV=[];for(var t=0;t<e.length;t++)e[t]()}()})}nV.push(()=>{t.addEventListener(e,l,r)})}else t.addEventListener(e,l,r);return l}(t,e,n,r);return()=>{e.removeEventListener(t,l,r)}}});let ra={};function ri({menu:e=!1}){return(0,o.jsx)("div",{className:`wx-z1qpqrvg wx-separator${e?"-menu":""}`,children:"Â "})}function rs(){return(0,o.jsx)("div",{className:"wx-1IhFzpJV wx-spacer"})}function ro(e){let{item:t={},menu:n=!1,values:r,onClick:l,onChange:a}=e,i=(0,c.useMemo)(()=>{var e;return ra[e=t.comp||"label"]||e},[t]),s=(0,c.useCallback)(()=>{t&&t.handler&&t.handler(t),l&&l({item:t})},[t,l]),u=(0,c.useMemo)(()=>t&&t.key&&r?r[t.key]:void 0,[t,r]),d=(0,c.useCallback)(({value:e})=>{t&&t.handler&&t.handler(t,e),a&&a({value:e,item:t})},[t,a]),h=(0,c.useMemo)(()=>n?t?t.menuText||t.text:void 0:t?t.text:void 0,[n,t]);if(t&&"spacer"==t.comp)return(0,o.jsx)(rs,{});if(t&&"separator"==t.comp)return(0,o.jsx)(ri,{menu:n});{let e=["wx-tb-element",t&&t.css?t.css:"",t&&t.spacer?"wx-spacer":"",n?"wx-menu":""].filter(Boolean).join(" ");return(0,o.jsx)("div",{className:"wx-KVAsgMam "+e,"data-id":t?t.id:void 0,children:(0,o.jsx)(i,{value:u,onChange:d,onClick:s,text:h,menu:n,...(({key:e,text:t,...n})=>n)(t)})})}}function rc({item:e,values:t=null,menu:n=!1,onChange:r,onClick:l}){let[a,i]=(0,c.useState)(!0),s=()=>i(!0),u=e=>{s(),l&&l(e)},d=["wx-wSVFAGym","wx-tb-group",e.css||"","column"==e.layout?"wx-column":"",e.collapsed&&!n?"wx-group-collapsed":""].filter(Boolean).join(" ");return(0,o.jsx)("div",{className:d,children:e.collapsed&&!n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"wx-wSVFAGym wx-collapsed",onClick:()=>i(!1),children:[e.icon?(0,o.jsx)("i",{className:`wx-wSVFAGym icon ${e.icon}`}):null,e.text?(0,o.jsx)("div",{className:"wx-wSVFAGym wx-label-text",children:e.text}):null,e.text&&!e.icon?(0,o.jsx)("i",{className:"wx-wSVFAGym wx-label-arrow wxi-angle-down"}):null]}),a?null:(0,o.jsx)(U,{width:"",oncancel:s,children:(0,o.jsx)("div",{className:"wx-wSVFAGym wx-drop-group",children:(0,o.jsx)(rc,{item:{...e,text:"",collapsed:!1},values:t,menu:n,onChange:r,onClick:u})})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"wx-wSVFAGym wx-tb-body",children:e.items.map((e,n)=>e.items?(0,o.jsx)(rc,{item:e,values:t,onClick:u,onChange:r},e.id||n):(0,o.jsx)(ro,{item:e,values:t,onClick:u,onChange:r},e.id||n))}),e.text?(0,o.jsx)("div",{className:"wx-wSVFAGym wx-label",children:e.text}):null]})})}function ru({items:e=[],css:t,values:n,width:r,onClick:l,onChange:a}){let[i,s]=(0,c.useState)(void 0),u=(0,c.useRef)(null);function d(){s(null)}function h(e){d(),l&&l(e)}return(0,o.jsxs)("div",{className:`wx-Yo6BuX0p wx-menu ${t||""}`,ref:u,"data-id":"$menu",children:[(0,o.jsx)(q,{icon:"wxi-dots-h",onClick:function(){s(!0)}}),i?(0,o.jsx)(U,{width:`${r}px`,onCancel:d,children:(0,o.jsx)("div",{className:"wx-Yo6BuX0p wx-drop-menu",children:e.map((e,t)=>e.items?(0,o.jsx)(rc,{item:e,values:n,menu:!0,onClick:h,onChange:a},e.id||t):(0,o.jsx)(ro,{item:e,values:n,menu:!0,onClick:h,onChange:a},e.id||t))})}):null]})}function rd(e){let{items:t,menuCss:n="",css:r="",values:l,overflow:a="menu",onClick:i,onChange:s}=e,[u,d]=L(t||[]),[h,f]=L(l||null),m=(0,c.useMemo)(()=>(u.forEach(e=>{e.id||(e.id=E())}),u),[u]),p=(0,c.useRef)(null),x=(0,c.useRef)(-1),[g,w]=(0,c.useState)([]),y=(0,c.useRef)(m);(0,c.useEffect)(()=>{y.current=m},[u]);let v=(0,c.useRef)(a);(0,c.useEffect)(()=>{v.current=a},[a]);let b=(0,c.useRef)(g);(0,c.useEffect)(()=>{b.current=g},[g]);let k=(0,c.useRef)(!1);function S(e){h&&(h[e.item.key]=e.value,f({...h})),s&&s(e)}function C(){let e=p.current;if(!e)return;let t=y.current||[],n=v.current;if("wrap"===n)return;let r=e.clientWidth;if(e.scrollWidth>r){if("collapse"===n){let e=p.current,t=y.current||[];if(e){for(let n=t.length-1;n>=0;n--)if(t[n].items&&!t[n].collapsed){t[n].collapsed=!0,t[n].$width=e.children[n].offsetWidth,k.current=!0,d([...t]);break}}return}let l=e.children,a=0;for(let e=0;e<t.length;e++){if(a+=l[e].clientWidth,"separator"===t[e].comp&&(a+=8),a>r-40){if(x.current===e)return;x.current=e;let n=[];for(let r=e;r<t.length;r++)n.push(t[r]),l[r].style.visibility="hidden";e>0&&"separator"===t[e-1].comp&&(l[e-1].style.visibility="hidden"),w(n);break}l[e].style.visibility=""}}else{let l=r-function(){let e=p.current;if(!e)return 0;let t=e.children,n=y.current||[],r=0;for(let e=0;e<n.length;e++)"spacer"!==n[e].comp&&(r+=t[e].clientWidth,"separator"===n[e].comp&&(r+=8));return r}();if(l<=0)return;if("collapse"===n){let e=p.current,t=y.current||[];if(e){for(let n=0;n<t.length;n++)if(t[n].collapsed&&t[n].$width){t[n].$width-e.children[n].offsetWidth<l+10&&(t[n].collapsed=!1,k.current=!0),d([...t]);break}}return}if((b.current||[]).length){x.current=null;let n=e.children;for(let e=0;e<t.length;e++)n[e].style.visibility="";w([])}}}return(0,c.useEffect)(()=>{k.current&&(k.current=!1,C())},[u]),(0,c.useEffect)(()=>{let e=new ResizeObserver(()=>C());return p.current&&e.observe(p.current),()=>{e.disconnect()}},[]),(0,o.jsxs)("div",{className:`wx-VdPSJj8y wx-toolbar ${r||""} ${"wrap"===a?"wx-wrap":""}`,ref:p,children:[m.map(e=>e.items?(0,o.jsx)(rc,{item:e,values:h,onClick:i,onChange:S},e.id):(0,o.jsx)(ro,{item:e,values:h,onClick:i,onChange:S},e.id)),!!g.length&&(0,o.jsx)(ru,{items:g,css:n,values:h,onClick:i,onChange:S})]})}ra.button=function(e){let{icon:t,text:n="",css:r,type:l,disabled:a,menu:i,onClick:s}=e;return i?(0,o.jsxs)("div",{className:"wx-HXpG4gnx wx-item",onClick:s,children:[(0,o.jsx)("i",{className:`wx-HXpG4gnx ${t||"wxi-empty"} ${r||""}`}),n]}):(0,o.jsx)(q,{icon:t,type:l,css:r,text:n,disabled:a,onClick:s})},ra.separator=ri,ra.spacer=rs,ra.label=function(e){let{text:t,value:n,children:r}=e;return r?(0,o.jsx)("div",{className:"wx-PTEZGYcj wx-label",children:r()}):(0,o.jsx)("div",{className:"wx-PTEZGYcj wx-label",children:n||t})},ra.item=function({id:e="",text:t="",css:n="",icon:r="",onClick:l}){return(0,o.jsxs)("div",{className:`wx-U0Bx7pIR wx-label ${n}`,onClick:function(){l&&l({id:e})},children:[r?(0,o.jsx)("i",{className:"wx-U0Bx7pIR "+r}):null,t]})},ra.icon=function(e){let{icon:t,text:n,css:r,type:l,disabled:a,menu:i,onClick:s}=e;return i?(0,o.jsxs)("div",{className:"wx-3cuSqONJ wx-item",onClick:s,children:[t?(0,o.jsx)("i",{className:`wx-3cuSqONJ ${t||""} ${r||""}`}):null,n]}):(0,o.jsx)(q,{icon:t,type:l,css:r,title:n,disabled:a,onClick:s})};let rh={};function rf(e){return"u">typeof e?rh[e]||e:rh.text}let rm={editor:{}};function rp(e){let{editors:t,data:n,css:r="",errors:l,focus:a=!1,onClick:i,children:s,onChange:u}=e,d=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(a){let e=document.activeElement;if(e&&d.current&&d.current.contains(e))return;let t=d.current?d.current.querySelector("input:not([disabled]), textarea:not([disabled]), select:not([disabled])"):null;t&&setTimeout(()=>{"function"==typeof t.select&&t.select(),"function"==typeof t.focus&&t.focus()},300)}},[]);let h=(0,c.useContext)(Z.i18n),f=(0,c.useMemo)(()=>h.getGroup("editor"),[h]),m=(0,c.useMemo)(()=>"readonly"===t.config[0].comp&&t.config.every(e=>!Object.keys(n).includes(e.key)),[t,n]);return(0,o.jsxs)("div",{className:"wx-s2aE1xdZ wx-sections "+r,ref:d,children:[s,m?(0,o.jsx)("div",{className:"wx-s2aE1xdZ wx-overlay",children:f("No data")}):null,t.config.map(e=>{if(!e.hidden){let{key:t,onChange:r,...a}=e;if("readonly"===e.comp||"section"===e.comp){let r=rf(e.comp);return(0,o.jsx)(r,{fieldKey:t,label:e.label,value:n[t],...a,onClick:i},t)}{let i=rf(e.comp);return(0,o.jsxs)("div",{children:[(0,o.jsx)(ek,{label:e.labelTemplate?e.labelTemplate(n[t]):e.label??"",required:e.required,children:({id:e})=>(0,o.jsx)(i,{fieldKey:t,...a,onChange:r||(e=>{u&&u({value:e.value,key:t,input:e.input})}),id:e,label:void 0,error:l&&l[t],value:n[t]},t)}),l&&l[t]&&e.validationMessage?(0,o.jsx)("div",{className:"wx-s2aE1xdZ wx-message",children:e.validationMessage}):null]},t)}}return null})]})}function rx({values:e,items:t,css:n,activeBatch:r,autoSave:l,focus:a,readonly:i,topBar:s=!0,bottomBar:u=!0,layout:d="default",placement:h="inline",view:f,children:m,onChange:p,onSave:x,onAction:g,onValidation:w}){let y=(0,c.useContext)(Z.i18n).getGroup("editor"),[v,b]=L(e),[k,S]=(0,c.useState)(null),C=(0,c.useMemo)(()=>{let e,n,l=(e=t.map(e=>{let t={...e};return e.config&&Object.assign(t,e.config),t.key=e.key||eD++,t.setter=e.setter||function(e){if("string"==typeof e&&e.includes(".")){let t=e.split(".");return(e,n)=>{let r=e;t.forEach((e,l)=>{l===t.length-1?r[e]=n:r=r[e]})}}return(t,n)=>t[e]=n}(e.key),t.getter=e.getter||function(e){if("string"==typeof e&&e.includes(".")){let t=e.split(".");return e=>{let n=e;return t.forEach(e=>{n=n[e]}),n}}return t=>t[e]}(e.key),t}),n=t=>{let n={};return e.forEach(e=>{"section"!==e.comp&&(e.getter?n[e.key]=e.getter(t):n[e.key]=t[e.key])}),n},{config:e.filter(e=>"hidden"!==e.comp),getValues:n,setValues:(t,n,r)=>((r.length?r.map(t=>e.find(e=>e.key===t)):e).forEach(e=>{e.setter?e.setter(t,n[e.key]):t[e.key]=n[e.key]}),t),diff:(t,r)=>{let l=n(t),a=[];return e.forEach(e=>{let t=l[e.key],n=r[e.key];!eR(t,n)&&(void 0!==t||n)&&a.push(e.key)}),a},validateValues:(t,n,r)=>{let l=0,a={};return(n?.length?n.map(t=>e.find(e=>e.key===t)):e).forEach(e=>{e.required&&!t[e.key]?(a[e.key]={errorType:"required"},e.validationMessage=e.validationMessage??r("This field is required"),l++):e.validation&&!e.validation(t[e.key])&&(a[e.key]={errorType:"validation"},e.validationMessage=e.validationMessage??r("Invalid value"),l++)}),l>0?a:null}});k&&l.config.forEach(e=>{"section"===e.comp&&e.key===k&&("accordion"===e.sectionMode?e.activeSection||(l.config.forEach(t=>{"section"===t.comp&&t.key!==e.key&&(t.activeSection=!1)}),e.activeSection=!0):e.activeSection=!e.activeSection)});let a=new Set,s=null;return l.config.forEach(e=>{"exclusive"===e.sectionMode&&e.activeSection&&(s=e.key),e.activeSection&&a.add(e.key)}),l.config.forEach(e=>{e.hidden=e.hidden||r&&r!==e.batch||s&&e.key!=s&&e.section!==s||e.section&&!a.has(e.section)}),i?{...l,config:l.config.map(e=>({...e,comp:"readonly"})),diff:()=>[]}:l},[t,k,r,i]),[j,M]=(0,c.useState)({}),[_,N]=(0,c.useState)({});(0,c.useEffect)(()=>{void 0!==v&&(M(eA(v)),N(eA(v)))},[v]);let[E,T]=(0,c.useState)([]);function $(e){return[...new Set(e)]}function D(e){let t=C.validateValues(j,e,y);return eR(t,v.errors)||w&&w({errors:t,values:j}),t}function R({item:e}){"save"===e.id?E.length&&(l||(v.errors=D()),!v.errors)&&(x&&x({changes:E,values:j}),b(C.setValues(v,_,E)),T([]),b({...j})):"toggle-section"===e.id&&S(e.key),g&&g({item:e,values:j,changes:E})}return(0,c.useEffect)(()=>{v&&T([])},[v]),(0,o.jsx)(f,{topBar:s,bottomBar:u,placement:h,layout:d,readonly:i,autoSave:l,css:n,data:_,editors:C,focus:a,errors:v.errors,onClick:R,onKeyDown:R,onChange:function({value:e,key:t,input:n}){let r={..._||{},[t]:e},a={key:t,value:e,update:r};if(n&&(a.input=n),p&&p(a),!v)return;N(r=a.update);let i=C.diff(v,r);if(M(C.setValues({...j||{}},r,$([...i,t]))),i.length){let e=l?[]:$([...i,...Object.keys(v.errors??{}),t]);v.errors=D(e),function(e,t){if(l&&!v.errors){let n=C.setValues(v,t??_,e);b(n),x&&x({changes:e,values:n})}else T(e)}(i,r)}else{let e=Object.keys(v.errors??{});e.length&&(v.errors=D(e)),T([])}},children:m})}function rg(e){let{editors:t,data:n,layout:r,errors:l,focus:a,onClick:i,onChange:s}=e,u=(0,c.useMemo)(()=>{let e=[];if("columns"===r&&(e=[{...t,config:[]},{...t,config:[]}],t.config.forEach(t=>{e[+("left"!==t.column)].config.push(t)}),e[0].config.length)){let t=e[0].config[0];"text"===t.comp&&(e[0][0]={...t,css:"title",label:""})}return e},[r,t]);return"columns"===r?(0,o.jsxs)("div",{className:"wx-bNrSbszs wx-cols",children:[(0,o.jsx)("div",{className:"wx-bNrSbszs wx-left",children:(0,o.jsx)(rp,{editors:u[0],data:n,errors:l,onClick:i,onChange:s})}),(0,o.jsx)("div",{className:"wx-bNrSbszs wx-right",children:(0,o.jsx)(rp,{editors:u[1],data:n,focus:a,errors:l,onClick:i,onChange:s})})]}):(0,o.jsx)(rp,{editors:t,data:n,focus:a,errors:l,onClick:i,onChange:s})}function rw({items:e,values:t=null,top:n=!0,onClick:r,onChange:l}){let a=(0,c.useCallback)(({item:e,value:t})=>{l&&l({key:e.key,value:t})},[l]);return e.length?(0,o.jsx)("div",{className:`wx-66OW1j0R wx-editor-toolbar ${n?"wx-topbar":"wx-bottom"}`,children:(0,o.jsx)(rd,{items:e,values:t,onClick:r,onChange:a})}):null}let ry=()=>({comp:"spacer"}),rv=e=>({comp:"button",text:e("Cancel"),id:"cancel"}),rb=e=>({type:"primary",comp:"button",text:e("Save"),id:"save"}),rk=()=>({comp:"icon",icon:"wxi-close",id:"close"});function rS(e){let{data:t,editors:n,focus:r,css:l,topBar:a,bottomBar:i,layout:s,placement:u,errors:d,readonly:h,autoSave:f,children:m,onClick:p,onKeyDown:x,onChange:g}=e,w=(0,c.useContext)(Z.i18n),y=(0,c.useMemo)(()=>w.getGroup("editor"),[w]),v=(0,c.useMemo)(()=>!0===a&&!0===i,[a,i]),b=(0,c.useMemo)(()=>{let e=a&&a.items?a.items.map(e=>({...e})):[];return v&&(h?e=[ry(),rk()]:(f?e=[ry(),rk()]:"modal"!==u&&(e=[ry(),rv(y),rb(y)]),"columns"!==s||e.length||(e=[ry(),rb(y),rv(y)]))),e},[a,v,h,f,u,s,y]),k=(0,c.useMemo)(()=>{let e=i&&i.items?i.items.map(e=>({...e})):[];return v&&(h||("modal"!==u||f||(e=[ry(),rb(y),rv(y)]),"columns"===s&&b.length&&(e=[]))),e},[i,v,h,u,f,s,b,y]),S=(0,c.useMemo)(()=>[...b,...k],[b,k]),C=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=C.current;if(!e)return;let t=function(e,{keys:t,action:n}){function r(e){let r=e.code.replace("Key","").toLowerCase(),l=t[`${e.ctrlKey||e.metaKey?"ctrl+":""}${r}`];if(!l)return;let a=e.target.closest(".wx-combo")||e.target.closest(".wx-multicombo")||e.target.closest(".wx-richselect");a&&a.querySelector(".wx-list")||(e.preventDefault(),n(l))}return e.addEventListener("keydown",r),{destroy:()=>{e.removeEventListener("keydown",r)}}}(e,{keys:{"ctrl+s":S.find(e=>"save"===e.id),escape:S.find(e=>"cancel"===e.id||"close"===e.id),"ctrl+d":S.find(e=>"delete"===e.id)},action:e=>{x&&x({item:e})}});return()=>{"function"==typeof t&&t()}},[S,x]),(0,o.jsxs)("div",{className:l?"wx-85HDaNoA "+l:"wx-85HDaNoA",ref:C,children:[(0,o.jsx)(rw,{...a&&"object"==typeof a?a:{},items:b,values:t,onClick:p,onChange:g}),(0,o.jsxs)("div",{className:`wx-85HDaNoA wx-content${"columns"===s?" wx-layout-columns":""}`,children:[m,(0,o.jsx)(rg,{editors:n,layout:s,data:t,focus:r,errors:d,onClick:p,onChange:g}),(0,o.jsx)(rw,{...i&&"object"==typeof i?i:{},items:k,values:t,top:!1,onClick:p,onChange:g})]})]})}function rC(e){let{css:t,onClick:n,placement:r,...l}=e;return"modal"===r?(0,o.jsx)(eM,{children:(0,o.jsx)(rS,{css:`wx-panel ${t}`,onClick:n,placement:r,...l})}):"sidebar"===r?(0,o.jsx)(e_,{onCancel:function(){n&&n({item:{id:"close"}})},children:(0,o.jsx)(rS,{css:`wx-panel ${t}`,onClick:n,placement:r,...l})}):(0,o.jsx)(rS,{css:`wx-inline-form ${t}`,onClick:n,placement:r,...l})}function rj(e){let{values:t={},items:n=[],css:r="",activeBatch:l=null,topBar:a=!0,bottomBar:i=!0,focus:s=!1,autoSave:c=!1,layout:u="default",readonly:d=!1,placement:h="inline",children:f,...m}=e,p=Object.keys(m).reduce((e,t)=>{if(/^on[a-z]/.test(t)){let n="on"+t.charAt(2).toUpperCase()+t.slice(3);n in m?e[t]=m[t]:e[n]=m[t]}else e[t]=m[t];return e},{});return(0,o.jsx)(eu,{words:rm,optional:!0,children:(0,o.jsx)(rx,{view:rC,values:t,items:n,css:r,activeBatch:l,topBar:a,bottomBar:i,focus:s,autoSave:c,layout:u,readonly:d,placement:h,...p,children:f})})}rh.text=en,rh.textarea=function({value:e="",id:t=E(),placeholder:n="",title:r="",disabled:l=!1,error:a=!1,readonly:i=!1,onChange:s}){let[u,d]=L(e),h=(0,c.useCallback)(e=>{let t=e.target.value;d(t),s&&s({value:t,input:!0})},[s]),f=(0,c.useCallback)(e=>{let t=e.target.value;d(t),s&&s({value:t})},[s]),m=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=m.current;return e.addEventListener("change",f),()=>{e&&e.removeEventListener("change",f)}},[f]),(0,o.jsx)("textarea",{className:`wx-3yFVAC wx-textarea ${a?"wx-error":""}`,id:t,disabled:l,placeholder:n,readOnly:i,title:r,value:u,onInput:h,ref:m})},rh.checkbox=function({id:e=E(),label:t="",inputValue:n="",value:r=!1,onChange:l,disabled:a=!1}){let[i,s]=L(r);return(0,o.jsxs)("div",{className:"wx-2IvefP wx-checkbox",children:[(0,o.jsx)("input",{type:"checkbox",id:e,disabled:a,className:"wx-2IvefP wx-check",checked:i,value:n,onChange:({target:e})=>{let t=e.checked;s(t),l&&l({value:t,inputValue:n})}}),(0,o.jsxs)("label",{htmlFor:e,className:"wx-2IvefP wx-label",children:[(0,o.jsx)("span",{className:"wx-2IvefP wx-before"}),t&&(0,o.jsx)("span",{className:"wx-2IvefP wx-after",children:t})]})]})},rh.readonly=function({value:e,options:t,label:n}){let r=(0,c.useContext)(Z.i18n).getGroup("editor"),l=(0,c.useMemo)(()=>{let n=e;if("boolean"==typeof e&&(n=r(e?"Yes":"No")),t){let r=t.find(t=>t.id===e);r&&(n=r.label)}return n},[e,t,r]);return l||0===l?(0,o.jsx)(ek,{label:n,children:l}):null},rh.section=function({fieldKey:e,label:t,activeSection:n,onClick:r}){return(0,o.jsxs)("div",{className:`wx-OmgQq65I wx-section${n?" wx-section-active":""}`,onClick:()=>r&&r({item:{id:"toggle-section",key:n?null:e}}),children:[(0,o.jsx)("h3",{children:t}),(0,o.jsx)("i",{className:`wx-OmgQq65I wxi-angle-${n?"down":"right"} wx-icon`})]})},p(m);let rM=(0,c.createContext)(null);function r_(e){let t=e.getAttribute("data-id"),n=parseInt(t);return isNaN(n)||n.toString()!=t?t:n}function rN(e){return e&&e.getAttribute("data-context-id")}function rE({row:e,column:t}){let n=t&&t._cell;return(0,o.jsxs)("div",{className:"wx-pqc08MHU wx-content",style:{justifyContent:t.align,paddingLeft:`${(e.$level-1)*20}px`},children:[e.data||e.lazy?(0,o.jsx)("i",{className:`wx-pqc08MHU wx-toggle-icon wxi-menu-${e.open?"down":"right"}`,"data-action":"open-task"}):(0,o.jsx)("i",{className:"wx-pqc08MHU wx-toggle-placeholder"}),(0,o.jsx)("div",{className:"wx-pqc08MHU wx-text",children:n?(0,o.jsx)(n,{row:e,column:t}):e.text})]})}function rT({column:e,cell:t}){let n=(0,c.useMemo)(()=>e.id,[e?.id]);return t||"add-task"==e.id?(0,o.jsx)("div",{style:{textAlign:e.align},children:(0,o.jsx)("i",{className:"wx-9DAESAHW wx-action-icon wxi-plus","data-action":n})}):null}function r$(e){let{readonly:t,compactMode:n,width:r=0,display:l="all",columnWidth:a=0,onTableAPIChange:i}=e,[s,f]=L(a),[m,p]=(0,c.useState)(),x=(0,c.useContext)(Z.i18n),g=(0,c.useMemo)(()=>x.getGroup("gantt"),[x]),w=(0,c.useContext)(rM),y=z(w,"scrollTop"),v=z(w,"cellHeight"),b=z(w,"_scrollTask"),k=z(w,"_selected"),S=z(w,"area"),C=z(w,"_tasks"),j=z(w,"_scales"),M=z(w,"columns"),_=z(w,"_sort"),N=z(w,"durationUnit"),E=(0,c.useRef)(null),T=(0,c.useRef)(!0),[$,D]=(0,c.useState)(null),R=(0,c.useMemo)(()=>C&&S?C.slice(S.start,S.end):[],[C,S]),A=(0,c.useCallback)((e,t)=>{if("add-task"===t)w.exec(t,{target:e,task:{text:g("New Task")},mode:"child",show:!0});else if("open-task"===t){let n=R.find(t=>t.id===e);(n?.data||n?.lazy)&&w.exec(t,{id:e,mode:!n.open})}},[R]),I=(0,c.useCallback)(e=>{let t=h(e),n=e.target.dataset.action;n&&e.preventDefault(),t?"add-task"===n||"open-task"===n?A(t,n):w.exec("select-task",{id:t,toggle:e.ctrlKey||e.metaKey,range:e.shiftKey,show:!0}):"add-task"===n&&A(null,n)},[w,A]),H=(0,c.useRef)(null),F=(0,c.useRef)(null),[P,W]=(0,c.useState)(0),[O,Y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let e=F.current;if(!e||typeof ResizeObserver>"u")return;let t=()=>W(e.clientWidth);t();let n=new ResizeObserver(t);return n.observe(e),()=>n.disconnect()},[]);let B=(0,c.useRef)(null),V=(0,c.useCallback)(e=>{let t=e.id,{before:n,after:r}=e,l=e.onMove,a=n||r,i=n?"before":"after";if(l){if("after"===i){let e=w.getTask(a);e.data?.length&&e.open&&(i="before",a=e.data[0].id)}B.current={id:t,[i]:a}}else B.current=null;w.exec("move-task",{id:t,mode:i,target:a,inProgress:l})},[w]),G=(0,c.useMemo)(()=>S?.from??0,[S]),K=(0,c.useMemo)(()=>j?.height??0,[j]),q=(0,c.useMemo)(()=>n||"grid"===l?(s??0)>(P??0):(s??0)>(r??0),[n,l,s,r,P]),U=(0,c.useMemo)(()=>{let e={};return q&&"all"===l||"grid"===l&&q?e.width=s:"grid"===l&&(e.width="100%"),e},[q,l,s]),Q=(0,c.useMemo)(()=>$&&!R.find(e=>e.id===$.id)?[...R,$]:R,[R,$]),X=(0,c.useMemo)(()=>{let e=(M||[]).map(e=>{let t=(e={...e}).header;if("object"==typeof t){let n=t.text&&g(t.text);e.header={...t,text:n}}else e.header=g(t);return e}),r=e.findIndex(e=>"text"===e.id),l=e.findIndex(e=>"add-task"===e.id);if(-1!==r&&(e[r].cell&&(e[r]._cell=e[r].cell),e[r].cell=rE),-1!==l){e[l].cell=e[l].cell||rT;let r=e[l].header;if("object"!=typeof r&&(e[l].header={text:r}),e[l].header.cell=r.cell||rT,t)e.splice(l,1);else if(n){let[t]=e.splice(l,1);e.unshift(t)}}return e.length>0&&(e[e.length-1].resize=!1),e},[M,g,t,n]),J=(0,c.useMemo)(()=>"all"===l?`${r}px`:"grid"===l?"calc(100% - 4px)":X.find(e=>"add-task"===e.id)?"50px":"0",[l,r,X]),ee=(0,c.useMemo)(()=>{if(Q&&_?.length){let e={};return _.forEach(({key:t,order:n},r)=>{e[t]={order:n,..._.length>1&&{index:r}}}),e}return{}},[Q,_]),et=(0,c.useCallback)(()=>X.some(e=>e.flexgrow&&!e.hidden),[]),en=(0,c.useMemo)(()=>et(),[et,O]),er=(0,c.useMemo)(()=>{let e="chart"===l?X.filter(e=>"add-task"===e.id):X,t="all"===l?r:P;if(!en){let n=s,r=!1;if(X.some(e=>e.$width)){let e=0;n=X.reduce((t,n)=>(n.hidden||(e+=n.width,t+=n.$width||n.width),t),0),e>n&&n>t&&(r=!0)}if(r||n<t){let l=1;return r||(l=(t-50)/(n-50||1)),e.map(e=>("add-task"===e.id||e.hidden||(e.$width||(e.$width=e.width),e.width=e.$width*l),e))}}return e},[l,X,en,s,r,P]),el=(0,c.useCallback)(e=>{if(!et()){let t=er.reduce((t,n)=>(e&&n.$width&&(n.$width=n.width),t+(n.hidden?0:n.width)),0);t!==s&&f(t)}Y(!0),Y(!1)},[et,er,s,f]),ea=(0,c.useCallback)(()=>{1===X.filter(e=>e.flexgrow&&!e.hidden).length&&X.forEach(e=>{!e.$width||e.flexgrow||e.hidden||(e.width=e.$width)})},[]),ei=(0,c.useCallback)(e=>{if(!t){let t=h(e),n=d(e,"data-col-id");!(n&&X.find(e=>e.id==n))?.editor&&t&&w.exec("show-editor",{id:t})}},[w,t]),es=(0,c.useCallback)(()=>{T.current=!1},[]),eo=(0,c.useCallback)(e=>{T.current=!0,E.current=e.touches[0].clientY+(y??0)},[y]),ec=(0,c.useCallback)(e=>{if(T.current){let t=(E.current??0)-e.touches[0].clientY;return w.exec("scroll-chart",{top:t}),e.preventDefault(),!1}},[w]),eu=(0,c.useMemo)(()=>Array.isArray(k)?k.map(e=>e.id):[],[k]);(0,c.useEffect)(()=>{let e=()=>es();return window.addEventListener("touchend",e),()=>window.removeEventListener("touchend",e)},[es]);let ed=(0,c.useCallback)(()=>{if(H.current&&null!==Q){let e=H.current.querySelector(".wx-body");e&&(e.style.top=-((y??0)-(G??0))+"px")}F.current&&(F.current.scrollTop=0)},[Q,y,G]);(0,c.useEffect)(()=>{H.current&&ed()},[y,G,ed]),(0,c.useEffect)(()=>{let e=H.current;if(!e)return;let t=e.querySelector(".wx-table-box .wx-body");if(!t||typeof ResizeObserver>"u")return;let n=new ResizeObserver(()=>{ed()});return n.observe(t),()=>{n.disconnect()}},[er,U,l,J,Q,ed]),(0,c.useEffect)(()=>{if(!b||!m)return;let{id:e}=b,t=m.getState().focusCell;t&&t.row!==e&&H.current&&H.current.contains(document.activeElement)&&m.exec("focus-cell",{row:e,column:t.column})},[b,m]);let eh=(0,c.useCallback)(({id:e})=>{if(t)return!1;w.getTask(e).open&&w.exec("open-task",{id:e,mode:!1});let n=w.getState()._tasks.find(t=>t.id===e);if(D(n||null),!n)return!1},[w,t]),ef=(0,c.useCallback)(({id:e,top:t})=>{B.current?V({...B.current,onMove:!1}):w.exec("drag-task",{id:e,top:t+(G??0),inProgress:!1}),D(null)},[w,V,G]),em=(0,c.useCallback)(({id:e,top:t,detail:n})=>{n&&V({...n,onMove:!0}),w.exec("drag-task",{id:e,top:t+(G??0),inProgress:!0})},[w,V,G]);(0,c.useEffect)(()=>{let e=H.current;return e?function(e,t){let n,r,l,a,i,s,o,c,d;function h(r){let o,c;a=r.clientX,i=r.clientY,s={...(o=n.getBoundingClientRect(),c=e.querySelector(".wx-body").getBoundingClientRect(),{top:o.top-c.top,left:o.left-c.left,dt:o.bottom-r.clientY,db:r.clientY-o.top}),y:t.getTask(l).$y},document.body.style.userSelect="none"}function f(r){rN(n=u(r))&&(l=r_(n),d=setTimeout(()=>{c=!0,t&&t.touchStart&&t.touchStart(),h(r.touches[0])},500),e.addEventListener("touchmove",y),e.addEventListener("contextmenu",m),window.addEventListener("touchend",v))}function m(e){if(c||d)return e.preventDefault(),!1}function p(t){1===t.which&&rN(n=u(t))&&(l=r_(n),e.addEventListener("mousemove",w),window.addEventListener("mouseup",b),h(t))}function x(t){e.removeEventListener("mousemove",w),e.removeEventListener("touchmove",y),document.body.removeEventListener("mouseup",b),document.body.removeEventListener("touchend",v),document.body.style.userSelect="",t&&(e.removeEventListener("mousedown",p),e.removeEventListener("touchstart",f))}function g(e){let c=e.clientX-a,d=e.clientY-i;if(!r){if(5>Math.abs(c)&&5>Math.abs(d)||t&&t.start&&!1===t.start({id:l,e:e}))return;(r=n.cloneNode(!0)).style.pointerEvents="none",r.classList.add("wx-reorder-task"),r.style.position="absolute",r.style.left=s.left+"px",r.style.top=s.top+"px",n.style.visibility="hidden",n.parentNode.insertBefore(r,n)}if(r){let a=Math.round(Math.max(0,s.top+d));if(t&&t.move&&!1===t.move({id:l,top:a,detail:o}))return;let i=t.getTask(l),c=i.$y;if(!s.start&&s.y==c)return k();s.start=!0,s.y=i.$y-4,r.style.top=a+"px";let h=u(document.elementFromPoint(e.clientX,e.clientY));if(h&&h!==n){let t=r_(h),r=h.getBoundingClientRect(),a=r.top+r.height/2,i=e.clientY+s.db>a&&h.nextElementSibling!==n,c=e.clientY-s.dt<a&&h.previousElementSibling!==n;o?.after==t||o?.before==t?o=null:i?o={id:l,after:t}:c&&(o={id:l,before:t})}}}function w(e){g(e)}function y(e){c?(e.preventDefault(),g(e.touches[0])):d&&(clearTimeout(d),d=null)}function v(){c=null,d&&(clearTimeout(d),d=null),k()}function b(){k()}function k(){n&&(n.style.visibility=""),r&&(r.parentNode.removeChild(r),t&&t.end&&t.end({id:l,top:s.top})),l=n=r=s=o=null,x()}return"absolute"!==e.style.position&&(e.style.position="relative"),e.addEventListener("mousedown",p),e.addEventListener("touchstart",f),{destroy(){x(!0)}}}(e,{start:eh,touchStart:es,end:ef,move:em,getTask:w.getTask}).destroy:void 0},[w,eh,es,ef,em]);let ep=(0,c.useCallback)(e=>{let{key:t,isInput:n}=e;if(!n&&("arrowup"===t||"arrowdown"===t))return e.eventSource="grid",w.exec("hotkey",e),!1;if("enter"===t){let e=m?.getState().focusCell;if(e){let{row:t,column:n}=e;"add-task"===n?A(t,"add-task"):"text"===n&&A(t,"open-task")}}},[w,A,m]),ex=(0,c.useRef)(null),eg=()=>{ex.current={setTableAPI:p,handleHotkey:ep,sortVal:_,api:w,adjustColumns:ea,setColumnWidth:el,tasks:R,durationUnitVal:N,onTableAPIChange:i}};eg(),(0,c.useEffect)(()=>{eg()},[p,ep,_,w,ea,el,R,N,i]);let ew=(0,c.useCallback)(e=>{p(e),e.intercept("hotkey",e=>ex.current.handleHotkey(e)),e.intercept("scroll",()=>!1),e.intercept("select-row",()=>!1),e.intercept("sort-rows",e=>{let t=ex.current.sortVal,{key:n,add:r}=e,l=t?t.find(e=>e.key===n):null,a="asc";return l&&(a=l&&"asc"!==l.order?"asc":"desc"),w.exec("sort-tasks",{key:n,order:a,add:r}),!1}),e.on("resize-column",()=>{ex.current.setColumnWidth(!0)}),e.on("hide-column",e=>{e.mode||ex.current.adjustColumns(),ex.current.setColumnWidth()}),e.intercept("update-cell",e=>{let{id:t,column:n,value:r}=e,l=ex.current.tasks.find(e=>e.id===t);if(l){let e={...l},a=r;!a||isNaN(a)||a instanceof Date||(a*=1),e[n]=a,t6(e,ex.current.durationUnitVal,!0,n),w.exec("update-task",{id:t,task:e})}return!1}),i&&i(e)},[]);return(0,o.jsx)("div",{className:"wx-rHj6070p wx-table-container",style:{flex:`0 0 ${J}`},ref:F,children:(0,o.jsx)("div",{ref:H,style:U,className:"wx-rHj6070p wx-table",onTouchStart:eo,onTouchMove:ec,onClick:I,onDoubleClick:ei,children:(0,o.jsx)(rl,{init:ew,sizes:{rowHeight:v,headerHeight:(K??0)-1},rowStyle:e=>e.$reorder?"wx-rHj6070p wx-reorder-task":"wx-rHj6070p",columnStyle:e=>`wx-rHj6070p wx-text-${e.align}${"add-task"===e.id?" wx-action":""}`,data:Q,columns:er,selectedRows:[...eu],sortMarks:ee})})})}function rD({borders:e=""}){let t=(0,c.useContext)(rM),n=z(t,"cellWidth"),r=z(t,"cellHeight"),l=(0,c.useRef)(null),[a,i]=(0,c.useState)("#e4e4e4");(0,c.useEffect)(()=>{if("u">typeof getComputedStyle&&l.current){let e=getComputedStyle(l.current).getPropertyValue("--wx-gantt-border");i(e?e.substring(e.indexOf("#")):"#1d1e261a")}},[]);let s={width:"100%",height:"100%",background:null!=n&&null!=r?`url(${function(e,t,n,r){var l,a,i,s,o,c,u,d;let h;if(typeof document>"u")return"";let f=document.createElement("canvas");return o=(l=f,a=e,i=t,s=n,l.setAttribute("width",(+a).toString()),l.setAttribute("height",(+i).toString()),(h=l.getContext("2d")).translate(-.5,-.5),h.strokeStyle=s,h),c=r,u=e,d=t,o.beginPath(),o.moveTo(u,0),o.lineTo(u,d),"full"===c&&o.lineTo(0,d),o.stroke(),f.toDataURL()}(n,r,a,e)})`:void 0,position:"absolute"};return(0,o.jsx)("div",{ref:l,style:s})}function rR(e){let{readonly:t,taskTemplate:n}=e,r=(0,c.useContext)(rM),[l,a]=W(r,"_tasks"),[i,s]=W(r,"_links"),d=z(r,"area"),f=z(r,"_scales"),m=z(r,"taskTypes"),p=z(r,"baselines"),x=z(r,"_selected"),g=z(r,"_scrollTask"),w=(0,c.useMemo)(()=>{if(!d||!Array.isArray(l))return[];let e=d.start??0,t=d.end??0;return l.slice(e,t).map(e=>({...e}))},[a,d]),y=(0,c.useMemo)(()=>f.lengthUnitWidth,[f]),v=(0,c.useRef)(!1),[b,k]=(0,c.useState)(void 0),[S,C]=(0,c.useState)(null),j=(0,c.useRef)(null),[M,_]=(0,c.useState)(void 0),N=(0,c.useRef)(null),[E,T]=(0,c.useState)(0),$=(0,c.useRef)(null),D=(0,c.useMemo)(()=>{let e=$.current;return!!(x.length&&e&&e.contains(document.activeElement))},[x,$.current]),R=(0,c.useMemo)(()=>D&&x[x.length-1]?.id,[D,x]);(0,c.useEffect)(()=>{if(g&&D&&g){let{id:e}=g,t=$.current?.querySelector(`.wx-bar[data-id='${e}']`);t&&t.focus({preventScroll:!0})}},[g]),(0,c.useEffect)(()=>{let e=$.current;if(e&&(T(e.offsetWidth||0),"u">typeof ResizeObserver)){let t=new ResizeObserver(e=>{e[0]&&T(e[0].contentRect.width)});return t.observe(e),()=>t.disconnect()}},[$.current]);let A=(0,c.useCallback)(()=>{document.body.style.userSelect="none"},[]),I=(0,c.useCallback)(()=>{document.body.style.userSelect=""},[]),H=(0,c.useCallback)((e,t,n)=>{if(n||(n=r.getTask(r_(e))),"milestone"===n.type||"summary"==n.type)return"";let l=e.getBoundingClientRect(),a=(t.clientX-l.left)/l.width,i=.2/(l.width>200?l.width/200:1);return a<i?"start":a>1-i?"end":""},[r]),F=(0,c.useCallback)((e,n)=>{let{clientX:l}=n,a=r_(e),i=r.getTask(a),s=n.target.classList;if(!t){if(s.contains("wx-progress-marker")){let{progress:t}=r.getTask(a);j.current={id:a,x:l,progress:t,dx:0,node:e,marker:n.target},n.target.classList.add("wx-progress-in-drag")}else C({id:a,mode:H(e,n,i)||"move",x:l,dx:0,l:i.$x,w:i.$w});A()}},[r,t,H,A]),L=(0,c.useCallback)(e=>{if(0!==e.button)return;let t=u(e);t&&F(t,e)},[t,y,E,S,b]),P=(0,c.useCallback)(e=>{let t=u(e);t&&(N.current=setTimeout(()=>{_(!0),F(t,e.touches[0])},300))},[t]),O=(0,c.useCallback)(()=>{if(j.current){let{dx:e,id:t,marker:n,value:l}=j.current;j.current=null,"u">typeof l&&e&&r.exec("update-task",{id:t,task:{progress:l}}),n.classList.remove("wx-progress-in-drag"),v.current=!0,I()}else if(S){let{id:e,mode:t,dx:n,l:l,w:a,start:i}=S;if(C(null),i){let i=Math.round(n/y);if(i){let n={},l=r.getTask(e);"move"==t?(n.start=l.start,n.end=l.end):n[t]=l[t],r.exec("update-task",{id:e,task:n,diff:i})}else r.exec("drag-task",{id:e,width:a,left:l,inProgress:!1});v.current=!0}I()}},[r,I,S,y]),Y=(0,c.useCallback)((e,n)=>{let{clientX:l}=n;if(!t)if(j.current){let{node:e,x:t,id:n}=j.current,a=Math.round((j.current.dx=l-t)/e.offsetWidth*100),i=j.current.progress+a;j.current.value=i=Math.min(Math.max(0,i),100),r.exec("update-task",{id:n,task:{progress:i},inProgress:!0})}else if(S){let e,t,{mode:n,l:a,w:i,x:s,id:o,start:c}=S,u=l-s;if(!c&&20>Math.abs(u)||"start"===n&&i-u<y||"end"===n&&i+u<y||"move"==n&&(u<0&&a+u<0||u>0&&a+i+u>E))return;let d={...S,dx:u};"start"===n?(e=a+u,t=i-u):"end"===n?(e=a,t=i+u):"move"===n&&(e=a+u,t=i);let h={id:o,width:t,left:e,inProgress:!0};r.exec("drag-task",h);let f=r.getTask(o);if(!d.start&&("move"==n&&f.$x==a||"move"!=n&&f.$w==i)){v.current=!0,O();return}d.start=!0,C(d)}else{let r=u(e);if(r){let e=H(r,n);r.style.cursor=e&&!t?"col-resize":"pointer"}}},[r,t,S,y,E,H]),B=(0,c.useCallback)(e=>{Y(e,e)},[Y]),V=(0,c.useCallback)(e=>{M?(e.preventDefault(),Y(e,e.touches[0])):N.current&&(clearTimeout(N.current),N.current=null)},[M,Y]),G=(0,c.useCallback)(()=>{O()},[O]),K=(0,c.useCallback)(()=>{_(null),N.current&&(clearTimeout(N.current),N.current=null),O()},[O]);(0,c.useEffect)(()=>(window.addEventListener("mouseup",G),()=>{window.removeEventListener("mouseup",G)}),[G]);let q=(0,c.useCallback)(e=>{if(!t){let t=h(e.target);t&&!e.target.classList.contains("wx-link")&&r.exec("show-editor",{id:t})}},[r,t]),U=["e2s","s2s","e2e","s2e"],Q=(0,c.useCallback)((e,t)=>U[+!!e+2*!t],[]),X=(0,c.useCallback)((e,t)=>{let n=b.id,r=b.start;return e===n||!!i.find(l=>l.target==e&&l.source==n&&l.type===Q(r,t))},[b,s,Q]),J=(0,c.useCallback)(()=>{b&&k(null)},[b]),Z=(0,c.useCallback)(e=>{if(v.current){v.current=!1;return}let t=h(e.target);if(t){let n=e.target.classList;if(n.contains("wx-link")){let e=n.contains("wx-left");if(!b)return void k({id:t,start:e});b.id===t||X(t,e)||r.exec("add-link",{link:{source:b.id,target:t,type:Q(b.start,e)}})}else r.exec("select-task",{id:t,toggle:e.ctrlKey||e.metaKey,range:e.shiftKey})}J()},[r,b,s]),ee=(0,c.useCallback)(e=>({left:`${e.$x}px`,top:`${e.$y}px`,width:`${e.$w}px`,height:`${e.$h}px`}),[]),et=(0,c.useCallback)(e=>({left:`${e.$x_base}px`,top:`${e.$y_base}px`,width:`${e.$w_base}px`,height:`${e.$h_base}px`}),[]),en=(0,c.useCallback)(e=>{if(M||N.current)return e.preventDefault(),!1},[M]),er=(0,c.useCallback)(e=>{let t=m.some(t=>e===t.id)?e:"task";return"task"!==t&&"milestone"!==t&&"summary"!==t&&(t=`task ${t}`),t},[m]),el=(0,c.useCallback)(e=>{r.exec(e.action,e.data)},[r]);return(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-bars",style:{lineHeight:`${w.length?w[0].$h:0}px`},ref:$,onContextMenu:en,onMouseDown:L,onMouseMove:B,onTouchStart:P,onTouchMove:V,onTouchEnd:K,onClick:Z,onDoubleClick:q,onDragStart:e=>(e.preventDefault(),!1),children:w.map(e=>{if(e.$skip&&e.$skip_baseline)return null;let l=`wx-bar wx-${er(e.type)}`+(M&&S&&e.id===S.id?" wx-touch":"")+(b&&b.id===e.id?" wx-selected":"")+(e.$reorder?" wx-reorder-task":""),a="wx-link wx-left"+(b?" wx-visible":"")+(b&&X(e.id,!0)?"":" wx-target")+(b&&b.id===e.id&&b.start?" wx-selected":""),i="wx-link wx-right"+(b?" wx-visible":"")+(b&&X(e.id,!1)?"":" wx-target")+(b&&b.id===e.id&&!b.start?" wx-selected":"");return(0,o.jsxs)(c.Fragment,{children:[!e.$skip&&(0,o.jsxs)("div",{className:"wx-GKbcLEGA "+l,style:ee(e),"data-tooltip-id":e.id,"data-id":e.id,tabIndex:R===e.id?0:-1,children:[t?null:(0,o.jsx)("div",{className:"wx-GKbcLEGA "+a,children:(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-inner"})}),"milestone"!==e.type?(0,o.jsxs)(o.Fragment,{children:[e.progress?(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-progress-wrapper",children:(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-progress-percent",style:{width:`${e.progress}%`}})}):null,t?null:(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-progress-marker",style:{left:`calc(${e.progress}% - 10px)`},children:e.progress}),n?(0,o.jsx)(n,{data:e,api:r,onAction:el}):(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-content",children:e.text||""})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-content"}),n?(0,o.jsx)(n,{data:e,api:r,onAction:el}):(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-text-out",children:e.text})]}),t?null:(0,o.jsx)("div",{className:"wx-GKbcLEGA "+i,children:(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-inner"})})]}),p&&!e.$skip_baseline?(0,o.jsx)("div",{className:"wx-GKbcLEGA wx-baseline"+("milestone"===e.type?" wx-milestone":""),style:et(e)}):null]},e.id)})})}function rA(){let e=z((0,c.useContext)(rM),"_links");return(0,o.jsx)("svg",{className:"wx-dkx3NwEn wx-links",children:(e||[]).map(e=>(0,o.jsx)("polyline",{className:"wx-dkx3NwEn wx-line",points:e.$p},e.id))})}function rI(e){let{highlightTime:t}=e,n=z((0,c.useContext)(rM),"_scales"),r={width:`${null!=(n&&n.width)?n.width:0}px`};return(0,o.jsx)("div",{className:"wx-ZkvhDKir wx-scale",style:r,children:(n?.rows||[]).map((e,n)=>(0,o.jsx)("div",{className:"wx-ZkvhDKir wx-row",style:{height:`${e.height}px`},children:(e.cells||[]).map((e,n)=>{let r=t?t(e.date,e.unit):"",l=["wx-cell",e.css,r].filter(Boolean).join(" ");return(0,o.jsx)("div",{className:"wx-ZkvhDKir "+l,style:{width:`${e.width}px`},children:e.value},n)})},n))})}function rH(e){let{readonly:t,fullWidth:n,fullHeight:r,taskTemplate:l,cellBorders:a,highlightTime:i}=e,s=(0,c.useContext)(rM),[u,d]=W(s,"_selected"),h=z(s,"scrollLeft"),f=z(s,"scrollTop"),m=z(s,"cellHeight"),p=z(s,"cellWidth"),x=z(s,"_scales"),g=z(s,"_markers"),w=z(s,"_scrollTask"),y=z(s,"zoom"),[v,b]=(0,c.useState)(),k=(0,c.useRef)(null),S=1+(x?.rows?.length||0),C=(0,c.useMemo)(()=>{let e=[];return u&&u.length&&m&&u.forEach(t=>{e.push({height:`${m}px`,top:`${t.$y-3}px`})}),e},[d,m]),j=(0,c.useMemo)(()=>Math.max(v||0,r),[v,r]);(0,c.useEffect)(()=>{let e=k.current;e&&"number"==typeof f&&(e.scrollTop=f)},[f]),(0,c.useEffect)(()=>{let e,t,n,r;e=k.current,t=Math.ceil((v||0)/(m||1))+1,r=Math.max(0,(n=Math.floor((e&&e.scrollTop||0)/(m||1)))-S),s.exec("render-data",{start:r,end:n+t+S,from:r*(m||0)})},[v,f,h]);let M=(0,c.useCallback)(e=>{if(!e)return;let{id:t,mode:n}=e;if(0>n.toString().indexOf("x"))return;let r=k.current;if(!r)return;let{clientWidth:l}=r,a=s.getTask(t);if(a.$x+a.$w<r.scrollLeft)s.exec("scroll-chart",{left:a.$x-(p||0)}),r.scrollLeft=a.$x-(p||0);else if(a.$x>=l+r.scrollLeft){let e=l<a.$w?p||0:a.$w;s.exec("scroll-chart",{left:a.$x-l+e}),r.scrollLeft=a.$x-l+e}},[s,p,h]);function _(e){if(y&&(e.ctrlKey||e.metaKey)){e.preventDefault();let t=k.current,n=-Math.sign(e.deltaY),r=e.clientX-(t?t.getBoundingClientRect().left:0);s.exec("zoom-scale",{dir:n,offset:r})}}function N(e){let t=i(e.date,e.unit);return t?{css:t,width:e.width}:null}(0,c.useEffect)(()=>{M(w)},[w]);let E=(0,c.useMemo)(()=>x&&("hour"===x.minUnit||"day"===x.minUnit)&&i?x.rows[x.rows.length-1].cells.map(N):null,[x,i]),T=(0,c.useCallback)(e=>{e.eventSource="chart",s.exec("hotkey",e)},[s]);(0,c.useEffect)(()=>{let e=k.current;if(!e)return;b(e.clientHeight);let t=new ResizeObserver(()=>b(e.clientHeight));return t.observe(e),()=>{t.disconnect()}},[k.current]);let $=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=k.current;if(e&&!$.current)return $.current=nR(e,{keys:{arrowup:!0,arrowdown:!0},exec:e=>T(e)}),()=>{$.current?.destroy(),$.current=null}},[]),(0,c.useEffect)(()=>{let e=k.current;if(e)return e.addEventListener("wheel",_),()=>{e.removeEventListener("wheel",_)}},[_]),(0,o.jsxs)("div",{className:"wx-mR7v2Xag wx-chart",tabIndex:-1,ref:k,onScroll:()=>{!function(e){let t=k.current;if(!t)return;let n={};n.left=t.scrollLeft,s.exec("scroll-chart",n)}()},children:[(0,o.jsx)(rI,{highlightTime:i,scales:x}),g&&g.length?(0,o.jsx)("div",{className:"wx-mR7v2Xag wx-markers",style:{height:`${j}px`},children:g.map((e,t)=>(0,o.jsx)("div",{className:`wx-mR7v2Xag wx-marker ${e.css||"wx-default"}`,style:{left:`${e.left}px`},children:(0,o.jsx)("div",{className:"wx-mR7v2Xag wx-content",children:e.text})},t))}):null,(0,o.jsxs)("div",{className:"wx-mR7v2Xag wx-area",style:{width:`${n}px`,height:`${j}px`},children:[E?(0,o.jsx)("div",{className:"wx-mR7v2Xag wx-gantt-holidays",style:{height:"100%"},children:E.map((e,t)=>e?(0,o.jsx)("div",{className:"wx-mR7v2Xag "+e.css,style:{width:`${e.width}px`,left:`${t*e.width}px`}},t):null)}):null,(0,o.jsx)(rD,{borders:a}),u&&u.length?u.map((e,t)=>e.$y?(0,o.jsx)("div",{className:"wx-mR7v2Xag wx-selected","data-id":e.id,style:C[t]},e.id):null):null,(0,o.jsx)(rA,{}),(0,o.jsx)(rR,{readonly:t,taskTemplate:l})]})]})}function rF(e){let{position:t="after",size:n=4,dir:r="x",minValue:l=0,maxValue:a=0,onMove:i,onDisplayChange:s,compactMode:u}=e,[d,h]=L(e.value??0),[f,m]=L(e.display??"all"),[p,x]=(0,c.useState)(!1),g=(0,c.useRef)(0),w=(0,c.useRef)();function y(e){return"x"==r?e.clientX:e.clientY}let v=(0,c.useCallback)(e=>{let t=w.current+y(e)-g.current;(!l||l<=t)&&(!a||a>=t)&&(h(t),i(t))},[]),b=(0,c.useCallback)(()=>{document.body.style.cursor="",document.body.style.userSelect="",x(!1),window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",b)},[v]),k=(0,c.useMemo)(()=>"all"!==f?"auto":"x"==r?"ew-resize":"ns-resize",[f,r]),S=(0,c.useCallback)(e=>{g.current=y(e),w.current=d,x(!0),document.body.style.cursor=k,document.body.style.userSelect="none",window.addEventListener("mousemove",v),window.addEventListener("mouseup",b)},[k,v,b,d]),C=(0,c.useMemo)(()=>(function(e){let l=0;"center"==t?l=n/2:"before"==t&&(l=n);let a={size:[n+"px","auto"],p:[e-l+"px","0px"],p2:["auto","0px"]};if("x"!=r)for(let e in a)a[e]=a[e].reverse();return a})(d),[d,t,n,r]),j=["wx-resizer",`wx-resizer-${r}`,`wx-resizer-display-${f}`,p?"wx-resizer-active":""].filter(Boolean).join(" ");return(0,o.jsxs)("div",{className:"wx-pFykzMlT "+j,onMouseDown:S,style:{width:C.size[0],height:C.size[1],cursor:k},children:[(0,o.jsxs)("div",{className:"wx-pFykzMlT wx-button-expand-box",children:[(0,o.jsx)("div",{className:"wx-pFykzMlT wx-button-expand-content wx-button-expand-left",children:(0,o.jsx)("i",{className:"wx-pFykzMlT wxi-menu-left",onClick:function(){let e;m(e=u?"chart"===f?"grid":"chart":"all"===f?"chart":"all"),s(e)}})}),(0,o.jsx)("div",{className:"wx-pFykzMlT wx-button-expand-content wx-button-expand-right",children:(0,o.jsx)("i",{className:"wx-pFykzMlT wxi-menu-right",onClick:function(){let e;m(e=u?"grid"===f?"chart":"grid":"all"===f?"grid":"all"),s(e)}})})]}),(0,o.jsx)("div",{className:"wx-pFykzMlT wx-resizer-line"})]})}function rL(e){let t;return{observe:function(){(t=new ResizeObserver(t=>{for(let n of t)n.target===document.body&&e(n.contentRect.width<=650)})).observe(document.body)},disconnect:function(){t&&(t.disconnect(),t=null)}}}function rz(e){let{taskTemplate:t,readonly:n,cellBorders:r,highlightTime:l,onTableAPIChange:a}=e,i=(0,c.useContext)(rM),s=z(i,"_tasks"),u=z(i,"_scales"),d=z(i,"cellHeight"),h=z(i,"columns"),f=z(i,"_scrollTask"),[m,p]=(0,c.useState)(!1),[x,g]=(0,c.useState)(0),[w,y]=(0,c.useState)(void 0),[v,b]=(0,c.useState)(void 0),[k,S]=(0,c.useState)(void 0),[C,j]=(0,c.useState)("all"),M=(0,c.useRef)(null),_=(0,c.useCallback)(e=>{p(t=>(e!==t&&(e?(M.current=C,"all"===C&&j("grid")):M.current&&"all"!==M.current||j("all")),e))},[C]);(0,c.useEffect)(()=>{let e=rL(_);return e.observe(),()=>{e.disconnect()}},[_]);let N=(0,c.useMemo)(()=>{let e;return x=e=h.every(e=>e.width&&!e.flexgrow)?h.reduce((e,t)=>e+parseInt(t.width),0):m&&"chart"===C?parseInt(h.find(e=>"action"===e.id)?.width)||50:440,e},[h,m,C]);(0,c.useEffect)(()=>{g(N)},[N]);let E=(0,c.useMemo)(()=>(w??0)-(k??0),[w,k]),T=(0,c.useMemo)(()=>u.width,[u]),$=(0,c.useMemo)(()=>s.length*d,[s,d]),D=(0,c.useMemo)(()=>u.height+$+E,[u,$,E]),R=(0,c.useMemo)(()=>x+T,[x,T]),A=(0,c.useRef)(null),I=(0,c.useCallback)(()=>{Promise.resolve().then(()=>{if((w??0)>(R??0)){let e=(w??0)-x;i.exec("expand-scale",{minWidth:e})}})},[w,R,x,i]);(0,c.useEffect)(()=>{let e;return A.current&&(e=new ResizeObserver(I)).observe(A.current),()=>{e&&e.disconnect()}},[A.current,I]);let H=(0,c.useRef)(null),F=(0,c.useRef)(null),L=(0,c.useCallback)(()=>{let e=H.current;e&&i.exec("scroll-chart",{top:e.scrollTop})},[i]),P=(0,c.useRef)({rTasks:[],rScales:{height:0},rCellHeight:0,scrollSize:0,ganttDiv:null,ganttHeight:0});(0,c.useEffect)(()=>{P.current={rTasks:s,rScales:u,rCellHeight:d,scrollSize:E,ganttDiv:H.current,ganttHeight:v??0}},[s,u,d,E,v]);let W=(0,c.useCallback)(e=>{if(!e)return;let{rTasks:t,rScales:n,rCellHeight:r,scrollSize:l,ganttDiv:a,ganttHeight:s}=P.current;if(!a)return;let{id:o}=e,c=t.findIndex(e=>e.id===o);if(c>-1){let e=s-n.height,t=c*r,o=a.scrollTop,u=null;t<o?u=t:t+r>o+e&&(u=t-e+r+l),null!==u&&(i.exec("scroll-chart",{top:Math.max(u,0)}),H.current.scrollTop=Math.max(u,0))}},[i]);(0,c.useEffect)(()=>{W(f)},[f]),(0,c.useEffect)(()=>{let e=H.current;if(!e)return;let t=()=>{b(e.offsetHeight),y(e.offsetWidth)};t();let n=new ResizeObserver(t);return n.observe(e),()=>n.disconnect()},[H.current]),(0,c.useEffect)(()=>{let e=F.current;if(!e)return;let t=()=>{S(e.offsetWidth)};t();let n=new ResizeObserver(t);return n.observe(e),()=>n.disconnect()},[F.current]);let O=(0,c.useRef)(null),Y=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(Y.current)return;let e=O.current;if(e)return Y.current=nR(e,{keys:{"ctrl+c":!0,"ctrl+v":!0,"ctrl+x":!0,"ctrl+d":!0,backspace:!0},exec:e=>{e.isInput||i.exec("hotkey",e)}}),()=>{Y.current?.destroy(),Y.current=null}},[]),(0,o.jsx)("div",{className:"wx-jlbQoHOz wx-gantt",ref:H,onScroll:L,children:(0,o.jsx)("div",{className:"wx-jlbQoHOz wx-pseudo-rows",style:{height:D,width:"100%"},ref:F,children:(0,o.jsx)("div",{className:"wx-jlbQoHOz wx-stuck",style:{height:v,width:k},children:(0,o.jsxs)("div",{tabIndex:0,className:"wx-jlbQoHOz wx-layout",ref:O,children:[h.length?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r$,{display:C,compactMode:m,columnWidth:N,width:x,readonly:n,fullHeight:$,onTableAPIChange:a}),(0,o.jsx)(rF,{value:x,display:C,compactMode:m,minValue:"50",maxValue:"800",onMove:e=>g(e),onDisplayChange:e=>j(e)})]}):null,(0,o.jsx)("div",{className:"wx-jlbQoHOz wx-content",ref:A,children:(0,o.jsx)(rH,{readonly:n,fullWidth:T,fullHeight:$,taskTemplate:t,cellBorders:r,highlightTime:l})})]})})})})}let rP=[{unit:"month",step:1,format:"MMMM yyy"},{unit:"day",step:1,format:"d"}],rW=(0,c.forwardRef)(function({taskTemplate:e=null,markers:t=[],taskTypes:n=na,tasks:r=[],selected:l=[],activeTask:a=null,links:i=[],scales:s=rP,columns:u=t1,start:d=null,end:h=null,lengthUnit:f="day",durationUnit:m="day",cellWidth:p=100,cellHeight:x=38,scaleHeight:g=36,readonly:w=!1,cellBorders:y="full",zoom:v=!1,baselines:b=!1,highlightTime:k=null,init:S=null,autoScale:C=!0,unscheduledTasks:j=!1,...M},_){let N=(0,c.useRef)();N.current=M;let E=(0,c.useMemo)(()=>new ne(B),[]),T=(0,c.useMemo)(()=>E.in,[E]),$=(0,c.useRef)(null);null===$.current&&($.current=new eI((e,t)=>{let n="on"+e.split("-").map(e=>e?e.charAt(0).toUpperCase()+e.slice(1):"").join("");N.current&&N.current[n]&&N.current[n](t)}),T.setNext($.current));let[D,R]=(0,c.useState)(null),A=(0,c.useRef)(null);A.current=D;let I=(0,c.useMemo)(()=>({getState:E.getState.bind(E),getReactiveState:E.getReactive.bind(E),getStores:()=>({data:E}),exec:T.exec,setNext:e=>($.current=$.current.setNext(e),$.current),intercept:T.intercept.bind(T),on:T.on.bind(T),detach:T.detach.bind(T),getTask:E.getTask.bind(E),serialize:E.serialize.bind(E),getTable:e=>e?new Promise(e=>setTimeout(()=>e(A.current),1)):A.current}),[E,T]);(0,c.useImperativeHandle)(_,()=>({...I}),[I]);let H=(0,c.useRef)(0);return(0,c.useEffect)(()=>{H.current?E.init({tasks:r,links:i,start:d,columns:u,end:h,lengthUnit:f,cellWidth:p,cellHeight:x,scaleHeight:g,scales:s,taskTypes:n,zoom:v,selected:l,activeTask:a,baselines:b,autoScale:C,unscheduledTasks:j,markers:t,durationUnit:m}):S&&S(I),H.current++},[r,i,d,u,h,f,p,x,g,s,n,v,l,a,b,C,j,t,m]),0===H.current&&E.init({tasks:r,links:i,start:d,columns:u,end:h,lengthUnit:f,cellWidth:p,cellHeight:x,scaleHeight:g,scales:s,taskTypes:n,zoom:v,selected:l,activeTask:a,baselines:b,autoScale:C,unscheduledTasks:j,markers:t,durationUnit:m}),(0,o.jsx)(eu,{words:e$,optional:!0,children:(0,o.jsx)(rM.Provider,{value:I,children:(0,o.jsx)(rz,{taskTemplate:e,readonly:w,cellBorders:y,highlightTime:k,onTableAPIChange:R})})})});function rO({api:e=null,items:t=[...nr]}){let n=(0,c.useContext)(Z.i18n),r=(0,c.useMemo)(()=>n||F(e$),[n]),l=(0,c.useMemo)(()=>r.getGroup("gantt"),[r]),a=P(e,"_selected"),i=P(e,"_tasks"),s=(0,c.useMemo)(()=>t.map(t=>{let n={...t,disabled:!1};return n.handler=t3(nr,n.id)?t=>t2(e,t.id,null,l):n.handler,n.text&&(n.text=l(n.text)),n.menuText&&(n.menuText=l(n.menuText)),n}),[t,e,l]),u=(0,c.useMemo)(()=>e&&a?.length?s.map(e=>{if(!e.check)return e;let t=a.some(t=>!e.check(t,i));return{...e,disabled:t}}):[{...s[0],disabled:!1}],[e,a,i,s]);return n?(0,o.jsx)(rd,{items:u}):(0,o.jsx)(Z.i18n.Provider,{value:r,children:(0,o.jsx)(rd,{items:u})})}let rY=(0,c.forwardRef)(function({options:e,api:t=null,resolver:n=null,filter:r=null,at:l="point",children:a,onClick:i,css:s},u){let[d]=L((0,c.useMemo)(()=>e??[...nn],[e])),h=(0,c.useRef)(null),f=(0,c.useRef)(null),m=(0,c.useContext)(Z.i18n),p=(0,c.useMemo)(()=>m||F({...e$,...G}),[m]),x=(0,c.useMemo)(()=>p.getGroup("gantt"),[p]),g=P(t,"taskTypes"),w=P(t,"_tasks"),y=P(t,"selected"),v=P(t,"_selected");(0,c.useEffect)(()=>{t&&(t.on("scroll-chart",()=>{h.current&&h.current.show&&h.current.show()}),t.on("drag-task",()=>{h.current&&h.current.show&&h.current.show()}))},[t]);let b=(0,c.useMemo)(()=>{let e;return t?((e=d.find(e=>"convert-task"===e.id))&&(e.data=[],(g||[]).forEach(t=>{e.data.push(e.dataFactory(t))})),function e(t){return t.map(t=>((t={...t}).text&&(t.text=x(t.text)),t.subtext&&(t.subtext=x(t.subtext)),t.data&&(t.data=e(t.data)),t))}(d)):null},[t,d,g,x]),k=(0,c.useMemo)(()=>v&&v.length?v:[],[v]),S=(0,c.useCallback)((e,r)=>{let l=e?t?.getTask(e):null;if(n){let t=n(e,r);l=!0===t?l:t}return l&&(f.current=l.id,(!Array.isArray(y)||!y.includes(l.id))&&t&&t.exec&&t.exec("select-task",{id:l.id})),l},[t,n,y]),C=(0,c.useCallback)(e=>{let n=e.action;n&&(t3(nn,n.id)&&t2(t,n.id,f.current,x),i&&i(e))},[t,x,i]),j=(0,c.useCallback)((e,t)=>{let n=k.length?k:t?[t]:[],l=!r||r(e,t);if(e.check&&l){let t=n.some(t=>!e.check(t,w));e.css=t?"wx-disabled":""}return l},[r,k,w]);(0,c.useImperativeHandle)(u,()=>({show:(e,t)=>{h.current&&h.current.show&&h.current.show(e,t)}}));let M=(0,c.useCallback)(e=>{h.current&&h.current.show&&h.current.show(e)},[]),_=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nP,{filter:j,options:b,dataKey:"id",resolver:S,onClick:C,at:l,ref:h,css:s}),(0,o.jsx)("span",{onContextMenu:M,"data-menu-ignore":"true",children:"function"==typeof a?a():a})]});if(!m&&Z.i18n?.Provider){let e=Z.i18n.Provider;return(0,o.jsx)(e,{value:p,children:_})}return _});function rB({api:e,items:t=nl,css:n="",layout:r="default",readonly:l=!1,placement:a="sidebar",bottomBar:i=!0,topBar:s=!0,autoSave:u=!0,focus:d=!1}){let h=(0,c.useContext)(Z.i18n),f=(0,c.useMemo)(()=>h||F({...e$,...G}),[h]),m=(0,c.useMemo)(()=>f.getGroup("gantt"),[f]),p=f.getRaw(),x=(0,c.useMemo)(()=>A(p.gantt?.dateFormat||p.formats?.dateFormat,p.calendar),[p]),g=(0,c.useMemo)(()=>{if(!0===s&&!l){let e=[{comp:"icon",icon:"wxi-close",id:"close"},{comp:"spacer"},{comp:"button",type:"danger",text:m("Delete"),id:"delete"}];return u?{items:e}:{items:[...e,{comp:"button",type:"primary",text:m("Save"),id:"save"}]}}return s},[s,l,u,m]),[w,y]=(0,c.useState)(!1),v=(0,c.useMemo)(()=>w?"wx-full-screen":"",[w]),b=(0,c.useCallback)(e=>{y(e)},[]);(0,c.useEffect)(()=>{let e=rL(b);return e.observe(),()=>{e.disconnect()}},[b]);let k=z(e,"_activeTask"),S=(0,c.useMemo)(()=>k?.id,[k]),C=z(e,"durationUnit"),j=z(e,"unscheduledTasks"),M=z(e,"taskTypes"),[_,N]=L(k?.type),E=(0,c.useMemo)(()=>k?.unscheduled,[k]),[T,$]=(0,c.useState)({});(0,c.useEffect)(()=>{$({})},[S]);let D=(0,c.useMemo)(()=>"milestone"===_,[_]),R=(0,c.useMemo)(()=>"summary"===_,[_]),I=(0,c.useMemo)(()=>{let n;return(n={start:1,end:1,duration:1},t.map(t=>{let r={...t};if(t.config&&(r.config={...r.config}),"links"===r.comp&&e&&(r.api=e,r.autoSave=u,r.onLinksChange=P),"select"===r.comp&&"type"===r.key){let e=r.options??(M||[]);r.options=e.map(e=>({...e,label:m(e.label)}))}return"slider"===r.comp&&"progress"===r.key&&(r.labelTemplate=e=>`${m(r.label)} ${e}%`),r.label&&(r.label=m(r.label)),r.config?.placeholder&&(r.config.placeholder=m(r.config.placeholder)),j&&n[r.key]&&(E?r.disabled=!0:delete r.disabled),r})).filter(({comp:e,key:t,options:n})=>{switch(e){case"date":return(!D||"end"!==t&&"base_end"!==t)&&!R;case"select":return n.length>1;case"twostate":return j&&!R;case"counter":return!R&&!D;case"slider":return!D;default:return!0}})},[t,E,D,R,j,M,m,e,u]),H=(0,c.useMemo)(()=>{if(l&&k){let e={};return I.forEach(({key:t,comp:n})=>{if("links"!==n){let r=k[t];"date"===n&&r instanceof Date?e[t]=x(r):"slider"===n&&"progress"===t?e[t]=`${r}%`:e[t]=r}}),e}return k?{...k}:null},[l,k,I,x]);function P({id:e,action:t,data:n}){$(r=>({...r,[e]:{action:t,data:n}}))}let W=(0,c.useCallback)(()=>{for(let t in T){let{action:n,data:r}=T[t];e.exec(n,r)}},[e,T]),O=(0,c.useCallback)(()=>{e.exec("delete-task",{id:S})},[e,S]),Y=(0,c.useCallback)(()=>{e.exec("show-editor",{id:null})},[e]),B=(0,c.useCallback)(e=>{let{item:t,changes:n}=e;"delete"===t.id&&O(),"save"===t.id&&(n.length?Y():W()),t.comp&&Y()},[e,S,u,W,O,Y]),V=(0,c.useCallback)((e,t)=>(j&&"summary"===e.type&&(e.unscheduled=!1),t6(e,C,!0,t),e),[j,C]),K=(0,c.useCallback)(e=>{let{update:t,key:n,value:r}=e;e.update=V({...t},n),u||"type"===n&&N(r)},[e,u]),q=(0,c.useCallback)(t=>{let{values:n}=t;n={...n,unscheduled:j&&n.unscheduled&&"summary"!==n.type},delete n.links,delete n.data,e.exec("update-task",{id:S,task:n}),u||W()},[e,S,j,u,W]);return H?(0,o.jsx)(eu,{children:(0,o.jsx)(rj,{css:`wx-XkvqDXuw wx-gantt-editor ${v} ${n}`,items:I,values:H,topBar:g,bottomBar:i,placement:a,layout:r,readonly:l,autoSave:u,focus:d,onAction:B,onSave:q,onChange:K})}):null}function rV(e){let{api:t,content:n,children:r}=e,l=(0,c.useRef)(null),a=(0,c.useRef)(null),[i,s]=(0,c.useState)({}),[u,d]=(0,c.useState)(null),[h,f]=(0,c.useState)({});(0,c.useEffect)(()=>{let e=a.current;if(e&&h&&(h.text||n)){let t=e.getBoundingClientRect(),n=!1,r=h.left,l=h.top;t.right>=i.right&&(r=i.width-t.width-5,n=!0),t.bottom>=i.bottom&&(l=h.top-(t.bottom-i.bottom+2),n=!0),n&&f(e=>e&&{...e,left:r,top:l})}},[h,i,n]);let m=(0,c.useRef)(null);function p(e){return t?.getTask(x(e))||null}function x(e){let t=parseInt(e);return isNaN(t)?e:t}return(0,o.jsxs)("div",{className:"wx-KG0Lwsqo wx-tooltip-area",ref:l,onMouseMove:function(e){let{id:t,tooltip:n,target:r,at:a}=function(e){for(;e;){if(e.getAttribute){let t=e.getAttribute("data-tooltip-id"),n=e.getAttribute("data-tooltip-at"),r=e.getAttribute("data-tooltip");if(t||r)return{id:t,tooltip:r,target:e,at:n}}e=e.parentNode}return{id:null,tooltip:null,target:null,at:null}}(e.target);if(f(null),d(null),!n)if(!t)return void clearTimeout(m.current);else{var i;i=t,n=p(i)?.text||""}let o=e.clientX;clearTimeout(m.current),m.current=setTimeout(()=>{(()=>{let e,i;t&&d(p(x(t)));let c=r.getBoundingClientRect(),u=l.current,h=u?u.getBoundingClientRect():{top:0,left:0,right:0,bottom:0,width:0,height:0};"left"===a?(e=c.top+5-h.top,i=c.right+5-h.left):(e=c.top+c.height-h.top,i=o-h.left),s(h),f({top:e,left:i,text:n})})()},300)},children:[h&&(h.text||n)?(0,o.jsx)("div",{className:"wx-KG0Lwsqo wx-gantt-tooltip",ref:a,style:{top:`${h.top}px`,left:`${h.left}px`},children:n?(0,o.jsx)(n,{data:u}):h.text?(0,o.jsx)("div",{className:"wx-KG0Lwsqo wx-gantt-tooltip-text",children:h.text}):null}):null,r]})}function rG({fonts:e=!0,children:t}){return t?(0,o.jsx)(eT,{fonts:e,children:t}):(0,o.jsx)(eT,{fonts:e})}rh.select=eg,rh.date=function(e){let{value:t,time:n,format:r,onchange:l,onChange:a,...i}=e,s=a??l;return(0,o.jsxs)("div",{className:"wx-hFsbgDln date-time-controll",children:[(0,o.jsx)(ep,{...i,value:t,onChange:function(e){let n=new Date(e.value);n.setHours(t.getHours()),n.setMinutes(t.getMinutes()),s&&s({value:n})},format:r,buttons:["today"],clear:!1}),n?(0,o.jsx)(ej,{value:t,onChange:s,format:r}):null]})},rh.twostate=eS,rh.slider=ew,rh.counter=({id:e=E(),value:t=0,step:n=1,min:r=0,max:l=1/0,error:a=!1,disabled:i=!1,readonly:s=!1,onChange:u})=>{let[d,h]=L(t),f=(0,c.useCallback)(()=>{if(s||d<=r)return;let e=d-n;h(e),u&&u({value:e})},[d,s,r,n,u]),m=(0,c.useCallback)(()=>{if(s||d>=l)return;let e=d+n;h(e),u&&u({value:e})},[d,s,l,n,u]),p=(0,c.useCallback)(()=>{if(!s){let e=Math.round(Math.min(l,Math.max(d,r))/n)*n,t=isNaN(e)?Math.max(r,0):e;h(t),u&&u({value:t})}},[s,d,l,r,n,u]),x=(0,c.useCallback)(e=>{let t=+e.target.value;h(t),u&&u({value:t,input:!0})},[u]);return(0,o.jsxs)("div",{className:`wx-22t21n wx-counter ${i?"wx-disabled":""} ${s?"wx-readonly":""} ${a?"wx-error":""}`,children:[(0,o.jsx)("button",{"aria-label":"-",className:"wx-22t21n wx-btn wx-btn-dec",disabled:i,onClick:f,children:(0,o.jsx)("svg",{className:"wx-22t21n wx-dec",width:"12",height:"2",viewBox:"0 0 12 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M11.2501 1.74994H0.750092V0.249939H11.2501V1.74994Z"})})}),(0,o.jsx)("input",{id:e,type:"text",className:"wx-22t21n wx-input",disabled:i,readOnly:s,required:!0,value:d,onBlur:p,onInput:x}),(0,o.jsx)("button",{"aria-label":"-",className:"wx-22t21n wx-btn wx-btn-inc",disabled:i,onClick:m,children:(0,o.jsx)("svg",{className:"wx-22t21n wx-inc",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:`M11.2501
								6.74994H6.75009V11.2499H5.25009V6.74994H0.750092V5.24994H5.25009V0.749939H6.75009V5.24994H11.2501V6.74994Z`})})})]})},rh.links=function({api:e,autoSave:t,onLinksChange:n}){let r=(0,c.useContext)(Z.i18n).getGroup("gantt"),l=z(e,"activeTask"),a=z(e,"_links"),[i,s]=(0,c.useState)();(0,c.useEffect)(()=>{s(function(){if(l){let t=a.filter(e=>e.target==l).map(t=>({link:t,task:e.getTask(t.source)})),n=a.filter(e=>e.source==l).map(t=>({link:t,task:e.getTask(t.target)}));return[{title:r("Predecessors"),data:t},{title:r("Successors"),data:n}]}}())},[l,a]);let u=(0,c.useMemo)(()=>[{id:"e2s",label:r("End-to-start")},{id:"s2s",label:r("Start-to-start")},{id:"e2e",label:r("End-to-end")},{id:"s2e",label:r("Start-to-end")}],[r]);return(0,o.jsx)(o.Fragment,{children:(i||[]).map((l,a)=>l.data.length?(0,o.jsx)("div",{className:"wx-j93aYGQf wx-links",children:(0,o.jsx)(ek,{label:l.title,position:"top",children:(0,o.jsx)("table",{children:(0,o.jsx)("tbody",{children:l.data.map(l=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"wx-j93aYGQf wx-cell",children:(0,o.jsx)("div",{className:"wx-j93aYGQf wx-task-name",children:l.task.text||""})}),(0,o.jsx)("td",{className:"wx-j93aYGQf wx-cell",children:(0,o.jsx)("div",{className:"wx-j93aYGQf wx-wrapper",children:(0,o.jsx)(et,{value:l.link.type,placeholder:r("Select link type"),options:u,onChange:r=>{var a;let i;return a=l.link.id,i=r.value,void(t?e.exec("update-link",{id:a,link:{type:i}}):(s(e=>(e||[]).map(e=>({...e,data:e.data.map(e=>e.link.id===a?{...e,link:{...e.link,type:i}}:e)}))),n&&n({id:a,action:"update-link",data:{id:a,link:{type:i}}})))},children:({option:e})=>e.label})})}),(0,o.jsx)("td",{className:"wx-j93aYGQf wx-cell",children:(0,o.jsx)("i",{className:"wx-j93aYGQf wxi-delete wx-delete-icon",onClick:()=>{var r;return r=l.link.id,void(t?e.exec("delete-link",{id:r}):(s(e=>(e||[]).map(e=>({...e,data:e.data.filter(e=>e.link.id!==r)}))),n&&n({id:r,action:"delete-link",data:{id:r}})))},role:"button"})})]},l.link.id))})})})},a):null)})};let rK=[{id:"day",label:"ì¼"},{id:"week",label:"ì£¼"},{id:"month",label:"ì"}];function rq({viewType:e,onViewTypeChange:t,showBaselines:n,onToggleBaselines:r,onSave:l,hasChanges:a,saveState:i}){return(0,o.jsxs)("div",{className:"p-2 bg-gray-100 flex items-center gap-2 rounded-md mb-2",children:[rK.map(n=>(0,o.jsx)("button",{type:"button",onClick:()=>t(n.id),className:`px-3 py-1 rounded text-sm ${e===n.id?"bg-blue-500 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,"aria-pressed":e===n.id,children:n.label},n.id)),(0,o.jsx)("div",{className:"h-6 w-px bg-gray-300 mx-2"}),(0,o.jsxs)("button",{type:"button",onClick:r,className:`px-3 py-1 rounded text-sm ${n?"bg-gray-700 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,"aria-pressed":n,children:["ê³í ì¼ì  ",n?"ì¨ê¸°ê¸°":"íì"]}),(0,o.jsx)("div",{className:"flex-1"}),(0,o.jsx)("button",{type:"button",onClick:l,disabled:!a||"saving"===i,className:`px-4 py-1 rounded text-sm font-medium transition-colors ${!a||"saving"===i?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,title:`hasChanges: ${a}, saveState: ${i}`,children:"saving"===i?"ì ì¥ ì¤...":"ì ì¥"}),(0,o.jsxs)("span",{className:"ml-2 text-sm text-gray-600",role:"status",children:[a&&"idle"===i&&"ë³ê²½ ì¬í­ì´ ììµëë¤.","saved"===i&&"ì ì¥ëììµëë¤.","error"===i&&"ì ì¥ ì¤í¨."]})]})}function rU({children:e,fonts:t=!0}){return(0,o.jsx)(rG,{fonts:t,children:e})}let rQ=[{id:"task",label:"ì¼ë°ìì ì¢ì"},{id:"summary",label:"ìì½ìì"},{id:"milestone",label:"ë§ì¼ì¤í¤"},{id:"urgent",label:"ì¼ë°ìì ë¹ì¢ì"},{id:"narrow",label:"ê°ì ìì"},{id:"progress",label:"ê¸°íìì"},{id:"round",label:"ê°ì ìì ì¢ì"}],rX={day:36,week:120,month:180},rJ={text:{label:"ììëª",placeholder:"ìì ì´ë¦ì ìë ¥íì¸ì"},details:{label:"ì¤ëª",placeholder:"ì¸ë¶ ë´ì©ì ìë ¥íì¸ì"},type:{label:"ìì ì í"},start:{label:"ììì¼"},end:{label:"ì¢ë£ì¼"},progress:{label:"ì§íì¨"},links:{label:"ì°ê²° ê´ê³"}};rh.radio=function({options:e=[{}],value:t="",onChange:n,type:r=""}){let l=E(),[a,i]=(0,c.useState)(t);function s(e){let t=e.inputValue;i(t),n&&n({value:t})}return(0,c.useEffect)(()=>{i(t)},[t]),(0,o.jsx)("div",{className:`wx-38w70j wx-radiogroup ${r&&`wx-${r}`}`,children:e.map(e=>(0,o.jsx)("div",{className:"wx-38w70j wx-item",children:(0,o.jsx)(ex,{label:e.label,inputValue:e.id,value:a===e.id,name:l,onChange:s})},e.id))})},rh["assigned-combo"]=({value:e,options:t,onChange:n})=>(0,o.jsx)(et,{clear:!0,options:t,value:e,onChange:n,placeholder:"ë´ë¹ìë¥¼ ì ííì¸ì",children:({option:e})=>(0,o.jsx)("span",{children:e?.label??""})});let rZ=(-1!==(n=(t=nl.filter(e=>"duration"!==e.key).map(e=>{let t=rJ[e.key],n={...e};return!n.id&&e.key&&(n.id=`editor-field-${e.key}`),t?.label&&(n.label=t.label),t?.placeholder&&(n.config={...n.config??{},placeholder:t.placeholder}),n})).findIndex(e=>"type"===e.key))&&t.splice(n,1,{key:"type",id:"task-type-field",comp:"radio",label:rJ.type?.label??"ìì ì í",options:rQ.map(({id:e,label:t})=>({id:e,label:t,value:e})),config:{type:"inline"}},{key:"assigned",id:"task-assigned-field",comp:"assigned-combo",label:"ë´ë¹ì",options:[{id:1,label:"WJByun"},{id:2,label:"CBLee"},{id:3,label:"JMHong"},{id:4,label:"SMShin"}],config:{placeholder:"ë´ë¹ìë¥¼ ì ííì¸ì"}}),t),r0=new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),r1=e=>{let t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?"-":r0.format(t)},r2=({data:e})=>{let t;if(!e)return null;let n="milestone"===e.type,r="number"==typeof e.progress&&Number.isFinite(e.progress)?`${Math.round(e.progress)}%`:null,l=e.end instanceof Date?e.end:e.end?new Date(e.end):void 0,a=e.start instanceof Date?e.start:e.start?new Date(e.start):void 0;return l&&!Number.isNaN(l.getTime())&&(t=new Date(l.getTime()-864e5),a&&!Number.isNaN(a.getTime())&&t<a&&(t=new Date(a))),(0,o.jsxs)("div",{className:"wx-task-tooltip",children:[(0,o.jsx)("div",{className:"tooltip-header",children:String(e.text??"ìì ìì¸")}),(0,o.jsxs)("div",{className:"tooltip-row",children:[(0,o.jsx)("span",{className:"tooltip-label",children:"ì í"}),(0,o.jsx)("span",{className:"tooltip-value",children:String(e.type??"ì¼ë°")})]}),(0,o.jsxs)("div",{className:"tooltip-row",children:[(0,o.jsx)("span",{className:"tooltip-label",children:"ê¸°ê°"}),(0,o.jsxs)("span",{className:"tooltip-value",children:[r1(e.start)," ~ ",n?"":r1(t)]})]}),r&&(0,o.jsxs)("div",{className:"tooltip-row",children:[(0,o.jsx)("span",{className:"tooltip-label",children:"ì§íë¥ "}),(0,o.jsx)("span",{className:"tooltip-value",style:{color:"var(--color-primary)"},children:r})]}),!!e.assigned&&(0,o.jsxs)("div",{className:"tooltip-row",children:[(0,o.jsx)("span",{className:"tooltip-label",children:"ë´ë¹ì"}),(0,o.jsx)("span",{className:"tooltip-value",children:String(e.assigned)})]})]})};var r4=e.i(81949),r3=e.i(49453),r5=e.i(52607);let r6=Symbol("gantt-sync-listener"),r7=Symbol("gantt-ui-handlers"),r8=Symbol("gantt-summary-progress");var r9=e.i(37851);let le=new Set([...[{date:"2025-01-01",name:"ì ì "},{date:"2025-01-28",name:"ì¤ë  ì°í´"},{date:"2025-01-29",name:"ì¤ë "},{date:"2025-01-30",name:"ì¤ë  ì°í´"},{date:"2025-03-01",name:"ì¼ì¼ì "},{date:"2025-03-03",name:"ëì²´ê³µí´ì¼(ì¼ì¼ì )"},{date:"2025-05-05",name:"ì´ë¦°ì´ë "},{date:"2025-05-06",name:"ë¶ì²ëì¤ì ë "},{date:"2025-06-06",name:"íì¶©ì¼"},{date:"2025-08-15",name:"ê´ë³µì "},{date:"2025-10-05",name:"ì¶ì ì°í´"},{date:"2025-10-06",name:"ì¶ì"},{date:"2025-10-07",name:"ì¶ì ì°í´"},{date:"2025-10-08",name:"ëì²´ê³µí´ì¼(ì¶ì)"},{date:"2025-10-03",name:"ê°ì²ì "},{date:"2025-10-09",name:"íê¸ë "},{date:"2025-12-25",name:"í¬ë¦¬ì¤ë§ì¤"}].map(e=>e.date),...[{date:"2026-01-01",name:"ì ì "},{date:"2026-02-16",name:"ì¤ë  ì°í´"},{date:"2026-02-17",name:"ì¤ë "},{date:"2026-02-18",name:"ì¤ë  ì°í´"},{date:"2026-03-01",name:"ì¼ì¼ì "},{date:"2026-05-05",name:"ì´ë¦°ì´ë "},{date:"2026-05-25",name:"ë¶ì²ëì¤ì ë "},{date:"2026-06-06",name:"íì¶©ì¼"},{date:"2026-08-15",name:"ê´ë³µì "},{date:"2026-09-24",name:"ì¶ì ì°í´"},{date:"2026-09-25",name:"ì¶ì"},{date:"2026-09-26",name:"ì¶ì ì°í´"},{date:"2026-10-03",name:"ê°ì²ì "},{date:"2026-10-09",name:"íê¸ë "},{date:"2026-12-25",name:"í¬ë¦¬ì¤ë§ì¤"}].map(e=>e.date)]),lt={day:{scales:[{unit:"year",step:1,format:"yyyyë"},{unit:"month",step:1,format:"Mì"},{unit:"day",step:1,format:"d"}]},week:{scales:[{unit:"year",step:1,format:"yyyyë"},{unit:"month",step:1,format:"Mì"},{unit:"week",step:1,format:"wì£¼"}]},month:{scales:[{unit:"year",step:1,format:"yyyyë"},{unit:"month",step:1,format:"Mì"}]}},ln=new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"});function lr(){let[e,t]=(0,c.useState)("day"),[n,r]=(0,c.useState)(!1),[l,a]=(0,c.useState)(null),{schedule:i,isLoading:s,saveState:u,hasChanges:d,handleSave:h,initGantt:f}=function(){let e,t,n,r=(0,c.useRef)(null),{schedule:l,isLoading:a,saveState:i,hasChanges:s,handleSave:o,syncFromApi:u,markAsChanged:d}=function(e){let t=(0,c.useRef)([]),n=(0,c.useRef)([]),r=(0,c.useRef)([]),[l,a]=(0,c.useState)(null),[i,s]=(0,c.useState)(!0),[o,u]=(0,c.useState)("idle"),[d,h]=(0,c.useState)(!1),f=(0,c.useCallback)(()=>{h(!0),u(e=>"saved"===e?"idle":e)},[]),m=(0,c.useCallback)(()=>{let r=e.current;if(!r)return;let l=[];try{let e="function"==typeof r.serialize?r.serialize():[];Array.isArray(e)&&(l=e)}catch(e){console.warn("Failed to serialize tasks from API:",e)}let i=l.map(e=>(0,r3.decorateTask)(e)),s=n.current;try{let e="function"==typeof r.getStores?r.getStores():null,t=e?.data,n=t?.getState?t.getState():null;n?.links&&(s=n.links.map(e=>({...e})))}catch(e){console.warn("Failed to extract links from API:",e)}t.current=i,n.current=s,a(e=>e?{...e,tasks:i,links:s}:e)},[e]),p=(0,c.useCallback)(async()=>{let a=e.current;if(!a)return void console.error("Gantt API is not ready");try{u("saving"),m();let e=t.current;if(0===e.length)throw Error("No tasks to save");let i=n.current;try{let e="function"==typeof a.getStores?a.getStores():null,t=e?.data,r=t?.getState?t.getState():null;r?.links&&(n.current=i=r.links.map(e=>({...e})))}catch(e){console.warn("Falling back to cached links while saving:",e)}let s=(0,r5.serializeSchedule)(e,i,l?.scales??r.current);await r4.default.post("/api/mock",s,{headers:{"Content-Type":"application/json"}}),u("saved"),h(!1),window.setTimeout(()=>{u("idle")},1500)}catch(e){console.error("Save error:",e),u("error"),alert("ì ì¥ ì¤ ì¤ë¥ê° ë°ìíìµëë¤: "+e.message)}},[e,l?.scales,m]);return(0,c.useEffect)(()=>{let e=!0;return(async()=>{s(!0);try{let l=(await r4.default.get("/api/mock")).data;if(!e)return;let i=(l.tasks??[]).map(e=>(0,r3.decorateTask)(e)),s=(l.links??[]).map(e=>e),o=(l.scales??[]).map(e=>e);r.current=o,t.current=i,n.current=s,a({tasks:i,links:s,scales:o}),h(!1),u("idle")}catch(t){console.error("Error loading data:",t),e&&a(null)}finally{e&&s(!1)}})(),()=>{e=!1}},[]),{schedule:l,isLoading:i,saveState:o,hasChanges:d,handleSave:p,syncFromApi:m,markAsChanged:f}}(r),{recalcSummaryProgress:h,recalcAllSummaryTasks:f}=(e=(0,c.useCallback)(e=>{let t=r.current;if(!t)return 0;let n=e=>{let r=t.getTask(e),l=r?.data;if(!l||!l.length)return[0,0];let a=0,i=0;return l.forEach(e=>{let r=t.getTask(e.id);if(!r)return;if("milestone"!==r.type&&"summary"!==r.type){let e=(0,r9.calculateTaskDuration)(r);if(e>0){let t="number"==typeof r.progress?r.progress:Number(r.progress??0),n=Number.isFinite(t)?(0,r9.clamp)(t,0,100):0;i+=e,a+=e*n}}let[l,s]=n(r.id);a+=l,i+=s}),[a,i]},[l,a]=n(e);if(!a)return 0;let i=l/a;if(!Number.isFinite(i))return 0;let s=Math.round(i);return(0,r9.clamp)(s,0,100)},[r]),t=(0,c.useCallback)((t,n=!1)=>{let l=r.current;if(!l||null==t)return;let a=l.getTask(t);if(!a||"milestone"===a.type)return;let i=l.getState?.(),s=i?.tasks,o=n&&"summary"===a.type?t:s?.getSummaryId?.(t);if(!o)return;let c=l.getTask(o);if(!c)return;let u=e(o),d="number"==typeof c.progress?c.progress:Number(c.progress??0);Number.isFinite(u)&&u!==d&&l.exec("update-task",{id:o,task:{progress:u}})},[r,e]),n=(0,c.useCallback)(()=>{let e=r.current;if(e)try{let n=e.getState?.(),r=n?.tasks;r?.forEach?.(e=>{"summary"===e.type&&t(e.id,!0)})}catch(e){console.warn("Failed to recalculate summary progress:",e)}},[r,t]),{getSummaryProgress:e,recalcSummaryProgress:t,recalcAllSummaryTasks:n}),{attachDataListeners:m,attachSummaryListeners:p,attachUIListeners:x}=function({onDataChange:e,onMarkChanged:t,recalcSummaryProgress:n}){let r=(0,c.useCallback)(n=>{n.detach(r6),["add-task","update-task","delete-task","move-task","copy-task","indent-task","add-link","update-link","delete-link"].forEach(r=>{n.on(r,n=>{n?.inProgress||(e?.(),t?.())},{tag:r6})})},[e,t]),l=(0,c.useCallback)(e=>{if(!n)return;e.detach(r8);let t=(t,n)=>{e.on(t,n,{tag:r8})};t("add-task",e=>{let{id:t}=e;n(t)}),t("update-task",e=>{e?.inProgress||n(e.id)}),t("copy-task",e=>{let{id:t}=e;n(t)}),t("delete-task",e=>{let{source:t}=e;null!=t&&n(t,!0)}),t("move-task",e=>{e?.inProgress||(n(e.id),e?.source!==void 0&&e?.source!==null&&n(e.source,!0))})},[n]);return{attachDataListeners:r,attachSummaryListeners:l,attachUIListeners:(0,c.useCallback)(e=>{e.detach(r7),e.on("add-task",t=>{let{id:n}=t;e.exec("show-editor",{id:n})},{tag:r7})},[]),detachAllListeners:(0,c.useCallback)(e=>{e&&(e.detach(r6),e.detach(r7),e.detach(r8))},[])}}({onDataChange:u,onMarkChanged:d,recalcSummaryProgress:h});return{schedule:l,isLoading:a,saveState:i,hasChanges:s,handleSave:o,initGantt:(0,c.useCallback)(e=>{r.current=e,m(e),p(e),x(e),f(),u()},[m,p,x,f,u])}}(),m=(0,c.useMemo)(()=>t1.map(e=>"text"===e.id?{...e,header:"ë¨ìê³µì "}:"start"===e.id?{...e,header:"ìì",width:100,format:"yyyy-MM-dd"}:"end"===e.id?{...e,header:"ì¢ë£",width:100,format:"yyyy-MM-dd",template:(e,t)=>(e=>{let t=e.end instanceof Date?e.end:e.end?new Date(e.end):void 0;if(!t)return"";let n=new Date(t);n.setDate(n.getDate()-1);let r=e.start instanceof Date?e.start:e.start?new Date(e.start):void 0;return r&&n<r?ln.format(r):ln.format(n)})(t)}:"duration"===e.id?{...e,header:"D",width:Math.round(45)}:e),[]),p=(0,c.useMemo)(()=>lt[e].scales,[e]),x=(0,c.useMemo)(()=>nr.map(e=>"add-task"===e.id?{...e,text:"ì ìì",icon:e.icon}:"edit-task"===e.id?{...e,Text:"í¸ì§",icon:e.icon||"wxi-edit"}:"delete-task"===e.id?{...e,menuText:"ì­ì ",icon:e.icon||"wxi-delete"}:"move-task:up"===e.id?{...e,menuText:"ìë¡ ì´ë",icon:e.icon||"wxi-angle-up"}:"move-task:down"===e.id?{...e,menuText:"ìëë¡ ì´ë",icon:e.icon||"wxi-angle-down"}:"copy-task"===e.id?{...e,menuText:"ë³µì¬",icon:e.icon||"wxi-content-copy"}:"cut-task"===e.id?{...e,menuText:"ìë¼ë´ê¸°",icon:e.icon||"wxi-content-cut"}:"paste-task"===e.id?{...e,menuText:"ë¶ì¬ë£ê¸°",icon:e.icon||"wxi-content-paste"}:"indent-task:add"===e.id?{...e,menuText:"ë¤ì¬ì°ê¸°",icon:e.icon||"wxi-indent"}:"indent-task:remove"===e.id?{...e,menuText:"ë´ì´ì°ê¸°",icon:e.icon||"wxi-unindent"}:e),[]),g=(0,c.useMemo)(()=>({items:[{comp:"button",text:"ë«ê¸°",id:"close"},{comp:"spacer",icon:"",id:"spacer"},{comp:"button",type:"danger",text:"ì­ì ",id:"delete"},{comp:"button",type:"primary",text:"ì ì¥",id:"save"}]}),[]),w=(0,c.useCallback)((e,t)=>{if("day"===t){let t,n;if(t=e.toISOString().split("T")[0],le.has(t))return"wx-holiday";if(0===(n=e.getDay())||6===n)return"wx-weekend"}return""},[]);return(0,o.jsxs)("section",{className:"flex flex-col h-full",children:[(0,o.jsx)(rq,{viewType:e,onViewTypeChange:t,showBaselines:n,onToggleBaselines:()=>r(e=>!e),onSave:()=>{h()},hasChanges:d,saveState:u}),l&&(0,o.jsx)(rO,{api:l,items:x}),(0,o.jsx)("div",{className:"gantt-wrapper flex-1 relative",role:"group","aria-label":"íë¡ì í¸ ê°í¸ ì°¨í¸",children:s?(0,o.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-80 z-50",children:"ë°ì´í°ë¥¼ ë¶ë¬ì¤ë ì¤..."}):i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(rY,{api:l,children:(0,o.jsx)(rU,{children:(0,o.jsx)(rV,{api:l??void 0,content:r2,children:(0,o.jsx)(rW,{init:e=>{f(e),a(e)},tasks:i.tasks,links:i.links,scales:p,columns:m,taskTypes:rQ,cellWidth:rX[e],cellHeight:36,highlightTime:w,...{baselines:n}})})})}),l&&(0,o.jsx)(rB,{api:l,items:rZ,topBar:g})]}):(0,o.jsx)("div",{className:"p-4 text-red-500",children:"ë°ì´í°ë¥¼ ë¶ë¬ì¤ì§ ëª»íìµëë¤."})})]})}e.s(["GanttChart",()=>lr],30253)},77491,e=>{e.n(e.i(30253))}]);